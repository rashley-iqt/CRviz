{"version":3,"sources":["epics/fetch-dataset-epic.js","epics/load-dataset-epic.js","features/header/Header.module.css","domain/controls.js","features/search/SearchControls.module.css","features/header/crlogo.png","features/visualization/Visualization.module.css","domain/error.js","epics/index-dataset-epic.js","epics/upload-dataset-epic.js","features/header/Header.js","features/drag-drop-utils/SelectedField.js","features/drag-drop-utils/SelectedFieldList.js","features/drag-drop-utils/AvailableField.js","features/drag-drop-utils/AvailableFieldList.js","features/drag-drop-utils/DropTarget.js","features/hierarchy-selector/HierarchySelector.js","epics/diff-dataset-epic.js","features/comparison-selector/ComparisonSelector.js","features/misc-controls/FieldSelect.js","features/misc-controls/MiscControls.js","epics/search-dataset-epic.js","features/search/SearchControls.js","features/visualization/d3-viz/pack-grid.js","features/visualization/d3-viz/pack-with-label.js","features/visualization/d3-viz/to-hierarchy.js","features/visualization/d3-viz/datum-key.js","features/visualization/d3-viz/append-circles.js","features/visualization/d3-viz/text-utils.js","features/visualization/d3-viz/setup-zoom.js","features/visualization/d3-viz/setup-tooltip.js","features/visualization/d3-viz/color-scheme.js","features/visualization/d3-viz/setup-legend.js","features/visualization/d3-viz/setup-annotations.js","features/visualization/d3-viz.js","features/visualization/Visualization.js","epics/refresh-dataset-epic.js","features/dataset-controls/DatasetSelector.js","features/dataset-controls/DatasetUpload.js","features/dataset-controls/DatasetDownload.js","features/dataset-controls/DatasetRefresh.js","features/dataset-controls/DatasetTimedRefresh.js","features/dataset-controls/export.js","features/dataset-controls/DatasetControls.js","App.js","registerServiceWorker.js","domain/filter.js","domain/root-reducer.js","epics/filter-dataset-epic.js","epics/root-epic.js","configure-store.js","index.js","features/drag-drop-utils/SelectedFieldList.module.css","features/drag-drop-utils/AvailableFieldList.module.css","domain/dataset.js","features/dataset-controls/DatasetControls.module.css","App.module.css","features/misc-controls/MiscControls.module.css"],"names":["Buffer","__webpack_require__","d","__webpack_exports__","fetchDataset","buildAuthHeader","redux_actions__WEBPACK_IMPORTED_MODULE_0__","redux_observable__WEBPACK_IMPORTED_MODULE_1__","rxjs__WEBPACK_IMPORTED_MODULE_2__","rxjs_ajax__WEBPACK_IMPORTED_MODULE_3__","rxjs_operators__WEBPACK_IMPORTED_MODULE_4__","rxjs_operators__WEBPACK_IMPORTED_MODULE_5__","rxjs_operators__WEBPACK_IMPORTED_MODULE_6__","rxjs_operators__WEBPACK_IMPORTED_MODULE_7__","domain_error__WEBPACK_IMPORTED_MODULE_8__","_load_dataset_epic__WEBPACK_IMPORTED_MODULE_9__","createAction","username","password","token","header","scheme","getScheme","Authorization","concat","toString","fetchDatasetEpic","action$","store","ajax","arguments","length","undefined","rxAjax","pipe","ofType","debounceTime","mergeMap","action","owner","payload","url","headers","crossDomain","responseType","map","result","content","response","loadDataset","catchError","error","newErr","Error","message","of","setError","CSVconvert","rxjs_operators__WEBPACK_IMPORTED_MODULE_3__","ramda__WEBPACK_IMPORTED_MODULE_6__","ramda__WEBPACK_IMPORTED_MODULE_7__","_index_dataset_epic__WEBPACK_IMPORTED_MODULE_8__","domain_error__WEBPACK_IMPORTED_MODULE_9__","domain_dataset__WEBPACK_IMPORTED_MODULE_10__","domain_controls__WEBPACK_IMPORTED_MODULE_11__","data","lines","file","trim","split","delimiter","hdr","delims","delim","max","i","finddelim","jsonstring","colnames","entry","j","formatPayload","datasets","keyFields","ignoredFields","controls","includeData","includeControls","final","isNil","dataset","is","Array","configuration","ValidationError","obj","Object","entries","forEach","key","value","this","name","prototype","create","loadDatasetEpic","_ref","setDatasets","setKeyFields","setIgnoredFields","setControls","buildIndices","module","exports","logo","appName","infoIcon","infoPopup","tagline","defaultState","hierarchyConfig","shouldShowNodes","darkTheme","colorBy","start","end","setStartDataset","setEndDataset","setHierarchyConfig","showNodes","useDarkTheme","reducer","handleActions","_handleActions","_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","state","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","selectControls","searchControls","searchContainer","search","label","viz","delta","plus","minus","clearError","getError","getValue","require","lunr","type","removeSearchIndex","setSearchResults","getSearchResults","searchResults","getQueryString","queryString","getSearchIndices","searchIndices","searchReducer","item","index","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","results","rsowner","hasOwnProperty","generateIndex","indices","keys","isEmpty","configurationFor","flat","ds","cfg","flattened","id","f","fields","field","displayName","push","flattenDataset","idx","_this","ref","filter","includes","toLowerCase","add","indexDatasetEpic","buildIndicesSuccess","uploadDataset","fromReader","Observable","observer","reader","window","FileReader","addEventListener","next","complete","readAsText","fromJson","JSON","parse","uploadDatasetEpic","SyntaxError","Header","showInfo","hideTooltip","setState","showTooltip","react_default","a","createElement","className","style","href","target","rel","src","alt","onMouseEnter","onMouseLeave","index_es","icon","faInfoCircle","react_portal_tooltip_lib_default","active","position","parent","tooltipTimeout","process","React","Component","Field","_classNames","initialItemText","subsequentItemText","dragIndex","animated","provided","assign","draggable","innerRef","draggableProps","dragHandleProps","classNames","defineProperty","groupBy","fieldName","placeholder","SelectedField","_ref$count","count","draggableId","react_beautiful_dnd_esm","snapshot","SelectedFieldList","lastFields","toAnimate","props","_this2","_this$props","values","getFieldId","droppableId","dragState","draggingOver","isDraggingOver","listContainer","droppableProps","droppable","List","destination","differenceWith","eqBy","findIndex","drag_drop_utils_SelectedField","path","source","from","to","Math","min","defaultProps","AvailableField","draggableContainer","objectSpread","transform","isDragging","AvailableFieldList","dragForeign","isDraggingForeign","sortBy","getCount","drag_drop_utils_AvailableField","withPlaceholder","dragForeignContainer","faTrashAlt","curry","contains","DropTarget","isDropDisabled","_classNames2","dropTarget","SELECTED_FIELD_LIST_ID","DROP_TARGET_ID","HierarchySelector","onDragStart","dragStart","onDragUpdate","dragUpdate","onDragEnd","dropResult","updateHierarchy","removeField","fieldId","newIndex","findFieldIndex","find","removeOld","identity","remove","addNew","insert","updatedHierarchy","compose","availableFields","groupable","marginBottom","drag_drop_utils_SelectedFieldList","selectedFieldListStyle","drag_drop_utils_DropTarget","drag_drop_utils_AvailableFieldList","availableFieldListStyle","list","matchId","equals","mapDispatchToProps","connect","selectMergedConfiguration","selectMergedValues","generateDiff","startOwner","startDs","endOwner","endDs","diffs","added","changed","removed","ei","si","CRVIZ","differences","diffDatasetEpic","switchMap","setDatasetDiff","KEY_FIELD_LIST_ID","IGNORED_FIELD_LIST_ID","KEY_TARGET_ID","IGNORED_TARGET_ID","ComparisonSelector","updateKeyFields","updateIgnoreFields","getUpdatedFields","fieldsToUpdate","updatedKeys","updateDiff","updatedIgnored","keyIndex","ignoredIndex","toDiff","startUuid","endUuid","ignore","diffDataset","usedFields","ownProps","selectDataset","getKeyFields","getIgnoredFields","fieldToString","join","prop","stringToField","string","propEq","FieldSelect","onChange","evt","dispatch","container","checkboxContainer","switch","checked","htmlFor","switchLabel","fieldSelect","misc_controls_FieldSelect","selector","searchDataset","performSearch","toFind","hash","idxResults","temp","Set","toConsumableArray","el","_isSearchResult","r","searchDatasetEpic","tap","QueryParseError","hasSearch","Search","handleQueryStringChange","e","handleKeyPress","handleSearch","onKeyPress","onClick","title","faSearch","clearSearch","faTimesCircle","selectConfiguration","eachWithIndex","addIndex","placeRows","rows","middleOut","maxRadii","maxRadius","ys","coordinatesForRadii","xs","row","node","x","y","apply","c","radii","diameters","first","reduce","coords","slicedToArray","lastRadius","currentRadius","last","aperture","above","reject","_","below","pickOdd","reverse","toRows","circles","splitEvery","ceil","sqrt","packGrid","enclosingCircle","packEnclose","radiusLeaf","radius","children","getLabelSize","labelRatio","packChildren","packSiblings","maxLabelRatio","padding","k","nonleafChildren","child","height","labelSize","paddingSize","enclosingRadius","translateChild","labelY","labelWidth","pow","packWithLabel","options","size","pack","root","eachBefore","eachAfter","nestHierarchy","nest","countSearchResults","_searchResultCount","entriesToHierarchy","fieldValue","chain","getLeaves","_SEARCH_RESULT_COUNT","head","tail","toHierarchy","nesting","d3Hierarchy","datumKey","datum","depth","uid","getLabelShape","top","startAngle","PI","acos","endAngle","shape","arc","closePath","appendCircles","nodeRoot","labelRoot","packedData","descendants","nodes","selectAll","exit","nodesEnter","enter","append","classed","merge","attr","_isChanged","_isAdded","_isRemoved","order","select","labels","labelsEnter","countLabels","countLabelsEnter","text","context","document","getContext","measureText","memoizeWith","font","floor","width","fitText","original","textLength","slice","String","fromCharCode","hideSmall","tooSmall","fitCounts","countHeight","viewBound","fitVertically","labelText","maxWidth","zoomIdentity","translate","applyX","applyY","fitLabels","labelFont","labelHeight","boundWidth","boundHeight","nodeBound","boundOverlap","bound0","bound1","getLabelStyle","domElement","getComputedStyle","family","getPropertyValue","getFont","setupZoom","zoomRoot","transformRoot","zoomTo","zoomToTransform","zoomTransform","zoomBehavior","zoom","on","event","d3Event","call","viewPadding","rootR","rootX","rootY","scaleExtent","leaves","translateExtent","_getLabelStyle","_getLabelStyle2","_getLabelStyle3","_getLabelStyle4","countLabelFont","countLabelHeight","bound","nodesInView","labelsInView","labelsNotInView","countLabelsInView","hiddenCountLabels","animate","scale","transition","duration","offsetTop","offsetLeft","tooltip","innerHTML","cont","pairs","setupTooltip","boundingRect","getBoundingClientRect","left","colorScheme","extendColorScheme","extraLayers","extraColors","times","currentLayer","previous","hcl","neighbor","hScale","scaleLinear","domain","range","h","cScale","scalePow","exponent","lScale","l","updateLegend","legend","colorMap","toggleValue","items","toPairs","itemsEnter","disabled","_ref8","color","_ref9","_ref11","createStylesheet","coloring","styleEnter","html","_ref13","_ref14","_ref14$","colorNodes","_ref15","coloredField","isColoringGroup","_ref16","_ref18","setupLegend","legendConfig","update","either","uniq","configs","zip","fromPairs","mapNodesToAnnotationArray","fieldData","dx","dy","note","subject","setupAnnotations","annotationRoot","groupNodes","annotations","anno","annotation","makeAnnotations","annotationCalloutCircle","allEqProps","o1","o2","allPass","eqProps","makeHierarchy","sort","composeComparators","b","localeCompare","comparators","reduceWhile","comparator","findAncestor","hierarchy","ancestors","findChild","reduced","d3Viz","rootNode","svg","clientWidth","clientHeight","selectedNode","nextProps","dataUpdated","sizeUpdated","legendUpdated","repack","rerender","resetLegend","resetZoom","resetAnnotations","ResizeSensor","debounce","_appendCircles","_appendCircles2","selected","Visualization","ReactDOM","findDOMNode","updateFromProps","styles","PureComponent","selectDatasetIntersection","startUid","endUid","startRefresh","stopRefresh","refreshDatasetEpic","interval","timer","setIsFetching","isFetching","takeUntil","eqUrl","DatasetSelector","DatasetUpload","inputId","ownerUuid","display","files","faUpload","DatasetDownload","download","faDownload","DatasetRefresh","faRedoAlt","DatasetTimedRefresh","timerIsRunning","onIntervalChange","onStartClick","onStopClick","faSyncAlt","faStopCircle","getDataToExport","exportData","sanitizeForExport","clonedeep","uuidv4","CUSTOM_DATASET","authTypes","host","location","hostname","port","indexOf","parseInt","POSEIDON_DATASET","Modal","setAppElement","DatasetControls","classCallCheck","possibleConstructorReturn","getPrototypeOf","resetDataset","setDataset","selectedFile","fetchAndSetDataset","uuid","authHeader","toURL","onSelected","removeDataset","showUrlEntry","authScheme","refreshInterval","refreshTimerRunning","onUpload","onUrlChange","onTokenChange","onUsernameChange","onPasswordChange","onUrlOk","onUrlCancel","getDownloadUrl","fullDatasets","urlObject","URL","webkitURL","json","stringify","blob","Blob","createObjectURL","onRefresh","onTimedRefreshStart","onTimedRefreshStop","onTimedRefreshIntervalChanged","numInt","isNaN","canDownload","canRefresh","dataControls","selectorContainer","dataset_controls_DatasetSelector","uploadContainer","dataset_controls_DatasetUpload","fileUpload","utilityContainer","dataset_controls_DatasetDownload","fileDownload","urlRefreshContainer","dataset_controls_DatasetRefresh","urlRefresh","dataset_controls_DatasetTimedRefresh","urlRefreshTime","faCog","lastUpdated","toLocaleDateString","toLocaleTimeString","lib_default","isOpen","onRequestClose","contentLabel","modal","modalMain","at","Token","userName","centerSpan","faCheck","faTimes","TypeError","configHasChanged","Date","getIsFetching","getLastUpdated","selectDatasets","IMPORT","EXPORT","defaultOptions","App","showData","showGrouping","showFiltering","uuids","datasetAdded","showOptions","exportName","componentWillReceiveProps","uniqueUuids","toggleShowData","showComparison","toggleShowComparison","toggleShowGrouping","toggleShowFiltering","onErrorClose","resetControls","showImportOptions","showExportOptions","setOptions","processOptions","exportNameChange","cancelOptions","addDatasetEntry","newItem","setEndUuid","removeDatasetEntry","newUuids","splice","setStartUuid","_classNames3","_classNames4","_classNames5","_classNames6","_classNames7","_classNames8","_classNames9","hasDataset","appContainer","hideControls","header_Header","faHome","accordionHeader","faAngleDoubleDown","faAngleDoubleUp","section","hidden","dataControlHeader","faMinusCircle","dataset_controls_DatasetControls","faPlus","SearchControls","hierarchySection","comparison_selector_ComparisonSelector","dimSection","hierarchy_selector_HierarchySelector","misc_controls_MiscControls","footerContainer","faFileImport","faFileExport","emptyDataset","canvas","visualization_Visualization","justifySpan","faDizzy","isLocalhost","Boolean","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","setFilter","clearFilter","filterString","isValid","compileExpression","combineReducers","filterDataset","applyFilter","filtered","filterDatasetEpic","empty","setFilteredDataset","rootEpic","combineEpics","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","initialState","middleware","createEpicMiddleware","createStore","rootReducer","applyMiddleware","run","configureStore","render","es","src_App","getElementById","origin","fetch","status","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","groupByEnter","dragHandle","defaultItemState","hashFields","getHashFields","allFields","applyHashes","hashKey","addHashKey","addHashWithoutIgnored","fieldsFor","overrides","paths","pathsIn","_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","p","override","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","configureDataset","initialConfig","valuesFor","removeFilteredDataset","removeDatasetDiff","_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","newDiff","_ref10","_selectDatasets","_ref12","_selectMergedConfiguration","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","some","err","return","vals","v","valSet","_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","s","_HASH_KEY","_HASH_WITHOUT_IGNORED","urlContainer","switch-inner"],"mappings":"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","file":"static/js/main.6e025c7c.chunk.js","sourcesContent":["import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport { of } from 'rxjs';\nimport { ajax  as rxAjax } from 'rxjs/ajax';\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\";\nimport { loadDataset } from './load-dataset-epic';\n\n// ACTIONS\nconst fetchDataset = createAction('FETCH_DATASET');\n\n// EPIC\nconst fetchDatasetEpic = (action$, store, ajax = rxAjax) => {\n  return action$.pipe(\n    ofType(fetchDataset.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner;\n      const url = action.payload.url;\n      const header = action.payload.header;\n      return ajax({ 'url': url, 'headers':header, 'crossDomain': true, 'responseType': 'json' }).pipe(\n        map((result) => { \n          return { 'owner': owner, 'content': result.response };\n        })\n        ,map(loadDataset)\n        // I believe this was done oddly and debounce should have been used\n        // to ensure that file input was only processed once, instead of using take until\n        // which seems to be stopping the epic the second time the action passes through the stream\n        // it seems like this change doesn't change functionality and makes unit testing easier\n        // I intend to do more thorough user testing later\n        //.takeUntil(action$.ofType(fetchDataset.toString()))\n        \n      );\n    })\n    ,catchError((error) => {\n      const newErr = new Error(\"Error fetching dataset: \" + error.message);\n      return of(setError(newErr));\n    })\n  );\n}\n\nconst getScheme = (username, password, token) =>{\n   let scheme = 'None';\n    if(token) {\n      scheme = 'Bearer'\n    } else if (username && password) {\n      scheme = 'Basic'\n    }\n    return scheme;\n}\n\nconst buildAuthHeader = (username, password, token) => {\n  let header = null;\n  var scheme = getScheme(username, password, token);\n\n  switch (scheme){\n    case 'Basic':\n       var basic = \"Basic \" + new Buffer(`${username}:${password}`).toString(\"base64\");\n       header = {'Authorization' : basic};\n      break;\n    case 'Bearer':\n      var bearer = `Bearer ${token}`;\n      header = {'Authorization' : bearer};\n      break;\n    default:\n      header = null;\n      break;\n  }\n  \n  return header;\n}\n\nexport default fetchDatasetEpic;\nexport { fetchDataset, buildAuthHeader };\n","import { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { map, mergeMap, catchError } from 'rxjs/operators';\nimport { isNil, is } from \"ramda\";\n\nimport { buildIndices } from './index-dataset-epic';\n\nimport { setError } from \"domain/error\"\nimport { setDatasets, setKeyFields, setIgnoredFields } from \"domain/dataset\";\nimport { setControls } from \"domain/controls\";\n\nconst loadDataset = createAction(\"LOAD_DATASET\");\n\nconst loadDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(loadDataset.toString())\n    ,mergeMap(({ payload }) => {\n      return of(payload).pipe(\n        map(formatPayload)\n        ,mergeMap((payload) => {\n          return of(\n            setDatasets(payload)\n            ,setKeyFields(payload.keyFields)\n            ,setIgnoredFields(payload.ignoredFields)\n            ,setControls(payload.controls)\n            ,buildIndices(payload)\n          )\n        })\n        ,catchError((error) => {\n          if (is(ValidationError, error)) {\n            return of(setError(error));\n          } else {\n            /* istanbul ignore next */\n            throw error;\n          }\n        })\n      );\n    })\n  );\n}; \n\n// doesn't really care if it's not CSV; if it *is* CSV, convert to JSON.\n// Otherwise, just pass it along.\nconst CSVconvert = (data) => {\n  const owner = data.owner;\n  var lines = data.file.trim().split(/[\\r\\n]+/g);\n  if (lines.length < 2) { // bail if there's not even linebreaks\n    return data;\n  }\n\n  function finddelim(hdr) {\n    var delims = [',','|','\\t',';']\n    var delim = 0\n    var max = -1\n    for (var i=0; i < hdr.length; i++) {\n      if (max < hdr.split(delims[i]).length-1) {\n        max = hdr.split(delims[i]).length-1\n        delim = i\n      }\n    }\n    return delims[delim];\n  }\n\n  var delimiter = finddelim(lines[0])\n  var jsonstring = '['\n  var colnames = lines[0].split(delimiter)\n  for (var i=1; i < lines.length; i++) {\n    var entry = lines[i].split(delimiter)\n    if (entry.length !== colnames.length) { // malformed CSV, or not even CSV.\n      return data;\n    }\n    jsonstring += \"{ \"\n    for (var j=0; j < colnames.length; j++) {\n      jsonstring += '\"'+colnames[j]+'\": \"'+entry[j]+'\"';\n      if (j < colnames.length-1 ) {\n        jsonstring += \", \"\n      } else {\n        jsonstring += \" }\"\n        if (i < lines.length-1) {\n          jsonstring += \",\\n\"\n        }\n      }\n    }\n  }\n  jsonstring += ']'\n  return { 'owner': owner, 'file': jsonstring };\n}\n\n//if we have a naked array or an object not containing a dataset instead of an object containing a dataset\n//transfer the array into an object's dataset to maintain a consistent\n//schema with what is used elsewhere see https://github.com/CyberReboot/CRviz/issues/33\nconst formatPayload = (data) => {\n  const owner = data.owner;\n  const content = data.content;\n  const datasets = content.datasets;\n  const keyFields = content.keyFields || [];\n  const ignoredFields = content.ignoredFields || [];\n  const controls = content.controls || {};\n  const includeData = ('includeData' in data) ? data.includeData : true;\n  const includeControls = ('includeControls' in data) ? data.includeControls: false;\n\n  var final = {};\n\n  if(datasets){\n    final =  datasets;\n  } else if(!isNil(content.dataset) && is(Array, content.dataset)){\n    final[owner] = { 'dataset': content.dataset };\n    if(content.configuration){\n      final[owner].configuration = content.configuration;\n    }\n  } else if(isNil(content.dataset) && is(Array, content)) {\n    final[owner] = { 'dataset': content };\n  } else if(isNil(content.dataset)) {\n    let obj = {};\n    Object.entries(content).forEach( (entry) =>{\n      let key = entry[0];\n      let value = entry[1]\n      obj[key] = value;\n      })\n    final[owner] = { 'dataset': [obj] };\n  } else {\n    throw ValidationError('Data in invalid format');\n  }\n\n  data = { \n          'datasets': includeData ? final : {},\n          'keyFields': includeData ? keyFields : {},\n          'ignoredFields': includeData ? ignoredFields : {},\n          'controls': includeControls ? controls : {}\n        };\n  return data;\n};\n\nfunction ValidationError(message) {\n  this.name = 'ValidationError';\n  this.message = message;\n}\n\nValidationError.prototype = Object.create(Error.prototype);\n\nexport default loadDatasetEpic;\n\nexport { loadDataset, CSVconvert };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__22iYy\",\"logo\":\"Header_logo__1Q9PB\",\"appName\":\"Header_appName__3ZkiC\",\"infoIcon\":\"Header_infoIcon__37dfu\",\"infoPopup\":\"Header_infoPopup__vFXpZ\",\"tagline\":\"Header_tagline__2wfq6\"};","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  hierarchyConfig: [], // Array of fields to group by.\n  shouldShowNodes: true, // Whether to show individual nodes\n  darkTheme: false, // Whether to use dark theme\n  colorBy: null, // The field for which to color the devices/groupings by.\n  start: null, // The uuid of the dataset to use as the starting point for comparison\n  end: null // The uuid of the dataset to use as the end point for comparison\n};\n\n// ACTIONS\n\nconst setControls = createAction(\"SET_CONTROLS\");\nconst setStartDataset = createAction(\"SET_START_DATASET\");\nconst setEndDataset = createAction(\"SET_END_DATASET\");\nconst setHierarchyConfig = createAction(\"SET_HIERARCHY_CONFIG\");\nconst showNodes = createAction(\"SHOW_NODES\");\nconst useDarkTheme = createAction(\"USE_DARK_THEME\");\nconst colorBy = createAction(\"COLOR_BY\");\n\nconst reducer = handleActions(\n  {\n    [setControls]: (state, { payload }) =>{\n      const hierarchyConfig = payload.hierarchyConfig || defaultState.hierarchyConfig;\n      const shouldShowNodes = ('shouldShowNodes' in payload) ? !!payload.shouldShowNodes : true;\n      const darkTheme = ('darkTheme' in payload) ? !!payload.darkTheme : false;\n      const colorBy = payload.colorBy || defaultState.colorBy\n      const start = payload.start || defaultState.start\n      const end = payload.end || defaultState.end\n      return { \n        ...state,\n        hierarchyConfig: hierarchyConfig,\n        shouldShowNodes: shouldShowNodes,\n        darkTheme: darkTheme,\n        colorBy: colorBy,\n        start: start,\n        end: end\n      }\n    },\n    [setStartDataset]: (state, { payload }) => {\n      return { ...state, start: payload }\n    },\n    [setEndDataset]: (state, { payload }) => ({ ...state, end: payload }),\n    [setHierarchyConfig]: (state, { payload }) => ({ ...state, hierarchyConfig: payload }),\n    [showNodes]: (state, { payload }) => ({ ...state, shouldShowNodes: !!payload }), // Convert payload to boolean for easier debugging\n    [useDarkTheme]: (state, { payload }) => ({ ...state, darkTheme: !!payload }), // Convert payload to boolean for easier debugging\n    [colorBy]: (state, { payload }) => ({ ...state, colorBy: payload })\n  },\n  defaultState\n);\n\nconst selectControls = (state) => state.controls;\n\nexport default reducer;\nexport { setControls, setHierarchyConfig, showNodes, colorBy, useDarkTheme, selectControls, setStartDataset, setEndDataset };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchControls\":\"SearchControls_searchControls__3c9kl\",\"searchContainer\":\"SearchControls_searchContainer__11kME\",\"search\":\"SearchControls_search__1lu7v\",\"label\":\"SearchControls_label__3sWW2\"};","module.exports = \"data:image/png;base64,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\"","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viz\":\"Visualization_viz__ukgQP\",\"delta\":\"Visualization_delta__3vDxh\",\"plus\":\"Visualization_plus__2hiPX\",\"minus\":\"Visualization_minus__2rrmV\"};","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  error: null\n};\n\n// ACTIONS\nconst setError = createAction(\"SET_ERROR\");\nconst clearError = createAction(\"CLEAR_ERROR\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setError]: (state, { payload }) => {\n      if( payload instanceof Error )\n      {\n      \tconst error = payload;\n      \treturn { ...state, error };\n      }\n      return { ...state };\n    },\n    [clearError]: (state) => {\n      const error = null;\n      return { ...state, error };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getError = (state) => state.error.error;\n\n\nexport default reducer;\n\nexport { setError, getError, clearError};\n","import { ofType } from 'redux-observable';\nimport { isNil, isEmpty } from \"ramda\";\nimport { of } from \"rxjs\";\nimport { mergeMap, map } from 'rxjs/operators';\n\nimport { configurationFor } from \"domain/dataset\";\n\nconst getValue = require(\"get-value\");\nconst lunr = require(\"lunr\");\n\nconst BUILD_INDICES = \"BUILD_INDICES\";\nconst BUILD_INDICES_SUCCESS = \"BUILD_INDICES_SUCCESS\";\nconst REMOVE_SEARCH_INDEX = \"REMOVE_SEARCH_INDEX\";\n//const BUILD_INDEX_FAILURE = \"BUILD_INDEX_FAILURE\";\nconst SET_SEARCH_RESULTS = \"SET_SEARCH_RESULTS\";\n\nconst buildIndices = (payload) => ({'type': BUILD_INDICES, 'payload': payload })\nconst buildIndicesSuccess = (payload) => ({'type': BUILD_INDICES_SUCCESS, 'payload': payload})\nconst removeSearchIndex = (payload) => ({'type': REMOVE_SEARCH_INDEX, 'payload': payload});\nconst setSearchResults = (payload) => ({'type': SET_SEARCH_RESULTS, 'payload': payload })\n\nconst getSearchResults = (state) => state.search.searchResults || [];\nconst getQueryString = (state) => state.search.queryString;\nconst getSearchIndex = (state, owner) => state.search.searchIndices[owner] || null;\nconst getSearchIndices = (state) => state.search.searchIndices || [];\n\nconst indexDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(BUILD_INDICES)\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            map(generateIndex)\n            ,map((payload) =>\n              buildIndicesSuccess(payload)\n            )\n          );\n      })\n    );\n};\n\nconst searchReducer = (state = { searchIndices: {}, queryString: '', searchResults: null }, action) => {\n  switch (action.type) {\n    case BUILD_INDICES_SUCCESS:\n      action.payload.forEach((item) => {\n        state.searchIndices[item.owner] = item.index;\n      })\n      return {...state };\n    case \n    SET_SEARCH_RESULTS:\n      const searchResults = action.payload.results;\n      const queryString = action.payload.queryString;\n      return { ...state, searchResults, queryString};\n    case \n    REMOVE_SEARCH_INDEX:\n      const rsowner = action.payload.owner;\n      if(state.searchIndices.hasOwnProperty(rsowner))\n        delete state.searchIndices[rsowner];\n\n      return { ...state }\n    default:\n      return state;\n  }\n}\n\nconst flattenDataset = (ds, cfg) => {\n  var flattened = [];\n\n  if(isNil(cfg))\n    return flattened;\n\n  for(var key in ds){\n    var item = {'id':key};\n    for(var f in cfg.fields){\n      var field = cfg.fields[f];\n\n      var name = field.displayName\n      item[name] = getValue(ds[key], field.displayName);\n    }\n    flattened.push(item);\n  }\n  return flattened;\n}\n\nconst generateIndex = (payload) => {\n  let indices = [];\n  Object.keys(payload.datasets).forEach((owner) => {\n    const dataset = payload.datasets[owner].dataset;\n    const configuration = !isNil(payload.datasets[owner].configuration) && !isEmpty(payload.datasets[owner].configuration) \n                        ? payload.datasets[owner].configuration : configurationFor(dataset);\n    var flat = flattenDataset(dataset, configuration);\n    const idx = lunr(function () {\n      this.ref('id');\n      if(configuration && configuration.fields){\n        const filteredFields = configuration.fields.filter(f => !f.displayName.includes(\"/\"))\n        filteredFields.map((field) => { return this.field(field.displayName.toLowerCase()); })\n      }\n      flat.map((item) => { return this.add(item); })\n    });\n\n    indices.push({ owner: owner, index: idx })\n  })\n  \n  return indices;\n};\n\nexport default indexDatasetEpic;\n\nexport { buildIndices, searchReducer,  getSearchIndex, removeSearchIndex, getSearchIndices, setSearchResults, getSearchResults, getQueryString };\n","import { createAction } from \"redux-actions\";\nimport { Observable, of } from \"rxjs\";\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\n\nimport { loadDataset, CSVconvert } from './load-dataset-epic';\n\n// ACTIONS\nconst uploadDataset = createAction(\"UPLOAD_DATASET\");\n\n// EPIC\nconst uploadDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(uploadDataset.toString()).pipe(\n      mergeMap((action) => {\n        const owner = action.payload.owner;\n        const file = action.payload.file;\n        return fromReader(owner, file).pipe(\n            debounceTime(500)\n            ,map(CSVconvert)\n            ,map(fromJson)\n            ,map(loadDataset)\n            ,catchError((error) => {\n              if (error instanceof SyntaxError) {\n                const newErr = new Error(\"Invalid JSON.\");\n                return of(setError(newErr));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          )\n      })\n    );\n};\n\n/**\n * Little function to create an observable to read local files.\n * RxJS DOM v5 doesn't have it!?\n */\nconst fromReader = (owner, file) => {\n  return Observable.create((observer) => {\n    const reader = new window.FileReader();\n\n    reader.addEventListener('load', () => {\n      observer.next({ 'owner': owner, 'file': reader.result });\n      observer.complete();\n    });\n\n    reader.addEventListener('error', () => {\n      observer.error(reader.error);\n      observer.complete();\n    });\n\n    reader.readAsText(file)\n  });\n}\n\nconst fromJson = (payload) =>{\n  const owner = payload.owner;\n  const content = JSON.parse(payload.file);\n  const includeData = ('includeData' in payload) ? payload.includeData : true;\n  const includeControls = ('includeControls' in payload) ? payload.includeControls: false;\n\n  return {\n    'owner': owner,\n    'content': content, \n    'includeData': includeData,\n    'includeControls': includeControls,\n  };\n}\n\nexport default uploadDatasetEpic;\nexport { uploadDataset, fromJson };\n","import React from 'react';\nimport ToolTip from 'react-portal-tooltip'\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nimport logo from './crlogo.png';\nimport style from './Header.module.css';\n\nclass Header extends React.Component {\n\n\tstate ={\n\t\tshowInfo: false\n\t}\n\n\thideTooltip = () => {\n\t\tthis.setState({\n\t\t\tshowInfo: false\n\t\t})\n\t}\n\n\tshowTooltip = () =>  {\n\t\tthis.setState({\n\t\t\tshowInfo: true\n\t\t})\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={ style.header }>\n\t\t\t  <a href=\"http://www.cyberreboot.org/\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t  \t<img src={ logo } className={ style.logo } alt='Cyber Reboot' />\n\t\t\t  </a>\n\t\t\t  <span className={ style.appName }>CRviz</span>\n\t\t\t  <span className={ style.infoIcon }>\n\t\t\t\t<label id=\"showInfo\" onMouseEnter={this.showTooltip} onMouseLeave={this.hideTooltip}>\n\t\t\t      <FontAwesomeIcon icon={faInfoCircle} />\n\t\t\t    </label>\n\t\t\t    <ToolTip active={this.state.showInfo} position=\"bottom\" parent=\"#showInfo\" tooltipTimeout={250}>\n\t\t\t      <div className={ style.infoPopup }>\n\t\t\t        About CRviz:<br/>\n\t\t\t        Home: <a href=\"https://www.cyberreboot.org/projects/crviz/\">https://www.cyberreboot.org/projects/crviz/</a><br/>\n\t\t\t        Version: { process.env.REACT_APP_VERSION } <br/>\n\t\t\t        Copyright © 2017-2018 IQT Labs LLC.\n\t\t\t      </div>\n\t\t\t    </ToolTip>\n\t    \t  </span>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Header;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Draggable } from \"react-beautiful-dnd\";\n\nimport classNames from \"classnames\";\n\nfunction SelectedField({\n  style,\n  initialItemText,\n  subsequentItemText,\n  displayName,\n  count = 0,\n  index,\n  draggableId,\n  dragIndex,\n  animated\n}) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {\n        (provided, snapshot) => {\n        return (\n          <Field\n            style={style}\n            initialItemText={initialItemText}\n            subsequentItemText={subsequentItemText}\n            displayName={displayName + \" (\" + count + \")\"}\n            dragIndex={dragIndex}\n            provided={provided}\n            animated={animated}\n          />\n        );\n      }}\n    </Draggable>\n  );\n}\n\nfunction Field({ style, initialItemText, subsequentItemText, displayName, dragIndex, animated, provided }) {\n  return (\n    <div>\n      <div\n        className={style.draggable}\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        {...provided.dragHandleProps}\n      >\n        <div className={style.field}>\n          <span\n            className={classNames({\n              [style.groupBy]: true,\n              [style.animated]: animated\n            })}\n          >\n            {dragIndex === 0 ? initialItemText : subsequentItemText}\n          </span>\n          <span className={style.fieldName}>{displayName}</span>\n        </div>\n      </div>\n\n      {provided.placeholder}\n    </div>\n  );\n}\n\nSelectedField.propTypes = {\n  style: PropTypes.shape({\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n    fieldName: PropTypes.string.isRequired\n  }),\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired,\n  dragIndex: PropTypes.number.isRequired,\n  animated: PropTypes.bool.isRequired\n};\n\nexport default SelectedField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { findIndex, eqBy, differenceWith, isEmpty, isNil, path } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport SelectedField from \"./SelectedField\";\n\nclass SelectedFieldList extends React.Component {\n  state = {\n    lastFields: [],\n    toAnimate: null\n  };\n\n  componentDidMount() {\n    this.setState({\n      lastFields: this.props.fields\n    });\n  }\n\n  static getDerivedStateFromProps(props, state){\n    const { getFieldId } = props;\n\n    // Find newly inserted item, if any\n    let toAnimate = differenceWith(\n      eqBy(getFieldId),\n      props.fields,\n      state.lastFields\n    )[0];\n\n    if (toAnimate) {\n      // Only animate item that are not inserted at the bottom using AffordanceDroppable\n      const newIndex = findIndex(eqBy(getFieldId, toAnimate), props.fields);\n      toAnimate = newIndex < state.lastFields.length ? toAnimate : null;\n    }\n\n    return {\n      lastFields: props.fields,\n      toAnimate: toAnimate\n    };\n  }\n\n  render() {\n    const { style, initialItemText, subsequentItemText, fields, values, getFieldId, droppableId, dragState } = this.props;\n\n    const draggingOver = isDraggingOver(droppableId, dragState);\n    return (\n      <div className={style.listContainer}>\n        <Droppable droppableId={droppableId} type=\"Field\">\n          {\n            (provided, snapshot) => {\n            return (\n              <div\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n                className={style.droppable}\n              >\n                <List\n                  style={style}\n                  initialItemText={initialItemText}\n                  subsequentItemText={subsequentItemText}\n                  fields={fields}\n                  values={values}\n                  getFieldId={getFieldId}\n                  droppableId={droppableId}\n                  dragState={dragState}\n                  toAnimate={this.state.toAnimate}\n                />\n\n                {draggingOver &&\n                  dragState.destination.index !== fields.length &&\n                  provided.placeholder}\n              </div>\n            );\n          }}\n        </Droppable>\n      </div>\n    );\n  }\n}\n\nfunction List({\n  fields,\n  values,\n  getFieldId,\n  style,\n  initialItemText,\n  subsequentItemText,\n  droppableId,\n  dragState,\n  toAnimate\n}) {\n  if (isEmpty(fields)) {\n    return null;\n  }\n  return fields.map((field, index) => {\n    const id = getFieldId(field);\n    const animated = toAnimate && getFieldId(field) === getFieldId(toAnimate);\n    const count = values[id].length\n    return (\n      <SelectedField\n        style={style}\n        initialItemText={initialItemText}\n        subsequentItemText={subsequentItemText}\n        draggableId={id}\n        key={id}\n        displayName={field.displayName}\n        count={count}\n        index={index}\n        dragIndex={dragIndex(droppableId, dragState, index)}\n        animated={animated || false}\n      />\n    );\n  });\n}\n\nconst isDraggingOver = (droppableId, dragState) => {\n  return (\n    !isNil(dragState) &&\n    path([\"destination\", \"droppableId\"], dragState) === droppableId\n  );\n};\n\n/**\n * Calculate the potential indices during drag based on the current dragState.\n *\n * This is used to update the groupBy label on the fly.\n */\nconst dragIndex = (droppableId, dragState, index) => {\n  if (!isDraggingOver(droppableId, dragState)) {\n    return index;\n  }\n\n  const { source, destination } = dragState;\n\n  const from = source.index;\n  const to = destination.index;\n\n  // When inserting, bump down everything below the new index\n  if (source.droppableId !== destination.droppableId) {\n    return index >= to ? index + 1 : index;\n  }\n\n  // For an item that is being dragged, the new index is the destination index.\n  if (index === from) {\n    return to;\n  }\n  // Items not between the source and destination indices are not affected\n  if (index < Math.min(from, to) || index > Math.max(from, to)) {\n    return index;\n  }\n\n  if (from < to) {\n    // If moving down, bump up everything in between\n    return index - 1;\n  } else {\n    // Otherwise, bump down everything in between\n    return index + 1;\n  }\n};\n\nSelectedFieldList.defaultProps = {\n  fields: []\n};\n\nSelectedFieldList.propTypes = {\n  fields: PropTypes.array,\n  droppableId: PropTypes.string.isRequired,\n  getFieldId: PropTypes.func.isRequired,\n\n  style: PropTypes.shape({\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired\n  })\n};\n\nexport default SelectedFieldList;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Draggable } from \"react-beautiful-dnd\";\n\nfunction AvailableField({ style, displayName, index, draggableId }) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {(provided, snapshot) => {\n        return (\n          <span className={style.draggableContainer}>\n            <span\n              className={style.field}\n              ref={provided.innerRef}\n              {...provided.draggableProps}\n              {...provided.dragHandleProps}\n              style={{\n                ...provided.draggableProps.style,\n                // Disable animation of items moving out of the way when\n                // dragging. It implies the list is sortable, and it doesn't\n                // work well with multiline list anyway.\n                transform: snapshot.isDragging\n                  ? provided.draggableProps.style.transform\n                  : \"none\"\n              }}\n            >\n              {displayName}\n            </span>\n          </span>\n        );\n      }}\n    </Draggable>\n  );\n}\n\nconst StyleProps = PropTypes.shape({\n  draggableContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n});\n\nAvailableField.propTypes = {\n  style: StyleProps.isRequired,\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired\n};\n\nexport default AvailableField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport classNames from \"classnames\";\n\nimport { isEmpty, contains, map, sortBy, curry } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTrashAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nimport AvailableField from \"./AvailableField\";\n\nfunction AvailableFieldList({\n  style,\n  fields,\n  values,\n  getFieldId,\n  droppableId,\n  dragState\n}) {\n  return (\n    <Droppable droppableId={droppableId} type=\"Field\">\n      {(provided, snapshot) => {\n        const dragForeign = isDraggingForeign(dragState, fields, getFieldId);\n\n        return (\n          <div\n            className={classNames(style.listContainer, {\n              [style.dragForeign]: dragForeign,\n              [style.isDraggingOver]: snapshot.isDraggingOver\n            })}\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {!isEmpty(fields) &&\n              sortBy(getCount(getFieldId, values), fields).map((field, index) => {\n                const id = getFieldId(field);\n                const count = values[id].length || 0;\n                return (\n                  <AvailableField\n                    style={style}\n                    key={id}\n                    draggableId={id}\n                    displayName={`${field.displayName} (${count})`}\n                    index={index}\n                    withPlaceholder={false}\n                  />\n                );\n              })}\n\n            {dragForeign && (\n              <div className={style.dragForeignContainer}>\n                <span>\n                  <FontAwesomeIcon icon={faTrashAlt} />\n                </span>\n              </div>\n            )}\n          </div>\n        );\n      }}\n    </Droppable>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst isDraggingForeign = (dragState, fields, getFieldId) => {\n  return (\n    dragState &&\n    dragState.draggableId &&\n    !contains(dragState.draggableId, map(getFieldId, fields))\n  );\n};\n\nAvailableFieldList.defaultProps = {\n  fields: []\n};\n\nconst StyleProps = PropTypes.shape({\n  listContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n  fieldName: PropTypes.string.isRequired\n});\n\nAvailableFieldList.propTypes = {\n  style: StyleProps.isRequired,\n  fields: PropTypes.array,\n  values: PropTypes.object,\n  getFieldId: PropTypes.func.isRequired,\n  droppableId: PropTypes.string.isRequired\n};\n\nexport default AvailableFieldList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport classNames from \"classnames\";\nimport { Droppable } from \"react-beautiful-dnd\";\n\n/**\n * Droppable component to use as a dummy drop target next to SelectedFieldList.\n * This droppable doesn't contain any draggable.\n *\n * Note: this cannot be used nested inside SelectedFieldList, because they need\n * to accept the same type, and react-beautiful-dnd doesn't allow that.\n */\nfunction DropTarget({ style, initialItemText, subsequentItemText, droppableId, isDropDisabled, fields }) {\n  return (\n    <div\n      className={classNames({\n        [style.listContainer]: true,\n        [style.isDropDisabled]: isDropDisabled\n        })}>\n      <div className={style.draggable}>\n        <div className={style.field}>\n          <span className={style.groupBy}>\n            { fields.length === 0 ? initialItemText : subsequentItemText }\n          </span>\n\n          <Droppable\n            isDropDisabled={ isDropDisabled }\n            droppableId={droppableId}\n            type=\"Field\">\n\n            {(provided, snapshot) => {\n              return (\n                <span\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className={\n                    classNames({\n                      [style.dropTarget]: true,\n                      [style.isDraggingOver]: snapshot.isDraggingOver\n                    })}\n                >\n                    Drop attribute here\n                </span>\n              )\n            }}\n          </Droppable>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nDropTarget.propTypes = {\n  style: PropTypes.shape({\n    isDropDisabled: PropTypes.string.isRequired,\n    dropTarget: PropTypes.string.isRequired,\n    isDraggingOver: PropTypes.string.isRequired,\n\n    // The classes below should be identical to the styling of SelectedFieldList\n    // to make both layout the same.\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n  }),\n\n  droppableId: PropTypes.string.isRequired,\n  isDropDisabled: PropTypes.bool.isRequired,\n  fields: PropTypes.array.isRequired\n}\n\n\nexport default DropTarget;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\n\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\nimport { setHierarchyConfig, selectControls, showNodes } from \"domain/controls\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\n\nconst SELECTED_FIELD_LIST_ID = 'SelectedFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst DROP_TARGET_ID = 'DropTarget';\n\nclass HierarchySelector extends React.Component {\n\n  state = {\n    dragState: null\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === SELECTED_FIELD_LIST_ID) {\n      this.updateHierarchy(draggableId, destination.index)\n    } else if (destination.droppableId === (DROP_TARGET_ID)) {\n      this.updateHierarchy(draggableId, this.props.controls.hierarchyConfig.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  updateHierarchy = (fieldId, newIndex) => {\n    const { fields } = this.props.configuration;\n    const { hierarchyConfig } = this.props.controls;\n\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedHierarchy = compose(addNew, removeOld)(hierarchyConfig)\n\n    this.props.setHierarchyConfig(updatedHierarchy)\n  }\n\n  removeField = (fieldId) => {\n    const { hierarchyConfig } = this.props.controls;\n    const { setHierarchyConfig } = this.props;\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n\n    if (index !== null) {\n      setHierarchyConfig(remove(index, 1, hierarchyConfig ))\n    }\n\n    if(this.props.controls.hierarchyConfig.length === 0 ){\n      this.props.showNodes(true);\n    }\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n\n    const hierarchyConfig = this.props.controls.hierarchyConfig;\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      hierarchyConfig\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Group By\"\n              subsequentItemText=\"Then By\"\n              fields={ hierarchyConfig }\n              values={ values }\n              droppableId={ SELECTED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Group By\"\n            subsequentItemText=\"Then By\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === SELECTED_FIELD_LIST_ID }\n            droppableId= { DROP_TARGET_ID }\n            fields={ this.props.controls.hierarchyConfig }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nHierarchySelector.propTypes = {\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n  controls: PropTypes.shape({\n    hierarchyConfig: PropTypes.array.isRequired\n  }),\n  showNodes: PropTypes.func.isRequired\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state) => ({\n  configuration: selectMergedConfiguration(state),\n  values: selectMergedValues(state),\n  controls: selectControls(state)\n});\n\nconst mapDispatchToProps = {\n  setHierarchyConfig,\n  showNodes\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HierarchySelector);\n","import { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { switchMap, map } from 'rxjs/operators';\n\nimport { setDatasetDiff } from \"domain/dataset\";\n\nconst DIFF_DATASET = \"DIFF_DATASET\";\n\nconst diffDataset = (payload) => ({'type': DIFF_DATASET, 'payload': payload })\n\nconst diffDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(DIFF_DATASET)\n      ,switchMap(({ payload }) => {\n        return of(payload).pipe(\n        \tmap(generateDiff)\n          ,map((payload) =>\n            setDatasetDiff(payload)\n          )\n        );\n      })\n    );\n};\n\n\nconst generateDiff = (payload) => {\n  const startOwner = payload.start.owner;\n  const startDs = payload.start.dataset;\n  const endOwner = payload.end.owner;\n  const endDs = payload.end.dataset;\n\n  let diffs = {\n  \tadded: [],\n  \tchanged:[],\n  \tremoved:[]\n  };\n  diffs.added = diffs.added.concat(endDs.filter(ei => startDs.findIndex(si => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n  diffs.removed = diffs.removed.concat(startDs.filter(si => endDs.findIndex(ei => ei.CRVIZ[\"_HASH_KEY\"] === si.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n\n  diffs.changed = diffs.changed.concat(\n  \tendDs.filter(\n  \t\tei => startDs.findIndex(\n  \t\t\tsi => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"] &&\n  \t\t\t\t\t\tsi.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] !== ei.CRVIZ[\"_HASH_WITHOUT_IGNORED\"]\n  \t\t) !== -1\n  \t).map(i => i.CRVIZ[\"_HASH_KEY\"])\n  );\n\n  //console.log(\"diffs to return: %o\", diffs);\n  const result = {\n  \t'start': startOwner,\n  \t'end': endOwner,\n  \t'differences': diffs\n  }\n  return result;\n};\n\nexport default diffDatasetEpic;\n\nexport { diffDataset };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\n\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { \n  selectMergedConfiguration, selectMergedValues, getFieldId, selectDataset,\n  setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields\n} from \"domain/dataset\";\nimport { diffDataset } from \"epics/diff-dataset-epic\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\n\nconst KEY_FIELD_LIST_ID = 'KeyFieldList';\nconst IGNORED_FIELD_LIST_ID = 'IgnoredFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst KEY_TARGET_ID = 'KeyTarget';\nconst IGNORED_TARGET_ID = 'IgnoredTarget';\n\nclass ComparisonSelector extends React.Component {\n\n  state = {\n    dragState: null\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === KEY_FIELD_LIST_ID) {\n      this.updateKeyFields(draggableId, destination.index)\n    } else if (destination.droppableId === (KEY_TARGET_ID)) {\n      this.updateKeyFields(draggableId, this.props.keyFields.length);\n    } else if (destination.droppableId === IGNORED_FIELD_LIST_ID) {\n      this.updateIgnoreFields(draggableId, destination.index)\n    } else if (destination.droppableId === (IGNORED_TARGET_ID)) {\n      this.updateIgnoreFields(draggableId, this.props.ignoredFields.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  getUpdatedFields = (fieldId, newIndex, fieldsToUpdate) =>{\n  \tconst { fields } = this.props.configuration;\n\n  \tconst index = findFieldIndex(fieldsToUpdate, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedFields = compose(addNew, removeOld)(fieldsToUpdate);\n\n    return updatedFields;\n  }\n\n  updateKeyFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedKeys = this.getUpdatedFields(fieldId, newIndex, keyFields);\n    \n    if(updatedKeys){\n    \tthis.props.setKeyFields(updatedKeys);\n      this.updateDiff(updatedKeys, ignoredFields);\n    }\n  }\n\n  updateIgnoreFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedIgnored = this.getUpdatedFields(fieldId, newIndex, ignoredFields);\n\n    if(updatedIgnored){\n    \tthis.props.setIgnoredFields(updatedIgnored);\n      this.updateDiff(keyFields, updatedIgnored);\n\t  }\n  }\n\n  removeField = (fieldId) => {\n    const keyFields = this.props.keyFields;\n    const keyIndex = findFieldIndex(keyFields, fieldId);\n\n    const ignoredFields = this.props.ignoredFields;\n    const ignoredIndex = findFieldIndex(ignoredFields, fieldId);\n\n    let updatedKeys = null;\n    let updatedIgnored = null;\n\n    if (keyIndex !== null) {\n      updatedKeys = remove(keyIndex, 1, keyFields );\n      this.props.setKeyFields(updatedKeys);\n    }\n\n    if (ignoredIndex !== null) {\n      updatedIgnored = remove(ignoredIndex, 1, ignoredFields );\n      this.props.setIgnoredFields(updatedIgnored);      \n    }\n\n    if(updatedKeys || updatedIgnored){\n      this.updateDiff(updatedKeys || keyFields, updatedIgnored || ignoredFields);\n    }\n  }\n\n  updateDiff = (keyFields, ignoredFields) => {\n    const toDiff ={\n      'start': {\n        'owner': this.props.startUuid,\n        'dataset': this.props.start\n      },\n      'end':{\n        'owner': this.props.endUuid,\n        'dataset': this.props.end\n      },\n      'configuration': this.props.configuration,\n      'key': keyFields,\n      'ignore': ignoredFields,\n    }\n\n    this.props.diffDataset(toDiff);\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const usedFields = keyFields.concat(ignoredFields);\n\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      usedFields\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n              fields={ keyFields }\n              values={ values }\n              droppableId={ KEY_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === KEY_FIELD_LIST_ID }\n            droppableId= { KEY_TARGET_ID }\n            fields={ this.props.keyFields }\n          />\n        </div>\n\n        <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Ignore\"\n              subsequentItemText=\"And\"\n              fields={ ignoredFields }\n              values={ values }\n              droppableId={ IGNORED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Ignore\"\n            subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === IGNORED_FIELD_LIST_ID }\n            droppableId= { IGNORED_TARGET_ID }\n            fields={ this.props.ignoredFields }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nComparisonSelector.propTypes = {\n  startUuid: PropTypes.string,\n  start: PropTypes.array,\n  endUuid: PropTypes.string,\n  end: PropTypes.array,\n  keyFields: PropTypes.array.isRequired,\n  ignoredFields: PropTypes.array.isRequired,\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state, ownProps) => ({\n  start: selectDataset(state, ownProps.startUuid),\n  end: selectDataset(state, ownProps.endUuid),\n  keyFields: getKeyFields(state),\n  ignoredFields: getIgnoredFields(state),\n  configuration: selectMergedConfiguration(state),\n  values: selectMergedValues(state)\n});\n\nconst mapDispatchToProps = {\n  setKeyFields,\n  setIgnoredFields,\n  diffDataset\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ComparisonSelector);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  sortBy,\n  curry,\n  compose,\n  join,\n  split,\n  find,\n  propEq,\n  prop,\n  isNil\n} from \"ramda\";\n\nfunction FieldSelect({\n  fields,\n  values,\n  getFieldId,\n  value,\n  onChange,\n  className,\n  name\n}) {\n\n  return (\n    <div className={className}>\n      <label className=\"select\">\n        <select\n          \n          name={name}\n          onChange={(evt) => onChange(stringToField(fields, evt.target.value))}\n          value={isNil(value) ? \"\" : fieldToString(value)}\n        >\n          <option value=\"\">&mdash;None&mdash;</option>\n          {sortBy(getCount(getFieldId, values), fields).map((field) => {\n            const key = getFieldId(field);\n            return (\n              <option key={key} value={key}>\n                {field.displayName} ({values[getFieldId(field)].length})\n              </option>\n            );\n          })}\n        </select>\n      </label>\n    </div>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst FieldShape = PropTypes.shape({\n  path: PropTypes.array.isRequired,\n  displayName: PropTypes.string.isRequired\n});\n\nFieldSelect.propTypes = {\n  fields: PropTypes.arrayOf(FieldShape).isRequired,\n  value: FieldShape,\n  onChange: PropTypes.func.isRequired,\n  className: PropTypes.string,\n  name: PropTypes.string\n};\n\nconst fieldToString = compose(join(\".\"), prop(\"path\"));\n\nconst stringToField = (fields, string) => {\n  const path = split(\".\", string);\n  return find(propEq(\"path\", path), fields);\n};\n\nexport default FieldSelect;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport {\n  showNodes,\n  useDarkTheme,\n  colorBy,\n  selectControls\n} from \"domain/controls\";\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\n\nimport FieldSelect from \"./FieldSelect\";\n\nimport style from \"./MiscControls.module.css\";\n\nfunction MiscControls({\n  controls,\n  configuration,\n  values,\n  showNodes,\n  colorBy,\n  useDarkTheme\n}) {\n  const fields = configuration.fields.filter((f) => f.groupable);\n  return (\n    <div className={style.container}>\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"show-node-check\"\n            checked={controls.shouldShowNodes}\n            onChange={(evt) => showNodes(evt.target.checked)}\n          />\n          <label htmlFor=\"show-node-check\" className={ style.switchLabel }>\n          </label>\n        </div>\n        <label >Show nodes</label>\n      </div>\n\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"dark-theme-check\"\n            checked={controls.darkTheme}\n            onChange={(evt) => useDarkTheme(evt.target.checked)}\n          />\n          <label htmlFor=\"dark-theme-check\" className={ style.switchLabel }> \n          </label>\n        </div>\n        <label>Use dark theme</label>\n      </div>\n\n      <div className={`input-group ${style.colorBy}`}>\n        <label htmlFor=\"colorBy\">Color by</label>\n        <div className={style.fieldSelect}>\n          <FieldSelect\n            name=\"colorBy\"\n            className={style.selector}\n            onChange={colorBy}\n            fields={fields}\n            values={values}\n            getFieldId={getFieldId}\n            value={controls.colorBy}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    controls: selectControls(state),\n    configuration: selectMergedConfiguration(state),\n    values: selectMergedValues(state)\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    showNodes: (shouldShowNodes) => dispatch(showNodes(shouldShowNodes)),\n    useDarkTheme: (darkTheme) => dispatch(useDarkTheme(darkTheme)),\n    colorBy: (field) => dispatch(colorBy(field))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MiscControls);\n","import { is } from \"ramda\";\nimport { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\nimport { QueryParseError } from 'lunr';\n\nimport { setError } from \"domain/error\"\nimport { setSearchResults} from \"./index-dataset-epic\";\n\nconst searchDataset = createAction(\"SEARCH_DATASET\");\n\nconst searchDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(searchDataset.toString())\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            tap(performSearch)\n            ,map((payload) =>\n              setSearchResults({\n                queryString: payload.queryString,\n                results: payload.results || []\n              })\n            )\n            ,catchError((error) => {\n              if (is(QueryParseError, error)) {\n                return of(setError(error));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          );\n      })\n    );\n};\n\nconst performSearch = (data) => {\n  data.results = [];\n  var toFind = data.queryString || '';\n  const indices = data.searchIndices;\n  var results = [];\n  if(indices && toFind){\n    for(var hash in indices){\n      const idx = indices[hash];\n      const idxResults = idx.search(toFind.toLowerCase());\n      const temp = new Set([...results, ...idxResults]);\n      results = [...temp];\n    }\n  }\n\n  data.dataset.forEach((el) => { el.CRVIZ._isSearchResult = false; });\n  results.forEach((r) => {\n    if(data.dataset[r.ref]){\n      data.dataset[r.ref].CRVIZ._isSearchResult = true;\n      data.results.push(data.dataset[r.ref]);\n    }\n  });\n};\n\nexport default searchDatasetEpic;\n\nexport { searchDataset };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSearch,  faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { selectDataset, selectConfiguration } from \"domain/dataset\";\n\nimport { getSearchIndices, getSearchResults } from \"epics/index-dataset-epic\";\nimport { searchDataset } from \"epics/search-dataset-epic\";\n\nimport style from \"./SearchControls.module.css\";\n\nconst defaultState = {\n  queryString: '',\n  searchIndices: [],\n  hasSearch: false\n}\n\nclass Search extends React.Component {\n\n  state = defaultState\n\n  handleSearch(){\n    this.setState({\n      hasSearch: this.state.queryString !== ''\n    });\n    var data = {\n      dataset: this.props.dataset,\n      configuration: this.props.configuration,\n      searchIndices: this.props.searchIndices,\n      queryString: this.state.queryString,\n      results: this.props.results\n    }\n    this.props.searchDataset(data);\n  }\n\n  clearSearch(){\n    this.setState(defaultState, function() {\n      this.handleSearch();\n    });\n  }\n\n  handleQueryStringChange = (e) =>{\n        this.setState({\n          queryString: e.target.value\n        });\n  }\n\n  handleKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      this.handleSearch();\n    }\n  }\n\n  render() {\n    return (\n      <div className={style.searchContainer}>\n        <span className={ style.search }>\n          <input\n            type=\"search\"\n            id=\"search-string\"\n            placeholder=\"Search\"\n            value={this.state.queryString}\n            onChange={this.handleQueryStringChange}\n            onKeyPress={this.handleKeyPress}\n          />\n\n          <label htmlFor=\"search-string\" className=\"button circular\" onClick={() => this.handleSearch()} title=\"Search\">\n            <FontAwesomeIcon icon={faSearch} />\n          </label>\n        </span>\n        { this.state.hasSearch &&\n          <span>\n            <label id=\"search-results\"> {this.props.results.length} Results found </label>\n            <label htmlFor=\"search-results\" className=\"button circular\" onClick={() => this.clearSearch()}>\n              <FontAwesomeIcon icon={faTimesCircle} />\n              </label>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nSearch.propTypes = {\n  dataset: PropTypes.array,\n  configuration: PropTypes.object,\n  searchIndex: PropTypes.object,\n  queryString: PropTypes.string,\n  results: PropTypes.array,\n  searchDataset: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  const hash = Object.keys(state.dataset.datasets)[0] || \"\"\n  return {\n    dataset: selectDataset(state, hash),\n    configuration: selectConfiguration(state, hash),\n    searchIndices: getSearchIndices(state),\n    queryString: state.search.queryString,\n    results: getSearchResults(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  searchDataset,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Search);\n","import {\n  add,\n  addIndex,\n  aperture,\n  concat,\n  forEach,\n  map,\n  last,\n  prop,\n  reject,\n  reverse,\n  splitEvery,\n  reduce\n} from \"ramda\";\n\nimport { packEnclose } from \"d3-hierarchy\";\n\n/**\n * Pack circles into rows and columns.\n */\nconst packGrid = (circles) => {\n  const rows = toRows(circles);\n  placeRows(rows);\n\n  // Recenter everything over the origin\n  var enclosingCircle = packEnclose(circles);\n  forEach((c) => {\n    c.x -= enclosingCircle.x;\n    c.y -= enclosingCircle.y\n  }, circles);\n};\n\nconst eachWithIndex = addIndex(forEach);\n\n/**\n * Assign x and y coordinates to rows of circles\n */\nconst placeRows = (rows) => {\n  rows = middleOut(map(middleOut, rows));\n\n  const maxRadii = map(maxRadius, rows);\n  const ys = coordinatesForRadii(maxRadii);\n  const xs = map(coordinatesForRadii, map(map(prop('r')), rows));\n\n  return eachWithIndex(\n    (row, i) =>\n      eachWithIndex((node, j) => {\n        node.x = xs[i][j];\n        node.y = ys[i];\n      }, row),\n    rows\n  );\n};\n\nconst maxRadius = (row) => {\n  return Math.max(...row.map((c) => c.r));\n};\n\n// Calculate the coordinates for the given list of radii\n// such that circles of these radii sit on the same line without colliding.\n// The circles are distributed evenly over the origin.\nconst coordinatesForRadii = (radii) => {\n  const diameters = map((r) => r * 2, radii)\n  const size = reduce(add, 0, diameters);\n\n  const first = 0 - size / 2 + radii[0]; // Calculate the first coordinate\n\n  return reduce((coords, [lastRadius, currentRadius]) => {\n    return [...coords, last(coords) + lastRadius + currentRadius];\n  }, [first], aperture(2, radii))\n};\n\n\nconst pickEven = (list) => addIndex(reject)((_, i) => i % 2 === 0, list);\nconst pickOdd = (list) => addIndex(reject)((_, i) => i % 2 !== 0, list);\n\n/**\n/ Re-order items from the middle out, alternating in direction.\n/\n/ Example:\n/ middleOut([1, 2, 3, 4, 5]) //=> [4, 2, 1, 3, 5]\n*/\nconst middleOut = (rows) => {\n  const above = pickEven(rows);\n  const below = pickOdd(rows);\n  return concat(reverse(above), below);\n};\n\nconst toRows = (circles) => {\n  return splitEvery(Math.ceil(Math.sqrt(circles.length)), circles);\n};\n\nexport default packGrid;\n","import { packEnclose } from \"d3-hierarchy\";\nimport packGrid from \"./pack-grid\";\n\n/**\n * An adaptation of the circle packing algorithm to reserve spacing at the\n * bottom of each non-leaf circle for labeling.\n */\nconst packWithLabel = () => {\n  let options = {\n    // Radius funcion\n    // See d3.pack.radius\n    radius: null,\n\n    // Layout size\n    // See d3.pack.size\n    size: [1, 1],\n\n    // Padding constant/function\n    // See d3.pack.padding\n    padding: () => 0,\n\n    // A number in [0, 1) that determine the portion of the circle that is\n    // reserved for label.\n    //\n    // To ensure label display are consistent between siblings, all siblings\n    // circles use the label size of the largest circle.\n    labelRatio: 0.25,\n\n    // But we ensure smaller circle doesn't look like Ben Solo with its high\n    // waisted pant.\n    maxLabelRatio: 0.4,\n\n    // The packing method for packing siblings node.\n    // By default use the packGrid method. Can be set to use D3's packSiblings\n    // method instead.\n    packSiblings: packGrid\n  };\n\n  /**\n   * @param root - A D3 hierarchy object\n   * @return A `pack` object similar to `d3.pack` but with additional options (see above)\n   */\n  const pack = (root) => {\n    root.x = options.size[0] / 2;\n    root.y = options.size[1] / 2;\n    const { radius, size, labelRatio, maxLabelRatio, packSiblings } = options;\n    const padding =\n      typeof options.padding === \"function\" ? options.padding : () => options.padding;\n\n    if (radius) {\n      root\n        .eachBefore(radiusLeaf(radius))\n        .eachAfter(packChildren(packSiblings, labelRatio, maxLabelRatio, padding, 0.5))\n        .eachBefore(translateChild(1));\n    } else {\n      // If radius is not specified, set each leaf node's radius based on its\n      // value, then resize the entire layout to fit options.size\n      root\n        .eachBefore(radiusLeaf((d) => Math.sqrt(d.value)))\n        .eachAfter(packChildren(packSiblings, labelRatio, maxLabelRatio, () => 0, 1))\n        .eachAfter(\n          packChildren(\n            packSiblings,\n            labelRatio,\n            maxLabelRatio,\n            padding,\n            root.r / Math.min(...size)\n          )\n        )\n        .eachBefore(translateChild(Math.min(...size) / (2 * root.r)));\n    }\n    return root;\n  };\n\n  /**\n   * Create an option method for each of the option above.\n   * Calling the method without arguments returns the current value.\n   * Calling the method with argument sets the option.\n   *\n   * Example:\n   * var pack = packWithLabel(root)\n   *              .radius(() => 20)\n   * pack.radius() //=> () => 20.\n   */\n  Object.keys(options).forEach((key) => {\n    pack[key] = (...values) => {\n\n      if (values.length === 0) {\n        return options[key];\n      }\n      options[key] = values[0];\n      return pack;\n    };\n  });\n\n  return pack;\n};\n\nconst radiusLeaf = (radius) => {\n  return (node) => {\n    if (!node.children) {\n      node.r = Math.max(radius(node), 0);\n    }\n  };\n};\n\nconst getLabelSize = (labelRatio) => (node) => {\n  return 2 * node.r * labelRatio / (1 - labelRatio);\n};\n\n/**\n * Pack children of a node, then set the node's radius to enclose all the children\n */\nconst packChildren = (packSiblings, labelRatio, maxLabelRatio, padding, k) => (node) => {\n  if (!node.children) {\n    return;\n  }\n\n  const children = node.children;\n\n  const nonleafChildren = children.filter((child) => child.height > 0);\n\n  // Calculate the label size of the largest non-leaf children\n  // and expand their radii accordingly to make space for label.\n  if (nonleafChildren.length > 0) {\n    const labelSize = Math.max(...nonleafChildren.map(getLabelSize(labelRatio)))\n\n    nonleafChildren.forEach((node) => {\n      node.labelSize = Math.min(labelSize, getLabelSize(maxLabelRatio)(node));\n      node.r += node.labelSize / 2;\n    });\n  }\n\n  const paddingSize = padding(node) * k || 0;\n\n  // Padding is implemented by adding it to the children's radii, pack,\n  // then returning the radii to their original value.\n  if (paddingSize) {\n    children.forEach((child) => (child.r += paddingSize));\n  }\n\n  packSiblings(children);\n  const enclosingRadius = packEnclose(children).r;\n\n  if (paddingSize) {\n    children.forEach((child) => (child.r -= paddingSize));\n  }\n\n  node.r = enclosingRadius + paddingSize;\n};\n\n// Set the the node's children's positions to be inside the node and above the\n// space reserved for labeling.\nconst translateChild = (k) => (node) => {\n  const parent = node.parent;\n  node.r *= k;\n\n  if (node.labelSize) {\n    node.labelSize *= k;\n    node.labelY = node.r - node.labelSize / 2;\n    node.labelWidth = 2 * Math.sqrt(node.r ** 2 - node.labelY ** 2);\n  }\n\n  if (parent) {\n    node.x = parent.x + k * node.x;\n    node.y = parent.y + k * node.y;\n    if (parent.labelSize) {\n      node.y -= parent.labelSize / 2;\n    }\n  }\n};\n\nexport default packWithLabel;\n","import { chain, head, tail, map, reduce, path, isNil } from \"ramda\";\nimport { nest } from \"d3-collection\";\nimport { hierarchy as d3Hierarchy } from \"d3-hierarchy\";\n\n/**\n * Convert an array of nodes into a D3 hierarchy\n *\n * @param [array] data - an array of data\n * @hierarchy [array] - an array of objects in the shape of\n * {\n *   displayName: string,\n *   path: array[string]\n * }\n */\n\nconst toHierarchy = (data, hierarchyConfig) => {\n  const nesting = nestHierarchy(hierarchyConfig).entries(data);\n  const result = entriesToHierarchy(\"root\", null, hierarchyConfig, nesting);\n  return d3Hierarchy(result);\n};\n\n/**\n * Create the D3 nest function that will nest data given the hierarchyConfig.\n */\nconst nestHierarchy = (hierarchyConfig) => {\n  return reduce(\n    (nest, field) => {\n      return nest.key((d) => path(field.path, d));\n    },\n    nest(),\n    hierarchyConfig\n  );\n};\n\nconst countSearchResults = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._searchResultCount || 0) + (children[c].CRVIZ._isSearchResult || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countSearchResults(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\n/**\n * Convert nest entries into the format accepted by d3.hierarchy\n */\nconst entriesToHierarchy = (fieldValue, field, hierarchyConfig, entries) => {\n  if (fieldValue === 'Unknown') {\n    return {\n      fieldValue,\n      field,\n      children: chain(getLeaves, entries),\n      CRVIZ:{ _SEARCH_RESULT_COUNT: countSearchResults(entries) }\n    }\n  }\n\n  return {\n    fieldValue,\n    field,\n    children: map((entry) => {\n      if (entry.values) {\n        return entriesToHierarchy(\n          entry.key,\n          head(hierarchyConfig),\n          tail(hierarchyConfig),\n          entry.values\n        );\n      } else {\n        return entry;\n      }\n    }, entries),\n    CRVIZ:{ _SEARCH_RESULT_COUNT: countSearchResults(entries) }\n  };\n};\n\nconst getLeaves = (entry) => {\n  if (entry.values) {\n    return chain(getLeaves, entry.values)\n  } else {\n    return [entry]\n  }\n}\n\nexport default toHierarchy;\n","\n/**\n * Return a string that can be used to check if two data are the same.\n*/\nconst datumKey = (datum) => {\n  if (datum.depth === 0) {\n    return 'root';\n  } else if (datum.height > 0) {\n    return [\n      datumKey(datum.parent),\n      datum.data.field.path.join(\".\"),\n      datum.data.fieldValue\n    ].join(\".\");\n  } else {\n    return datum.data.uid;\n  }\n};\n\nexport default datumKey;\n","import { path } from \"d3-path\";\nimport datumKey from \"./datum-key\";\n\nconst appendCircles = ({ nodeRoot, labelRoot, packedData, showNodes, hasSearch }) => {\n  const isInternal = (d) => d.depth > 0 && d.height > 0;\n\n  const data = packedData.descendants();\n\n  const nodes = nodeRoot\n    .selectAll(`g.${className(\"node\")}`)\n    .data(data, datumKey);\n\n  nodes.exit().remove();  \n\n  const nodesEnter = nodes.enter().append(\"g\").classed(className(\"node\"), true);\n  nodesEnter\n    .merge(nodes)\n    .attr('data-key', datumKey)\n    .classed(className(\"rootNode\"), (d) => d.depth === 0)\n    .classed(className(\"groupingNode\"), (d) => d.depth > 0 && d.height > 0)\n    .classed(className(\"containsSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount > 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"containsNoSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount === 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"searchResult\"), (d) => hasSearch && d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"isChanged\"), (d) => d.data.CRVIZ._isChanged && d.depth > 0 && d.height === 0)\n    .classed(className(\"isAdded\"), (d) => d.data.CRVIZ._isAdded && d.depth > 0 && d.height === 0)\n    .classed(className(\"isRemoved\"), (d) => d.data.CRVIZ._isRemoved && d.depth > 0 && d.height === 0)\n    .classed(className(\"searchExcluded\"), (d) => hasSearch && !d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"leafNode\"), (d) => d.height === 0)\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .attr(\"display\", (d) => !showNodes && d.height === 0 ? 'none' : null)\n    .order();\n\n  const circles = nodes.select(\"circle\").merge(nodesEnter.append(\"circle\"));\n\n  circles.attr(\"r\", (d) => d.r);\n\n  const labelShapes = nodes.select(\"path\").merge(nodesEnter.append(\"path\"));\n\n  labelShapes\n    .filter((d) => d.labelSize)\n    .attr(\"class\", className(\"labelShape\"))\n    .attr(\"d\", getLabelShape);\n\n  const labels = labelRoot\n    .selectAll(`text.${className(\"label\")}`)\n    .data(packedData.descendants().filter(isInternal));\n\n  labels.exit().remove();\n\n  const labelsEnter = labels\n    .enter()\n    .append(\"text\")\n    .classed(className(\"label\"), true);\n\n  const countLabels = labelRoot\n    .selectAll(`text.${className(\"countLabel\")}`)\n    .data(packedData.descendants().filter((d) => d.height === 1))\n\n  countLabels.exit().remove();\n\n  const countLabelsEnter = countLabels\n    .enter()\n    .append(\"text\")\n    .classed(className(\"countLabel\"), true);\n\n  countLabels\n    .merge(countLabelsEnter).text((d) => d.value )\n    .style(\"display\", showNodes ? 'none' : 'block');\n\n  return [\n    nodes.merge(nodesEnter),\n    labels.merge(labelsEnter),\n    countLabels.merge(countLabelsEnter)\n  ];\n};\n\n/**\n * Calculate the d attribute of a path element representing the shape of the\n * label area (the partial circles at the bottom of the grouping nodes)\n */\nconst getLabelShape = (d) => {\n  const top = d.r - d.labelSize;\n  const radius = d.r;\n\n  const startAngle = Math.PI / 2 + Math.acos(top / radius);\n  const endAngle = Math.PI / 2 - Math.acos(top / radius);\n\n  const shape = path();\n  shape.arc(0, 0, radius, startAngle, endAngle, true);\n  shape.closePath();\n  return shape.toString();\n\n}\n\nconst className = (name) => `viz-${name}`;\n\nexport default appendCircles;\n","import { memoizeWith } from \"ramda\";\n\nconst context = document.createElement(\"canvas\").getContext(\"2d\");\n\nconst memoizeKey = (font, text) => [font, text].join(\" \");\n\n/**\n * Measure width and height of text using canvas.\n * return an array [width, height]\n */\nconst measureText = memoizeWith(memoizeKey, (font, text) => {\n  context.font = font;\n\n  return [\n    Math.floor(context.measureText(text).width),\n    // Chrome doesn't support advanced text metrics yet, so\n    // we'll use the width of the letter M as an approximation of text height.\n    // https://youtu.be/Ps6GBLlSGLs?t=22m51s\n    Math.floor(context.measureText(\"M\").width)\n  ];\n});\n\nconst fitText = (font, text, width) => {\n  var original = text;\n  // var fontSpec = getFontSpec(textElement);\n  // var fontSpec = '12px sans-serif';\n  var textLength = measureText(font, text)[0];\n\n  while (textLength >= width && text.length > 0) {\n    text = text.slice(0, text.length - 1);\n    textLength = measureText(font, text + \"…\")[0];\n  }\n\n  return text + (text.length < original.length ? String.fromCharCode(8230) : \"\");\n}\n\n\n\n/**\n * Get CSS font from DOM node\n * Return the entire string, e.g. \"12px sans-serif\"\n */\nconst getFont = (domElement) => {\n  const style = getComputedStyle(domElement);\n  const family = style.getPropertyValue('font-family')\n  const size = style.getPropertyValue('font-size')\n\n  return  size + \" \" + family;\n}\n\nexport { measureText, fitText, getFont };\n","import { zoom, zoomTransform } from \"d3-zoom\";\nimport { event as d3Event } from \"d3-selection\";\nimport { zoomIdentity } from \"d3-zoom\";\nimport { measureText, fitText, getFont } from \"./text-utils\";\n\nconst setupZoom = ({\n  zoomRoot,\n  transformRoot,\n  nodes,\n  labels,\n  countLabels,\n  showNodes,\n  width,\n  height,\n  packedData\n}) => {\n\n  const state = {\n    zoomTo: null,\n    zoomToTransform: null,\n    // Find the current zoom transform if any\n    transform: zoomTransform(zoomRoot.node())\n  };\n\n  const zoomBehavior = zoom();\n\n  zoomBehavior.on(\"zoom\", () => {\n    const event = d3Event;\n    state.transform = event.transform;\n    zoomToTransform(event.transform)\n  });\n\n  zoomRoot.call(zoomBehavior);\n\n  // Amount of space to leave around a node when zoomed into that node\n  // (as a fraction of the node diameter)\n  const viewPadding = 0.25;\n\n  const { r: rootR, x: rootX, y: rootY } = packedData;\n\n  const scaleExtent = [\n    Math.min(width, height) / (rootR * 2),\n    Math.min(width, height) / (packedData.leaves()[0].r * 2 * (1 + viewPadding))\n  ];\n\n  const translateExtent = [\n    [\n      rootX - width / 2 / scaleExtent[0] * 2,\n      rootY - height / 2 / scaleExtent[0] * 2\n    ],\n    [\n      rootX + width / 2 / scaleExtent[0] * 2,\n      rootY + height / 2 / scaleExtent[0] * 2\n    ]\n  ];\n\n  zoomBehavior.scaleExtent(scaleExtent).translateExtent(translateExtent);\n\n  // Assume everything is hidden by default.\n  //\n  // Note:\n  // This could have been done using inline style.\n  // The odd thing is, when using inline style, apparently each node's style is\n  // recalculated in every frame during zooming regardless of whether or not\n  // the inline style was changed.\n  //\n  // Using a class avoided this issue.\n  nodes.classed('viz-zoomMinutia', true);\n\n  const [labelFont, labelHeight] = getLabelStyle(labels);\n  const [countLabelFont, countLabelHeight] = getLabelStyle(countLabels);\n\n  function zoomToTransform(transform) {\n    transformRoot\n      .style(\"transform\", `translate(${ Math.floor(transform.x) }px, ${ Math.floor(transform.y) }px) scale(${ transform.k })`);\n\n    const bound = viewBound(width, height, transform);\n\n    const nodesInView = nodes.filter((d) => boundOverlap(bound, nodeBound(d)));\n    const labelsInView = labels.filter((d) => boundOverlap(bound, nodeBound(d)));\n    const labelsNotInView = labels.filter((d) => !boundOverlap(bound, nodeBound(d)));\n    const countLabelsInView = countLabels.filter((d) => boundOverlap(bound, nodeBound(d)));\n    const hiddenCountLabels = countLabels.filter((d) => !boundOverlap(bound, nodeBound(d)));\n\n    nodesInView\n      .call(hideSmall, transform)\n\n    labelsInView\n      .style('visibility', 'visible')\n      .call(fitLabels, transform, labelFont, labelHeight, bound);\n\n    labelsNotInView.style('visibility', 'hidden');\n\n    countLabelsInView\n      .style('visibility', 'visible')\n      .call(fitCounts, transform, countLabelFont, countLabelHeight, bound);\n\n    hiddenCountLabels.style(\"visibility\", \"hidden\");\n  };\n\n  function zoomTo(datum, animate = true) {\n    const size = datum.r * 2 * (1 + viewPadding);\n    const k = Math.min(width, height) / size;\n    const transform = zoomIdentity\n      .scale(k)\n      .translate(\n          - datum.x + width / 2 / k,\n          - datum.y + height / 2 / k,\n      );\n\n    zoomBehavior.transform(\n      !animate ? zoomRoot : zoomRoot.transition().duration(1000),\n      transform\n    );\n  }\n\n  if (state.transform) {\n    zoomToTransform(state.transform);\n  }\n\n  state.zoomTo = zoomTo;\n  state.zoomToTransform = zoomToTransform;\n\n  return state;\n};\n\nconst hideSmall = (nodes, transform) => {\n  const tooSmall = (d) => d.r * transform.k < 1;\n\n  nodes\n    .filter(\":not(.viz-zoomMinutia)\")\n    .filter((d) => tooSmall(d))\n    .classed(\"viz-zoomMinutia\", true);\n\n  nodes\n    .filter(\".viz-zoomMinutia\")\n    .filter((d) => !tooSmall(d))\n    .classed(\"viz-zoomMinutia\", false)\n};\n\nconst fitCounts = (countLabels, transform, font, countHeight, viewBound) => {\n  const fitVertically = (d) => (d.r * 2 - d.labelSize) * transform.k * 0.66 >= countHeight;\n\n  countLabels\n    .style(\"visibility\", (d) => fitVertically(d) ? \"visible\" : \"hidden\")\n    .filter(fitVertically)\n    .text((datum) => {\n      const labelText = datum.value;\n      const maxWidth = Math.floor(datum.r * 2 * 0.75 * transform.k);\n      return fitText(font, labelText, maxWidth);\n    })\n    .attr(\"transform\", (d) => {\n      return zoomIdentity\n        .translate(transform.applyX(d.x), transform.applyY(d.y - (d.labelSize / 2)))\n    });\n};\n\nconst fitLabels = (labels, transform, labelFont, labelHeight, viewBound) => {\n  const fitVertically = (d) => d.labelSize * transform.k >= labelHeight;\n\n  labels\n    .style(\"visibility\", (d) => (fitVertically(d) ? \"visible\" : \"hidden\"))\n    .filter(fitVertically)\n    .text((datum) => {\n      const labelText = `${datum.data.fieldValue} (${datum.value})`;\n      // We'll try to fit more text on the label at the expense\n      // of possibly having labels extend outside of their area.\n      const maxWidth = Math.floor(datum.labelSize * transform.k * 1.2);\n      return fitText(labelFont, labelText, maxWidth);\n    })\n    .attr(\"transform\", (d) => {\n      return zoomIdentity\n        .translate(transform.applyX(d.x), transform.applyY(d.y + d.labelY))\n    })\n};\n\n/**\n * The bound of the view given the original width, height, and transform\n */\nconst viewBound = (width, height, transform) => {\n  var size = Math.min(width, height);\n  var boundWidth = size * Math.max(width / height, 1);\n  var boundHeight = size * Math.max(height / width, 1);\n\n  var bound = [\n    -transform.x / transform.k,\n    -transform.y / transform.k,\n    (-transform.x + boundWidth) / transform.k,\n    (-transform.y + boundHeight) / transform.k\n  ];\n  return bound;\n};\n\nconst nodeBound = (datum) => [\n  datum.x - datum.r,\n  datum.y - datum.r,\n  datum.x + datum.r,\n  datum.y + datum.r\n];\n\nconst boundOverlap = (bound0, bound1) => {\n  return (\n    bound0[0] <= bound1[2] &&\n    bound0[2] >= bound1[0] &&\n    bound0[1] <= bound1[3] &&\n    bound0[3] >= bound1[1]\n  );\n};\n\nconst getLabelStyle = (labels) => {\n  let font = null,\n    height = null;\n  if (labels.size() > 0) {\n    font = getFont(labels.nodes()[0]);\n    height = measureText(font, \"M\")[1];\n  }\n\n  return [font, height];\n};\n\nexport default setupZoom;\n","import { map, join, path } from \"ramda\";\nimport { select, event as d3Event } from \"d3-selection\";\n\nconst setupTooltip = ({ nodeRoot, tooltip, fields }) => {\n  tooltip\n    .style(\"display\", \"block\")\n    .style(\"position\", \"absolute\")\n    .style(\"transform\", null)\n    .style(\"top\", \"0px\")\n    .style(\"left\", \"0px\");\n\n  const boundingRect = tooltip.node().getBoundingClientRect();\n\n  const offsetLeft = -boundingRect.left + 5;\n  const offsetTop = -boundingRect.top + 5;\n\n  // Measurements need to be taken before hiding the tooltip, otherwise they are\n  // not accurate.\n  tooltip.style(\"display\", \"none\")\n\n  nodeRoot.on(\"mousemove\", () => {\n    const event = d3Event;\n    showTooltip(event, fields, offsetTop, offsetLeft, tooltip);\n\n  });\n};\n\nconst showTooltip = (event, fields, offsetTop, offsetLeft, tooltip) => {\n  const target = select(event.target);\n  const datum = target.datum();\n  const text = content(datum, fields);\n  if (text) {\n    tooltip.node().innerHTML = text;\n    tooltip\n      .style(\"display\", \"block\")\n      .style(\"transform\", `translate3d(${ event.x + offsetLeft + 1 }px, ${ event.y + offsetTop + 1 }px, 0)`)\n  } else {\n    tooltip.style(\"display\", \"none\");\n  }\n  //tooltip.classed(\"searchResult\", datum.data.isSearchResult);\n};\n\nconst content = (datum, fields) => {\n  if (datum.depth > 0 && datum.height > 0) {\n    let cont = `${ datum.data.fieldValue } (${datum.value})`;\n    if(datum.data.CRVIZ._searchResultCount > 0){\n      cont += `<br/><span>${datum.data.CRVIZ._searchResultCount} search results</span>`\n    }\n    return cont;\n  } else if (datum.height === 0) {\n    const pairs = map(\n      (field) => [`<strong>${ field.displayName }</strong>`, path(field.path, datum.data)],\n      fields\n    );\n    return map(join(\": \"), pairs).join(\"<br />\");\n  } else {\n    return null;\n  }\n};\n\nexport default setupTooltip;\n","import { times, concat } from \"ramda\";\nimport { scaleLinear, scalePow } from 'd3-scale';\nimport { hcl } from \"d3-color\";\n\nconst colorScheme = [\n  \"#a6cee3\",\n  \"#3366cc\",\n  \"#b2df8a\",\n  \"#33a02c\",\n  \"#fb9a99\",\n  \"#996699\",\n  \"#fdbf6f\",\n  \"#ff7f00\",\n  \"#cc99ff\",\n  \"#6a3d9a\",\n  \"#ffff99\",\n  \"#b15928\",\n  \"#ffcc99\",\n  \"#333399\"\n];\n\nconst extendColorScheme = (colorScheme, count) => {\n  const extraLayers = Math.floor(count / colorScheme.length);\n\n  if (extraLayers === 0) {\n    return colorScheme;\n  }\n\n  const extraColors = times((i) => {\n    const currentLayer = (i + colorScheme.length) / colorScheme.length;\n\n    const previous = hcl(colorScheme[i % colorScheme.length])\n    const neighbor = hcl(colorScheme[(i + 1) % colorScheme.length])\n\n    const hScale = scaleLinear()\n      .domain([0, extraLayers])\n      .range([previous.h, neighbor.h]);\n\n    const cScale = scalePow()\n      .exponent(5)\n      .domain([0, extraLayers])\n      .range([previous.c, 100]);\n\n    const lScale = scalePow()\n      .exponent(2)\n      .domain([0, extraLayers])\n      .range([previous.l, previous.l / 2]);\n\n    const h = hScale(currentLayer)\n    const c = cScale(currentLayer);\n    const l = lScale(currentLayer);\n\n    const nextColor = hcl(h, c, l);\n    return nextColor.toString();\n  }, count - colorScheme.length);\n\n  return concat(colorScheme, extraColors)\n}\n\nexport { colorScheme, extendColorScheme };\n","import { selectAll, select, event as d3Event } from 'd3-selection';\n\nimport {\n  contains,\n  either,\n  equals,\n  fromPairs,\n  toPairs,\n  identity,\n  map,\n  path,\n  pipe,\n  sortBy,\n  uniq,\n  zip\n} from \"ramda\";\n\nimport { colorScheme, extendColorScheme } from './color-scheme';\n\nfunction setupLegend({ legend, data, hierarchyConfig, coloredField, legendConfig }) {\n  if (!coloredField) {\n    legend.style(\"display\", \"none\");\n\n    const state = { nodes: [] }\n\n    function update({ nodes }) {\n      state.nodes = nodes;\n      nodes.classed('viz-coloredNode', coloredField);\n      if (!coloredField) {\n        nodes.select('circle').attr('class', null);  \n        return;\n      }\n    }\n\n    return { update };\n  } else {\n    legend.style(\"display\", null);\n  }\n\n  const getValue = either(path(coloredField.path), path([\"fieldValue\"]));\n\n  // If coloring groupings, don't color devices with the same value\n  const isColoringGroup = contains(coloredField, hierarchyConfig);\n\n  const values = pipe(\n    map(getValue),\n    uniq,\n    sortBy(identity)\n  )(data);\n\n  const scheme = extendColorScheme(colorScheme, values.length);\n\n  const configs = scheme.map((color, index) => {\n    return {\n      color,\n      disabled: false,\n      className: `legend-color-${index}`\n    }\n  });\n\n  const coloring = zip(values, configs);\n  const colorMap = fromPairs(coloring);\n\n  createStylesheet(coloring);\n\n  const state = { nodes: [] }\n\n  function update({ nodes }) {\n    state.nodes = nodes;\n    nodes.classed('viz-coloredNode', coloredField);\n    if (!coloredField) {\n      nodes.select('circle').attr('class', null);   \n      return;\n    }\n\n    colorNodes({ nodes, colorMap, getValue, coloredField, isColoringGroup });\n    updateLegend({ legend, colorMap, toggleValue })\n  }\n\n  function toggleValue(value) {\n    colorMap[value].disabled = !colorMap[value].disabled;\n    update({ nodes: state.nodes });\n  }\n\n  return { update, colorMap };\n}\n\nconst updateLegend = ({ legend, colorMap, toggleValue }) => {\n  const items = legend\n    .selectAll(\"p.viz-legendItem\")\n    .data(toPairs(colorMap), ([value]) => value );\n\n  items.exit().remove();\n\n  const itemsEnter = items.enter().append(\"p\").classed(\"viz-legendItem\", true)\n  itemsEnter.append(\"span\").classed(\"viz-legendColor\", true);\n  itemsEnter.append(\"span\").classed(\"viz-legendLabel\", true);\n\n  items.merge(itemsEnter)\n    .classed(\"viz-legendDisabled\", (d) => d[1].disabled);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendColor\")\n    .style(\"background-color\", ([value, { color }]) => color);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendLabel\")\n    .attr('title', ([value]) => value)\n    .text(([value]) => value);\n\n  legend.on('click.toggle', () => {\n    const datum = select(d3Event.target).datum();\n    if (datum) {\n      toggleValue(datum[0]);\n    }\n  })\n}\n\n/**\n * Having inline style trigger an expensive \"recalculate style\" in every frame\n * during zooming (even if the style attribute is empty!).\n *\n * We work around this by creating a style element that contains a class for\n * each item in the legend and assign those classes to each circle.\n*/\nconst createStylesheet = (coloring) => {\n  const style = selectAll('style#coloring').data([coloring]);\n  const styleEnter = style.enter().append('style').attr('id', 'coloring');\n\n  const html = coloring.map(([ value, { color, className } ], index) => {\n    return `\n      .viz-node circle.${className} {\n        fill: ${color} !important\n      }\n    `\n  }).join(\"\\n\");\n\n  style.merge(styleEnter)\n    .html(html)\n}\n\nconst colorNodes = ({ nodes, colorMap, getValue, coloredField, isColoringGroup }) => {\n  \n  nodes\n    .filter((d) => d.height === 0)\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return !isColoringGroup && !disabled && className ? className : null\n    });\n\n  nodes\n    .filter((d) => d.height > 0)\n    .classed(\"viz-coloredNode\", (d) => {\n      const { disabled } = colorMap[getValue(d.data)] || {};\n      return !disabled &&\n        equals(d.data.field, coloredField) \n    })\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return isColoringGroup\n        && equals(d.data.field, coloredField)\n        && !disabled\n        && className;\n    });\n}\n\nexport default setupLegend;\n","import { annotation, annotationCalloutCircle } from \"d3-svg-annotation\";\n\nconst setupAnnotations = ({nodeRoot, annotationRoot, colorMap}) =>{\n\tconst groupNodes = nodeRoot.selectAll(`g.${className(\"groupingNode\")}`).data();\n\n    const annotations = mapNodesToAnnotationArray(groupNodes, colorMap);\n    const anno = annotation();\n    const makeAnnotations = anno\n                            .annotations(annotations)\n                            .type(annotationCalloutCircle)\n                            .on('subjectover', function(annotation) {\n                              annotation.type.a.selectAll(\"g.annotation-connector, g.annotation-note\")\n                                .classed(\"hidden\", false);\n                              annotation.type.a.selectAll(\"g.annotation-subject\")\n                                .classed(\"hiddenSubject\", false);\n                            })\n                            .on('subjectout', function(annotation) {\n                              annotation.type.a.selectAll(\"g.annotation-connector, g.annotation-note\")\n                                .classed(\"hidden\", annotation.data.depth > 1);\n                              annotation.type.a.selectAll(\"g.annotation-subject\")\n                                .classed(\"hiddenSubject\", annotation.data.depth > 1);\n                            });\n\n    annotationRoot.call(makeAnnotations);                \n    return anno;\n}\n\nconst mapNodesToAnnotationArray = (nodes, colorMap) =>{\n  const annotations = nodes.map( d => ({\n    'data': { 'fieldData': d.data, 'height': d.height, 'depth': d.depth }, \n    className: className(\"annotation\"),\n    'x': d.x,\n    'y': d.y,\n    'dx': d.r,\n    'dy': -1 * (d.labelY + (d.labelSize/2)),\n    'note':{\n      'label': d.data.fieldValue || '',\n      'title': d.data.fieldValue || ''\n    },\n    'subject': { 'radius': d.r -1 },\n    'color': colorMap[d.data.fieldValue] && !colorMap[d.data.fieldValue].disabled ? \n                colorMap[d.data.fieldValue].color : \"black\"\n  }));\n  return annotations;\n}\n\nconst className = (name) => `viz-${name}`;\n\nexport default setupAnnotations;","import { select, event as d3Event } from \"d3-selection\";\n\nimport { ResizeSensor } from \"css-element-queries\";\nimport debounce from \"lodash.debounce\";\n\nimport {\n  allPass,\n  eqProps,\n  eqBy,\n  find,\n  map,\n  reduce,\n  reduceWhile,\n  reduced,\n  reverse,\n  tail\n} from \"ramda\";\n\nimport packWithLabel from \"./d3-viz/pack-with-label\";\nimport toHierarchy from \"./d3-viz/to-hierarchy\";\nimport appendCircles from \"./d3-viz/append-circles\";\nimport setupZoom from \"./d3-viz/setup-zoom\";\nimport setupTooltip from \"./d3-viz/setup-tooltip\";\nimport setupLegend from \"./d3-viz/setup-legend\";\nimport setupAnnotations from \"./d3-viz/setup-annotations\";\nimport datumKey from \"./d3-viz/datum-key\";\n\nfunction d3Viz(rootNode) {\n  const root = select(rootNode);\n  // const width = rootNode.clientWidth;\n  // const height = rootNode.clientHeight;\n\n  /**\n   * Stationary div that receive mouse events for zooming.\n   */\n  const zoomRoot = root\n    .append(\"div\")\n    .attr(\"data-node\", \"zoomRoot\")\n    .style(\"position\", \"relative\")\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  root.style(\"position\", \"relative\");\n\n  /**\n   * The container that is scaled and transformed.\n   *\n   * Use a div with CSS 3D transform to get hardware acceleration.\n   * SVG transform are not hardware accelerated.\n   */\n  const transformRoot = zoomRoot\n    .append(\"div\")\n    .attr(\"data-node\", \"transformRoot\")\n    .style(\"position\", \"absolute\")\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\")\n    .style(\"transform-origin\", \"top left\");\n\n  /**\n   * Label are placed in a separate element so that they are not scaled\n   * together with the circles.\n   */\n  const labelRoot = zoomRoot\n    .append(\"svg\")\n    .style(\"position\", \"absolute\")\n    .style(\"pointer-events\", \"none\") // Let the underlying circles get mouse events.\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  const svg = transformRoot.append(\"svg\")\n                           .style(\"overflow\", \"visible\")\n                           .attr(\"class\", \"nodeRoot\");\n\n  const tooltip = root.append(\"div\").classed(\"viz-tooltip\", true);\n  const legend = root.append(\"div\").classed(\"viz-legend\", true);\n\n  const nodeRoot = svg.append(\"g\");\n\n  const annotationRoot = svg.append(\"g\")\n                         .attr(\"class\", \"annotation-root\")\n\n  // State\n  let props = {\n    hierarchyConfig: null,\n    data: null,\n    fields: null,\n    width: rootNode.clientWidth,\n    height: rootNode.clientHeight,\n    showNodes: true,\n    coloredField: null,\n    queryString: ''\n  };\n\n  const state = {\n    packedData: null,\n    nodes: null,\n    labels: null,\n    countLabels: null,\n    zoom: null,\n    selectedNode: null,\n    legend: null\n  };\n\n  new ResizeSensor(rootNode, debounce(() => update(props), 100));\n\n  function update(nextProps) {\n    nextProps = {\n      ...nextProps,\n      width: rootNode.clientWidth,\n      height: rootNode.clientHeight,\n      hasSearch: nextProps.hasSearch\n    };\n\n    const dataUpdated = !allEqProps(\n      [\"hierarchyConfig\", \"data\", \"fields\", \"queryString\"],\n      props,\n      nextProps\n    );\n\n    const sizeUpdated = !allEqProps([\"width\", \"height\"], props, nextProps);\n\n    const legendUpdated = !allEqProps([\"coloredField\", \"hierarchyConfig\", \"data\"], props, nextProps);\n\n    props = nextProps;\n\n    if (dataUpdated) {\n      repack(props, state);\n    }\n\n    rerender(props, state);\n\n    if (legendUpdated) {\n      resetLegend(props, state);\n    } else {\n      state.legend && state.legend.update({ nodes: state.nodes })\n    }\n\n    if (sizeUpdated || dataUpdated) {\n      resetZoom(props, state);\n    }\n\n    resetAnnotations(props, state);\n  }\n\n  const repack = (props, state) => {\n    const hierarchy = makeHierarchy(props.data, props.hierarchyConfig);\n\n    const pack = packWithLabel().size([props.width, props.height]);\n\n    // Pack once without padding to calculate the radius of the leaf node\n    // then repack with new padding, similar to how d3-pack\n    // works when the size is not given.\n    //\n    // This way spacing between leaf nodes is consistent between visualizations.\n    //\n    // Doesn't seem to have a noticable performance impact.\n    const packed = pack(hierarchy);\n    const padding = packed.leaves()[0].r;\n    pack.padding((d) => padding * d.height);\n\n    state.packedData = pack(hierarchy);\n  };\n\n  const rerender = (props, state) => {\n    const [nodes, labels, countLabels] = appendCircles({\n      nodeRoot: nodeRoot,\n      labelRoot: labelRoot,\n      packedData: state.packedData,\n      showNodes: props.showNodes,\n      hasSearch: props.queryString !== ''\n    });\n\n    setupTooltip({\n      tooltip: tooltip,\n      fields: props.fields,\n      nodeRoot: nodeRoot\n    });\n\n    state.nodes = nodes;\n    state.labels = labels;\n    state.countLabels = countLabels;\n  };\n\n  const resetLegend = (props, state) => {\n    state.legend = setupLegend({\n      legend: legend,\n      hierarchyConfig: props.hierarchyConfig,\n      data: props.data,\n      coloredField: props.coloredField\n    });\n\n    if(state.legend != null){\n      state.legend.update({ nodes: state.nodes })\n    }\n  };\n\n  const resetZoom = (props, state) => {\n    state.zoom = setupZoom({\n      zoomRoot: zoomRoot,\n      transformRoot: transformRoot,\n      nodes: state.nodes,\n      labels: state.labels,\n      countLabels: state.countLabels,\n      width: props.width,\n      height: props.height,\n      packedData: state.packedData\n    });\n\n    let animate = true;\n\n    if (state.selectedNode) {\n      const selected = findAncestor(state.selectedNode, state.packedData);\n      state.selectedNode = selected;\n      animate = false; // smarter animation??\n    } else {\n      state.selectedNode = state.packedData;\n    }\n\n    state.zoom.zoomTo(state.selectedNode, animate);\n\n    nodeRoot.on(\"click.select\", () => {\n      const datum = select(d3Event.target).datum();\n      state.selectedNode = datum;\n      state.zoom.zoomTo(datum);\n    });\n  };\n\n  const resetAnnotations = (props, state) =>{\n    const annotations = setupAnnotations({\n      nodeRoot: nodeRoot,\n      annotationRoot: annotationRoot,\n      colorMap: state.legend && state.legend.colorMap ? state.legend.colorMap : []\n    })\n\n    annotations.annotations()\n    .forEach((a)=>{\n      a.type.a.selectAll(\"g.annotation-connector, g.annotation-note\")\n      .classed(\"hidden\", a.data.depth > 1);\n      a.type.a.selectAll(\"g.annotation-subject\")\n      .classed(\"hiddenSubject\", a.data.depth > 1);\n    })\n  };\n\n  return {\n    update\n  };\n}\n\nconst allEqProps = (props, o1, o2) => allPass(map(eqProps, props))(o1, o2);\n\nconst makeHierarchy = (data, hierarchyConfig) => {\n  const hierarchy = toHierarchy(data, hierarchyConfig).count();\n\n  const byUnknown = (a, b) => {\n    if (a.data.fieldValue === \"Unknown\") {\n      return b.data.fieldValue === \"Unknown\" ? 0 : 1;\n    } else {\n      return b.data.fieldValue === \"Unknown\" ? -1 : 0;\n    }\n  };\n\n  const bySize = (a, b) => (b.value || 0) - (a.value || 0);\n  const byName = (a, b) =>\n    (a.data.fieldValue || \"\").localeCompare(b.data.fieldValue || \"\");\n\n  return hierarchy.sort(composeComparators([byUnknown, bySize, byName]));\n};\n\n/**\n * Combine a list of comparator function ( (a, b) => Boolean )\n * in order into a single comparator.\n */\nconst composeComparators = (comparators) => (a, b) =>\n  reduceWhile(\n    (result) => result === 0, // keep comparing while a === b\n    (_, comparator) => comparator(a, b),\n    0,\n    comparators\n  );\n\n/**\n * Find the lowest ancestors of a node (or it self) that exists in a tree.\n */\nconst findAncestor = (node, hierarchy) => {\n  const path = reverse(node.ancestors());\n  const findChild = (parent, child) => {\n    return find(eqBy(datumKey, child), parent.children || []);\n  };\n\n  const res = reduce(\n    (last, child) => findChild(last, child) || reduced(last),\n    hierarchy,\n    tail(path)\n  );\n  return res;\n};\n\nexport default d3Viz;\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\n\nimport { connect } from \"react-redux\";\n\nimport { selectDatasetIntersection, selectMergedConfiguration } from \"domain/dataset\";\nimport { getQueryString } from \"epics/index-dataset-epic\";\nimport { selectControls } from \"domain/controls\";\n\nimport d3Viz from './d3-viz';\nimport styles from './Visualization.module.css';\n\nclass Visualization extends React.PureComponent {\n\n  componentDidMount() {\n    const el = ReactDOM.findDOMNode(this);\n    this.viz = d3Viz(el);\n    this.updateFromProps();\n  }\n\n  updateFromProps() {\n    this.viz.update({\n      hierarchyConfig: this.props.controls.hierarchyConfig,\n      fields: this.props.configuration.fields || [],\n      showNodes: this.props.controls.shouldShowNodes,\n      coloredField: this.props.controls.colorBy,\n      data: this.props.dataset || [],\n      queryString: this.props.queryString\n    });\n  }\n\n  componentDidUpdate() {\n    this.updateFromProps();\n  }\n\n  render() {\n    return <div className={ styles.viz }></div>;\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    dataset: selectDatasetIntersection(state, ownProps.startUid, ownProps.endUid),\n    configuration: selectMergedConfiguration(state),\n    controls: selectControls(state),\n    queryString: getQueryString(state)\n  };\n};\n\nexport default connect(mapStateToProps, null)(Visualization);\n","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport {  timer, of } from 'rxjs';\nimport { mergeMap, takeUntil, debounceTime } from 'rxjs/operators';\n\nimport { setIsFetching } from \"domain/dataset\";\nimport { fetchDataset } from './fetch-dataset-epic';\n\n// ACTIONS\nconst startRefresh = createAction('START_REFRESH_DATASET');\nconst stopRefresh = createAction('STOP_REFRESH_DATASET');\n\n// EPIC\nconst refreshDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(startRefresh.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner\n      const url = action.payload.url;\n      const header = action.payload.header;\n      const interval = action.payload.interval * 1000;\n      return timer(0, interval).pipe(\n          mergeMap(() => {\n            return of(\n              setIsFetching({'owner': owner, 'isFetching': true})\n              ,fetchDataset({'owner': owner, 'url': url, 'header':header})\n            )\n          })\n        ,takeUntil(action$.ofType(stopRefresh.toString()))\n        )\n    })  \n  );\n}\n\nexport default refreshDatasetEpic;\nexport { startRefresh, stopRefresh };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { isNil, find, propEq } from \"ramda\";\n\nfunction DatasetSelector({ className, selected, datasets, onChange }) {\n  return (\n    <div className={className}>\n      <label className=\"select\">\n      <select\n        onChange={(evt) => onChange(find(eqUrl(evt.target.value), datasets)) }\n        value={isNil(selected) ? \"\" : selected.url}\n      >\n        <option value=\"\">&mdash;None&mdash;</option>\n        {datasets.map((dataset) => {\n          return (\n            <option key={dataset.url} value={dataset.url}>\n              {dataset.name}\n            </option>\n          );\n        })}\n      </select>\n      </label>\n    </div>\n  );\n}\n\nconst eqUrl = propEq(\"url\");\n\nconst PropTypesDataset = PropTypes.shape({\n  name: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired\n});\n\nDatasetSelector.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypesDataset,\n  datasets: PropTypes.arrayOf(PropTypesDataset).isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetSelector;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { isNil } from \"ramda\";\n\nimport { FontAwesomeIcon }from \"@fortawesome/react-fontawesome\";\nimport { faUpload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetUpload({ className, selected, onChange, ownerUuid }) {\n  const inputId = \"file-input-\" + ownerUuid;\n  return (\n    <span className={ className }>\n      <input\n        type=\"file\"\n        id={inputId}\n        value=''\n        style={{'display':'none'}}\n        onChange={(evt) => onChange(evt.target.files[0])}\n      />\n\n    <span>\n      { isNil(selected) ? \"No file selected\" : selected }\n    </span>\n\n      <label htmlFor={inputId} className=\"button circular\" title=\"Upload data from file\">\n        <FontAwesomeIcon icon={faUpload} />\n      </label>\n    </span>\n  );\n}\n\nDatasetUpload.propTypes = {\n  ownerUuid: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetUpload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDownload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetDownload({ className, selected, url, disabled }) {\n  return (\n    <span className={ className }>\n      <a className=\"button circular\" href={ url } download={ selected + \".json\" }\n        title=\"Download\" disabled={disabled} >\n        <FontAwesomeIcon icon={faDownload} />\n      </a>\n    </span>\n  );\n}\n\nDatasetDownload.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  url: PropTypes.string\n};\n\nexport default DatasetDownload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faRedoAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetRefresh({ className, onClick, disabled }) {\n  return (\n    <span className={ className }>\n      <div className=\"button circular\" disabled={disabled} title=\"Refresh\" onClick={() => onClick()}>\n        <FontAwesomeIcon icon={faRedoAlt} />\n      </div>\n    </span>\n  );\n}\n\nDatasetRefresh.propTypes = {\n  className: PropTypes.string,\n  onClick: PropTypes.func.isRequired\n};\n\nexport default DatasetRefresh;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt,faStopCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetTimedRefresh({ className, interval, timerIsRunning, disabled, onIntervalChange, onStartClick, onStopClick }) {\n  return (\n    <span className={ className }>\n      <input type='text' title=\"Refresh interval in seconds\" value={interval} onChange={(evt) => onIntervalChange(evt.target.value)}/>\n      {!timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Start Refresh Timer\" onClick={() => onStartClick()}>\n\t        <FontAwesomeIcon icon={faSyncAlt} />\n\t      </div>\n  \t  }\n  \t  {timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Stop Refresh Timer\" onClick={() => onStopClick()}>\n\t        <FontAwesomeIcon icon={faStopCircle} />\n\t      </div>\n  \t  }\n    </span>\n  );\n}\n\nDatasetTimedRefresh.propTypes = {\n  className: PropTypes.string,\n  interval: PropTypes.number,\n  timerIsRunning: PropTypes.bool,\n  onIntervalChange: PropTypes.func.isRequired,\n  onStartClick: PropTypes.func.isRequired,\n  onStopClick: PropTypes.func.isRequired\n};\n\nexport default DatasetTimedRefresh;\n","import clonedeep from \"lodash.clonedeep\";\n\nconst getDataToExport = (datasets, keyFields, ignoredFields, controls) => {\n\tlet exportData = {};\n\n\tif(datasets)\n\t\texportData[\"datasets\"] = sanitizeForExport(datasets);\n\n\tif(keyFields)\n\t\texportData[\"keyFields\"] = keyFields;\n\n\tif(ignoredFields)\n\t\texportData[\"ignoredFields\"] = ignoredFields;\n\n\tif(controls)\n\t\texportData[\"controls\"] = controls;\n\n\treturn exportData;\n}\n\nconst sanitizeForExport = (datasets) =>{\n\tlet result = clonedeep(datasets);\n\tObject.keys(result).forEach((key) => {\n\t\tresult[key].dataset.forEach((item) => {\n\t\t\tdelete item.CRVIZ;\n\t\t});\n\t});\n\treturn result;\n}\n\nexport default getDataToExport;\nexport { getDataToExport };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { isNil } from \"ramda\";\nimport Modal from 'react-modal';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCheck, faTimes, faCog } from \"@fortawesome/free-solid-svg-icons\";\n\nimport { fetchDataset, buildAuthHeader } from \"epics/fetch-dataset-epic\";\nimport { startRefresh, stopRefresh } from \"epics/refresh-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport { showNodes, setHierarchyConfig, colorBy, selectControls } from \"domain/controls\"\n\nimport { setError } from \"domain/error\"\nimport { \n  setDataset, selectDataset, selectDatasets, removeDataset, \n  getIsFetching, setIsFetching, getLastUpdated, getKeyFields,\n  getIgnoredFields\n} from \"domain/dataset\";\n\nimport DatasetSelector from \"./DatasetSelector\";\nimport DatasetUpload from \"./DatasetUpload\";\nimport DatasetDownload from \"./DatasetDownload\";\nimport DatasetRefresh from \"./DatasetRefresh\";\nimport DatasetTimedRefresh from \"./DatasetTimedRefresh\";\nimport { getDataToExport } from \"./export\"\n\nimport style from \"./DatasetControls.module.css\";\n\nconst uuidv4 = require('uuid/v4');\n\nconst CUSTOM_DATASET = {\n  name: \"Custom URL\",\n  url: \"custom-url\"\n};\n\nconst authTypes = [\n  {'name': '-None-', 'scheme':'None' },\n  {'name': 'Username\\\\Password', 'scheme':'Basic' },\n  {'name': 'Token', 'scheme':'Bearer' },\n];\n\nvar host = window.location.host;\nvar hostname = window.location.hostname;\nvar port = '80';\nconst radix = 10;\nif (host.indexOf(':') > -1) {\n  port = String(parseInt(host.split(\":\")[1], radix)-1);\n}\n\nvar POSEIDON_DATASET = {\n  name: \"Poseidon Network\",\n  url: \"http://\"+hostname+\":\"+port+\"/v1/network\"\n};\n\nModal.setAppElement('#root');\n\nclass DatasetControls extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dataset: null,\n      selected: null,\n      selectedFile: null,\n      showUrlEntry: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n      refreshInterval: 0,\n      refreshTimerRunning: false\n    };\n  }\n\n  resetDataset = () => {\n    this.props.setDataset({ dataset: [], configuration: {} });\n    this.setState({\n      selected: null,\n      selectedFile: null\n    });\n  }\n\n  fetchAndSetDataset = (url, dataset, username, password, token) => {\n    this.props.setIsFetching({owner: this.props.uuid, isFetching: true});\n    const authHeader = buildAuthHeader(username, password, token);\n    if (toURL(url)) {\n      this.props.fetchDataset({ 'owner': this.props.uuid, 'url': url, 'header': authHeader });\n      this.setState({\n        selected: dataset,\n        selectedFile: null,\n      });\n    } else {\n      this.props.setError(new Error(\"Please enter a valid URL.\"));\n    }\n  }\n\n  onSelected = (dataset) => {\n    if (isNil(dataset)) {\n      return this.resetDataset();\n    }\n\n    this.props.removeDataset({owner: this.props.uuid});\n    this.props.removeSearchIndex({owner: this.props.uuid});\n    this.props.stopRefresh();\n\n    const showUrlEntry = dataset === CUSTOM_DATASET;\n    this.setState({ \n      showUrlEntry: showUrlEntry,\n      url: '',\n      authScheme:null,\n      token: '',\n      username: '',\n      password: '',\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n     });\n    if(!showUrlEntry)\n    {\n      const url = dataset.url;\n      this.fetchAndSetDataset(url, dataset, null, null, null);\n    }\n  }\n\n  onUpload = (file) => {\n    this.props.uploadDataset({ \n      'owner': this.props.uuid, \n      'file': file,\n      'includeData': true,\n      'includeControls': false,\n    });\n    this.props.stopRefresh();\n    this.setState({\n      selected: null,\n      selectedFile: file.name,\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n    });\n  }\n\n  onUrlChange = (evt) => {\n    this.setState({ url: evt.target.value });\n  }\n\n  onTokenChange = (evt) => {\n    this.setState({ token: evt.target.value });\n  }\n\n  onUsernameChange = (evt) => {\n    this.setState({ username: evt.target.value });\n  }\n\n  onPasswordChange = (evt) => {\n    this.setState({ password: evt.target.value });\n  }\n\n  onUrlOk = () => {\n    this.setState({ showUrlEntry: false });\n    const dataset = CUSTOM_DATASET;\n    if(!isNil(this.state.url))\n    {\n      const url = this.state.url;\n      dataset.url = url;\n      this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n    }\n  }\n\n  onUrlCancel = () => {\n    this.setState({ \n      showUrlEntry: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n     });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.props.fullDatasets;\n    const controls = this.props.controls;\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(getDataToExport(datasets, keyFields, ignoredFields, controls));\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  onRefresh = () =>{\n    const url = this.state.selected.url;\n    const dataset = this.state.selected;\n    this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n  }\n\n  onTimedRefreshStart = () =>{\n    this.props.setIsFetching({'owner': this.props.uuid, 'isFetching': true});\n    this.setState({\n      'refreshTimerRunning': true\n    });\n    const authHeader = buildAuthHeader(this.state.username, this.state.password, this.state.token);\n    const url = this.state.selected.url;\n    const interval = this.state.refreshInterval;\n    this.props.startRefresh({'owner': this.props.uuid,'url': url, 'header': authHeader, 'interval': interval});\n  }\n\n  onTimedRefreshStop = () =>{\n    this.setState({\n      'refreshTimerRunning': false\n    });\n    this.props.stopRefresh();\n  }\n\n  onTimedRefreshIntervalChanged = (interval) =>{\n    const numInt = parseInt(interval, 10);\n    if(!isNaN(numInt)){\n      this.setState({\n        refreshInterval: numInt,\n      });\n    }\n    else if(!interval){\n      this.setState({\n        refreshInterval: null,\n      });\n    }\n  }\n\n  render() {\n    if (port === '80') {\n      POSEIDON_DATASET = {name:\"\",url:\"\"};\n    }\n    const canDownload = this.state.selected && !this.state.selectedFile;\n    const canRefresh = this.state.selected && !isNil(this.state.selected.url)\n    return (\n      <div className={style.dataControls}>\n        <div className={style.selectorContainer}>\n          <span className={style.label}>Dataset</span>\n          <DatasetSelector\n            className={style.selector}\n            selected={this.state.selected}\n            onChange={this.onSelected}\n            datasets={[...this.props.datasets, POSEIDON_DATASET, CUSTOM_DATASET]}\n          />\n        </div>\n\n        <div className={style.uploadContainer}>\n          <span className={style.label}>Upload</span>\n          <DatasetUpload\n            ownerUuid={this.props.uuid}\n            className={style.fileUpload}\n            selected={this.state.selectedFile}\n            onChange={this.onUpload}\n          />\n        </div>\n\n          <div className={style.utilityContainer}>\n          { canDownload &&\n            <DatasetDownload\n              className={style.fileDownload}\n              selected={this.state.selected.name}\n              url={this.getDownloadUrl()}\n              disabled={this.props.isFetching}\n            />\n          }\n          { canRefresh &&\n            <div className={style.urlRefreshContainer}>\n              <DatasetRefresh\n                className={style.urlRefresh}\n                onClick={this.onRefresh}\n                disabled={this.props.isFetching}\n              />\n              <DatasetTimedRefresh\n                className={style.urlRefresh}\n                interval={this.state.refreshInterval}\n                timerIsRunning={this.state.refreshTimerRunning}\n                disabled={this.props.isFetching}\n                onIntervalChange={this.onTimedRefreshIntervalChanged}\n                onStartClick={this.onTimedRefreshStart}\n                onStopClick={this.onTimedRefreshStop}\n              />\n            </div>\n          }\n          </div>\n          <div className={style.urlRefreshTime}>\n            { canRefresh && this.props.isFetching &&\n              <span>\n                <FontAwesomeIcon className=\"fa-spin\" icon={faCog} /> Fetching Data...\n              </span>\n            }\n            { canRefresh && !this.props.isFetching &&\n              <span>\n                Last Updated: { this.props.lastUpdated ? (this.props.lastUpdated.toLocaleDateString() || \"\") + \" \" + (this.props.lastUpdated.toLocaleTimeString() || \"\") : \"Never\" }\n              </span>\n            }\n          </div>\n          <Modal isOpen={ this.state.showUrlEntry } onRequestClose={this.onUrlCancel} contentLabel=\"Enter a Url\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span>\n                  <label> URL </label>\n                  <input type=\"text\" value={this.state.url} onChange={ this.onUrlChange }/>\n                </span>\n                <span>\n                  <label> AuthType </label>\n                  <select\n                    onChange={(evt) => this.setState({ authScheme: evt.target.value })}\n                    value={isNil(this.state.authScheme) ? '' : this.state.authScheme}\n                  >\n                    {authTypes.map((at) => {\n                      return (\n                        <option key={at.scheme} value={at.scheme}>\n                          {at.name}\n                        </option>\n                      );\n                    })}\n                  </select>\n                </span>\n                { this.state.authScheme === 'Bearer' &&\n                  <span>\n                    <label> Token </label>\n                    <input type=\"text\" value={this.state.Token} onChange={ this.onTokenChange }/>\n                  </span> \n                }\n                { this.state.authScheme === 'Basic' &&\n                  <div>\n                    <span>\n                      <label> Username </label>\n                      <input type=\"text\" value={this.state.userName} onChange={ this.onUsernameChange }/>\n                    </span>\n                    <span>\n                      <label> Password </label>\n                      <input type=\"password\" value={this.state.password} onChange={ this.onPasswordChange }/>\n                    </span>\n                  </div>\n                }\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onUrlOk}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                    <div className=\"button circular\" title=\"Cancel\" onClick={this.onUrlCancel}>\n                        <FontAwesomeIcon icon={faTimes} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n          </Modal>\n      </div>\n    );\n  }\n}\n\nconst toURL = (url) => {\n  try {\n    return new URL(url)\n  } catch(error) {\n    if (error instanceof TypeError) {\n      return null;\n    } else {\n      throw error;\n    }\n  }\n}\n\nDatasetControls.defaultProps = {\n  uuid: uuidv4(),\n  datasets: [],\n  dataset: null,\n  hierarchyConfig: [],\n  configHasChanged: false,\n  isFetching: false,\n  lastUpdated: new Date(),\n  \n};\n\nDatasetControls.propTypes = {\n  uuid: PropTypes.string,\n  datasets: PropTypes.array,\n  dataset: PropTypes.array,\n  fetchDataset: PropTypes.func.isRequired,\n  uploadDataset: PropTypes.func.isRequired,\n  setDataset: PropTypes.func.isRequired,\n  removeDataset: PropTypes.func.isRequired,\n  removeSearchIndex: PropTypes.func.isRequired,\n  getIsFetching: PropTypes.func.isRequired,\n  setIsFetching: PropTypes.func.isRequired,\n  showNodes: PropTypes.func.isRequired,\n  setHierarchyConfig: PropTypes.func.isRequired, \n  colorBy: PropTypes.func.isRequired,\n  startRefresh: PropTypes.func.isRequired,\n  stopRefresh: PropTypes.func.isRequired,\n  isFetching: PropTypes.bool,\n  lastUpdated: PropTypes.instanceOf(Date),\n  setError: PropTypes.func.isRequired,\n  hierarchyConfig: PropTypes.array,\n  configHasChanged: PropTypes.bool,\n  fullDatasets: PropTypes.object,\n  controls: PropTypes.object,\n  keyFields: PropTypes.array,\n  ignoredFields: PropTypes.array\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  const owner = ownProps.uuid;\n  return {\n    dataset: selectDataset(state,owner),\n    isFetching: getIsFetching(state, owner),\n    lastUpdated: getLastUpdated(state, owner),\n    fullDatasets: selectDatasets(state),\n    controls: selectControls(state),\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  fetchDataset,\n  uploadDataset,\n  setDataset,\n  selectDataset,\n  removeDataset,\n  removeSearchIndex,\n  getIsFetching,\n  setIsFetching,\n  showNodes,\n  setHierarchyConfig, \n  colorBy,\n  startRefresh,\n  stopRefresh,\n  setError\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetControls);\n","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport classNames from 'classnames';\nimport Modal from 'react-modal';\n\nimport { isNil } from \"ramda\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { \n  faCheck, faDizzy, faPlus, faMinusCircle, faHome, faAngleDoubleDown, faAngleDoubleUp,\n  faFileExport, faFileImport, faTimes\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { \n  selectDatasets, getLastUpdated, removeDataset,getKeyFields, getIgnoredFields\n} from 'domain/dataset';\nimport { \n  setHierarchyConfig, showNodes, colorBy, selectControls, setStartDataset, setEndDataset\n} from 'domain/controls';\nimport { getError, clearError } from \"domain/error\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\n\nimport Header from 'features/header/Header';\nimport HierarchySelector from 'features/hierarchy-selector/HierarchySelector';\nimport ComparisonSelector from 'features/comparison-selector/ComparisonSelector';\nimport MiscControls from 'features/misc-controls/MiscControls';\nimport SearchControls from 'features/search/SearchControls';\nimport Visualization from 'features/visualization/Visualization';\nimport DatasetControls from 'features/dataset-controls/DatasetControls';\nimport DatasetUpload from \"features/dataset-controls/DatasetUpload\";\nimport { getDataToExport } from \"features/dataset-controls/export\"\n\nimport style from './App.module.css';\n\nimport datasets from './datasets';\n\nconst uuidv4 = require('uuid/v4');\n\nModal.setAppElement('#root');\nconst IMPORT = \"import\";\nconst EXPORT = \"export\";\nconst DATA = \"data\";\nconst CONTROLS = \"controls\";\nconst defaultOptions = {\n      action: \"\",\n      data: true,\n      controls: true\n    }\nclass App extends Component {\n\n  state = {\n    showData: true,\n    showGrouping: false,\n    showFiltering: false,\n    uuids: [uuidv4()],\n    datasetAdded: false,\n    startUuid: null,\n    endUuid: null,\n    showOptions: false,\n    options:{\n      action: \"\",\n      data: true,\n      controls: true\n    },\n    selectedFile: null,\n    exportName: \"dataset.json\"\n  }\n\n  componentWillReceiveProps = (nextProps) =>{\n    const uniqueUuids = this.state.datasetAdded || nextProps.uuids.length === 0\n                        ? Array.from(new Set(nextProps.uuids.concat(this.state.uuids)))\n                        : nextProps.uuids;\n    const startUuid = nextProps.startUuid || this.state.startUuid || uniqueUuids[0];\n    const endUuid = nextProps.endUuid || this.state.endUuid;\n    this.setState({\n      uuids: uniqueUuids,\n      startUuid: startUuid,\n      endUuid: endUuid,\n      datasetAdded: false\n    });\n  }\n\n  toggleShowData = () =>{\n    this.setState({\n      showData: !this.state.showData,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: false,\n    });\n  }\n\n  toggleShowComparison = () =>{\n    this.setState({\n      showData: false,\n      showComparison: !this.state.showComparison,\n      showGrouping: false,\n      showFiltering: false\n    });\n  }\n\n  toggleShowGrouping = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: !this.state.showGrouping,\n      showFiltering: false\n    });\n  }\n\n  toggleShowFiltering = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: !this.state.showFiltering\n    });\n  }\n\n  onErrorClose = () => {\n    this.props.clearError();\n  }\n\n  resetControls = () => {\n    this.props.colorBy(null);\n    this.props.setHierarchyConfig([]);\n    this.props.showNodes(true);\n  }\n\n  showImportOptions = () => {\n    this.showOptions(IMPORT);\n  }\n\n  showExportOptions = () => {\n    this.showOptions(EXPORT);\n  }\n\n  showOptions = (action) => {\n    this.setOptions(\"action\", action);\n    this.setState({showOptions: true})\n  }\n\n  processOptions = () => {\n    if(this.state.options.action === IMPORT)\n    {\n      this.props.uploadDataset({\n        'owner': uuidv4(),\n        'file': this.state.selectedFile,\n        'includeData': this.state.options.data,\n        'includeControls': this.state.options.controls,\n      });\n      this.setState({showOptions: false})\n    }\n  }\n\n  onUpload = (file) => {\n    this.setState({\n      selectedFile: file,\n    });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.state.options.data && this.props.fullDatasets;\n    const controls = this.state.options.controls && this.props.controls;\n    const keyFields = this.state.options.data && this.props.keyFields;\n    const ignoredFields = this.state.options.data && this.props.ignoredFields;\n    const exportData = getDataToExport(datasets, keyFields, ignoredFields, controls)\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(exportData);\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  exportNameChange = (name) => {\n    this.setState({\n      exportName: name,\n    });\n  }\n\n  cancelOptions = () => {\n    this.setState({\n      showOptions: false,\n      options: defaultOptions\n    })\n  }\n\n  setOptions = (key, value) => {\n    const options = this.state.options;\n    options[key] = value;\n    this.setState({options: options});\n  }\n\n  addDatasetEntry = () => {\n    const uuids = this.state.uuids;\n    const newItem = uuidv4()\n    uuids.push(newItem);\n    this.setState({uuids: uuids});\n    this.setState({datasetAdded: true});\n    if(this.state.endUuid === null && uuids.length > 1){\n      this.setEndUuid(newItem);\n    }\n  }\n\n  removeDatasetEntry = (uuid) =>{\n    const uuids = this.state.uuids;\n    if(uuids.includes(uuid)){\n      const newUuids = uuids.splice(uuids.indexOf(uuid), 1);\n      this.setState({uuids: newUuids})\n    }\n    this.props.removeSearchIndex({'owner': uuid});\n    this.props.removeDataset({'owner': uuid});\n  }\n\n  setStartUuid = (uuid) =>{\n    this.setState({startUuid: uuid});\n    this.props.setStartDataset(uuid);\n  }\n\n  setEndUuid = (uuid) =>{\n    this.setState({endUuid: uuid});\n    this.props.setEndDataset(uuid);\n  }\n\n  render() {\n    const { dataset, darkTheme, error, lastUpdated} = this.props;\n    const hasDataset = dataset && dataset.length > 0;\n\n    const uuids = this.state.uuids;\n    const startUuid = this.state.startUuid;\n    const endUuid = this.state.endUuid;\n    const showData = this.state.showData;\n    const showComparison = this.state.showComparison;\n    const showGrouping = this.state.showGrouping;\n    const showOptions = this.state.showOptions;\n    const options = this.state.options;\n\n    return (\n      <div className={\n          classNames({\n            [style.appContainer]: true,\n            'darkTheme': darkTheme\n          })\n      }>\n        <input name=\"hideControls\" id=\"hideControls\" type=\"checkbox\" />\n        <label htmlFor=\"hideControls\" className={ style.hideControls }>\n          { /* <FontAwesomeIcon icon={faChevron} /> */ }\n          <span>&lt;&lt;</span>\n        </label>\n        <div className={ style.controls }>\n          <Header />\n          <div className={ classNames({ [style.centerSpan]: true }) }>\n            <div className=\"button circular\" title=\"Reset Controls\" size=\"3x\" onClick={this.resetControls}>\n              <FontAwesomeIcon icon={faHome} />\n            </div>\n          </div>\n          <div className={style.accordionHeader} onClick={this.toggleShowData}>\n            Data  {!showData && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showData && <FontAwesomeIcon onClick={this.toggleShowData} icon={faAngleDoubleUp} />}\n          </div>\n          <div className={ classNames({ [style.section]: true, [style.hidden]: !showData })}>\n            {uuids.map((uuid, index) => {\n              return(\n                <div  key={ uuid } >\n                  <div className={style.dataControlHeader}>\n                    t{index}\n                    {index > 0 && <FontAwesomeIcon icon={faMinusCircle} onClick={ () => {this.removeDatasetEntry(uuid)}} />}\n                  </div>\n                  <DatasetControls uuid={ uuid } datasets={ datasets }/>\n                </div>\n              )\n            })}\n            <span className={ style.centerSpan }>\n              <div className=\"button circular\" title=\"Add Dataset\" onClick={this.addDatasetEntry}>\n                <FontAwesomeIcon icon={faPlus} />\n              </div>\n            </span>\n          </div>\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showData }) }>\n              <SearchControls />\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowComparison}>\n            Comparison  {!showComparison && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showComparison && <FontAwesomeIcon  onClick={this.toggleShowComparison} icon={faAngleDoubleUp} />}\n          </div>\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              <ComparisonSelector startUid={startUuid} endUid={endUuid} />\n              <div className={style.selectorContainer}>\n                <span className={style.label}>Start</span>\n                <div className={style.selector}>\n                  <label className=\"select\">\n                  <select\n                    onChange={(evt) => this.setStartUuid(evt.target.value)}\n                    value={isNil(startUuid) ? \"UNSET\" : startUuid}\n                  >\n                    <option value=\"UNSET\">&mdash;None&mdash;</option>\n                    {uuids.map((uuid, index) => {\n                      return (\n                        <option key={uuid} value={uuid}>\n                          t{index}\n                        </option>\n                      );\n                    })}\n                  </select>\n                  </label>\n                </div>\n              </div>\n              <div className={style.selectorContainer}>\n                <span className={style.label}>End</span>\n                <div className={style.selector}>\n                  <label className=\"select\">\n                  <select\n                    onChange={(evt) => this.setEndUuid(evt.target.value)}\n                    value={isNil(endUuid) ? \"UNSET\" : endUuid}\n                  >\n                    <option value=\"UNSET\">&mdash;None&mdash;</option>\n                    {uuids.map((uuid, index) => {\n                      return (\n                        <option key={uuid} value={uuid}>\n                          t{index}\n                        </option>\n                      );\n                    })}\n                  </select>\n                  </label>\n                </div>\n              </div>\n            </div>\n          }\n          { !hasDataset && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              Please select datasets to continue\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowGrouping}>\n            Grouping  {!showGrouping && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showGrouping && <FontAwesomeIcon  onClick={this.toggleShowGrouping} icon={faAngleDoubleUp} />}\n          </div>\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              <HierarchySelector />\n            </div>\n          }\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showGrouping }) }>\n              <MiscControls />\n            </div>\n          }\n          { !hasDataset && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              Please select a dataset to continue\n            </div>\n          }\n          <div className={style.footerContainer}>\n            <span className={ style.centerSpan }>\n                <div className=\"button circular\" title=\"Import Dataset\" onClick={this.showImportOptions}>\n                  <FontAwesomeIcon icon={faFileImport} />\n                </div>\n                <div className=\"button circular\" disabled={!hasDataset} title=\"Export Dataset\" onClick={this.showExportOptions}>\n                  <FontAwesomeIcon icon={faFileExport} />\n                </div>\n            </span>\n          </div>\n        </div>\n        { dataset.length===0 && lastUpdated !== null &&\n          <div  className={ style.emptyDataset }>\n            <span>\n              Current dataset is empty\n            </span>\n          </div>\n        }\n\n        <div className={ style.canvas }>\n          <Visualization startUid={startUuid} endUid={endUuid} />\n        </div>\n        <Modal isOpen={ error !== null } onRequestClose={this.onErrorClose} contentLabel=\"An Error has occurred\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span className={ style.justifySpan }>\n                   <div className={ style.icon } title=\"Error\">\n                        <FontAwesomeIcon icon={faDizzy} size=\"7x\" color=\"#cc0000\"/>\n                    </div>\n                    <div>\n                      { error ? error.message : \"\"}\n                    </div>\n                </span>\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onErrorClose}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n        </Modal>\n        <Modal isOpen={ showOptions } onRequestClose={this.cancelOptions} contentLabel=\"An Error has occurred\">\n          <div className={ style.modal }>\n            <div className={ style.modalMain }>\n              {options.action === IMPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Upload</span>\n                  <DatasetUpload\n                    ownerUuid={uuidv4()}\n                    className={style.fileUpload}\n                    selected={this.state.selectedFile ? this.state.selectedFile.name : null}\n                    onChange={this.onUpload}\n                  />\n                </div>\n                }\n                {options.action === EXPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Export As</span>\n                  <input\n                    type=\"text\"\n                    id=\"export-as\"\n                    value={this.state.exportName}\n                    onChange={(evt) => this.exportNameChange(evt.target.value)}\n                  />\n                </div>\n                }\n              <div className={style.container}>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"data-check\"\n                      checked={options.data}\n                      onChange={(evt) => this.setOptions(DATA, evt.target.checked)}\n                    />\n                    <label htmlFor=\"data-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Data</label>\n                </div>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"controls-check\"\n                      checked={options.controls}\n                      onChange={(evt) => this.setOptions(CONTROLS, evt.target.checked)}\n                    />\n                    <label htmlFor=\"controls-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Controls</label>\n                </div>\n              </div>\n              <div>\n                <span className={ style.centerSpan }>\n                  {options.action === IMPORT &&\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.processOptions}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  }\n                  {options.action === EXPORT &&\n                    <a className=\"button circular\" href={ this.getDownloadUrl() } download={ this.state.exportName }\n                      title=\"Download\" disabled={!hasDataset} onClick={this.cancelOptions} >\n                      <FontAwesomeIcon icon={faCheck} />\n                    </a>\n                  }\n                  <div className=\"button circular\" title=\"Cancel\" onClick={this.cancelOptions}>\n                      <FontAwesomeIcon icon={faTimes} />\n                  </div>\n                </span>\n              </div>\n            </div>\n          </div>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  const datasets = selectDatasets(state);\n  const uuids = Object.keys(datasets) || [uuidv4()];\n  const dataset = datasets[uuids[0]] && datasets[uuids[0]].dataset ? datasets[uuids[0]].dataset : [];\n  const controls = selectControls(state);\n  return {\n    dataset: dataset,\n    darkTheme: controls.darkTheme,\n    error: getError(state),\n    lastUpdated: getLastUpdated(state, uuids[0]),\n    uuids: uuids,\n    startUuid: controls.start,\n    endUuid: controls.end,\n    fullDatasets: datasets,\n    controls: controls,\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state)\n  }\n}\n\nconst mapDispatchToProps = {\n  clearError,\n  setHierarchyConfig, \n  showNodes, \n  colorBy, \n  removeDataset,\n  removeSearchIndex,\n  setStartDataset,\n  setEndDataset,\n  uploadDataset\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { createAction, handleActions } from \"redux-actions\";\nimport compileExpression from \"filtrex\";\n\nconst defaultState = {\n  filterString: \"\",\n  filter: null,\n  isValid: false\n};\n\n// ACTIONS\nconst setFilter = createAction(\"SET_FILTER\");\nconst clearFilter = createAction(\"CLEAR_FILTER\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setFilter]: (state, { payload }) => {\n\n\t  \tconst filterString = payload;\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n\t  \ttry\n\t  \t{\n\t  \t\tfilter = compileExpression(filterString);\n\t  \t\tisValid = true;\n\n\t  \t}\n\t  \tcatch(error)\n\t  \t{\n\t  \t\tfilter = null;\n\t  \t\tisValid = false;\n\n\t  \t}\n\t  \treturn { ...state, filterString, filter, isValid };\n\n    },\n    [clearFilter]: (state) => {\n     \tconst filterString = \"\";\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n      return { ...state, filterString, filter, isValid };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getFilter = (state) => state.filter.filter;\nconst filterIsValid = (state) => state.filter.isValid;\n\nexport default reducer;\n\nexport { setFilter, getFilter, clearFilter, filterIsValid};","import { combineReducers } from \"redux\";\nimport { searchReducer as search } from 'epics/index-dataset-epic'\nimport dataset from \"./dataset\";\nimport controls from \"./controls\";\nimport error from \"./error\";\nimport filter from \"./filter\";\n\nexport default combineReducers({\n  dataset,\n  search,\n  controls,\n  error,\n  filter\n});\n","import { createAction } from \"redux-actions\";\nimport { of, empty } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\nimport { getFilter } from \"domain/filter\"\nimport { setFilteredDataset } from \"domain/dataset\"\n\nconst filterDataset = createAction(\"FILTER_DATASET\");\n\nconst filterDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(filterDataset.toString()).pipe(\n      mergeMap(({ payload}) => {\n        const filter = getFilter(store.value);\n\n        if(filter === null)\n          return empty();\n\n        return of(payload).pipe(\n            tap(applyFilter(payload, filter))\n            ,map((payload) =>\n              setFilteredDataset({\n                owner: payload.owner,\n                filtered: payload.filtered\n              })\n            )\n            ,catchError((error) => {\n               const newErr = new Error(\"Error filtering dataset: \" + error.message);\n               return of(setError(newErr));\n            })\n          );\n      })\n    );\n};\n\nconst applyFilter = (data, filter) => {\n  data.filtered = null;\n  const dataset = data.dataset;\n\n  if(filter !== null){\n    data.filtered = dataset.filter((item) => filter(item));\n  }\n\n  return data;\n};\n\nexport default filterDatasetEpic;\n\nexport { filterDataset };","import { combineEpics } from 'redux-observable';\nimport fetchDatasetEpic from './fetch-dataset-epic';\nimport uploadDatasetEpic from './upload-dataset-epic';\nimport loadDatasetEpic from './load-dataset-epic';\nimport searchDatasetEpic from './search-dataset-epic';\nimport indexDatasetEpic from './index-dataset-epic';\nimport refreshDatasetEpic from './refresh-dataset-epic';\nimport filterDatasetEpic from './filter-dataset-epic';\nimport diffDatasetEpic from './diff-dataset-epic';\n\nconst rootEpic = combineEpics(\n  loadDatasetEpic,\n  fetchDatasetEpic,\n  uploadDatasetEpic,\n  searchDatasetEpic,\n  indexDatasetEpic,\n  refreshDatasetEpic,\n  filterDatasetEpic,\n  diffDatasetEpic\n);\n\nexport default rootEpic;\n","import { createStore, applyMiddleware, compose } from \"redux\";\n\nimport { createEpicMiddleware } from 'redux-observable';\nimport rootReducer from './domain/root-reducer';\nimport rootEpic from './epics/root-epic';\n\n// Replace redux compose with redux-devtools compose if it exists\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst configureStore = (initialState = {}) => {\n  const middleware = createEpicMiddleware()\n\n  const store = createStore(rootReducer,\n    initialState,\n    composeEnhancers(\n      applyMiddleware(middleware)\n    )\n  );\n\n  middleware.run(rootEpic);\n\n  return store;\n};\n\nexport default configureStore;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport \"index.css\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\n\nimport configureStore from \"./configure-store\";\n\nconst store = configureStore();\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\nregisterServiceWorker();\n\nif (module.hot) {\n  module.hot.accept(\"./App\", () => {\n    ReactDOM.render(\n      <Provider store={store}>\n        <App />\n      </Provider>,\n      document.getElementById(\"root\")\n    );\n  });\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"SelectedFieldList_listContainer__1Qvj-\",\"isDropDisabled\":\"SelectedFieldList_isDropDisabled__1wSe7\",\"droppable\":\"SelectedFieldList_droppable__3w9JP\",\"draggable\":\"SelectedFieldList_draggable__1pKrD\",\"field\":\"SelectedFieldList_field__30UAV\",\"groupBy\":\"SelectedFieldList_groupBy__3bxtK\",\"animated\":\"SelectedFieldList_animated__1gf5z\",\"groupByEnter\":\"SelectedFieldList_groupByEnter__2DArZ\",\"fieldName\":\"SelectedFieldList_fieldName__coZyW\",\"dropTarget\":\"SelectedFieldList_dropTarget__3MnM9\",\"isDraggingOver\":\"SelectedFieldList_isDraggingOver__26-4R\",\"dragHandle\":\"SelectedFieldList_dragHandle__eS4Kf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"AvailableFieldList_listContainer__lZgLB\",\"draggableContainer\":\"AvailableFieldList_draggableContainer__Oe2ZM\",\"dragForeignContainer\":\"AvailableFieldList_dragForeignContainer__ffQYG\",\"isDraggingOver\":\"AvailableFieldList_isDraggingOver__2ZI_i\",\"field\":\"AvailableFieldList_field__AjaO2\",\"dragForeign\":\"AvailableFieldList_dragForeign__1lWgq\",\"groupBy\":\"AvailableFieldList_groupBy__3Mn-q\",\"fieldName\":\"AvailableFieldList_fieldName__1p886\"};","import { createAction, handleActions } from \"redux-actions\";\nimport {\n  chain,\n  concat,\n  find,\n  fromPairs,\n  identity,\n  is,\n  map,\n  merge,\n  path,\n  pipe,\n  propEq,\n  sortBy,\n  toPairs,\n  uniq\n} from \"ramda\";\n\nconst defaultState = {\n  datasets: {},\n  diffs:[],\n  keyFields: [],\n  ignoredFields: []\n};\nconst defaultItemState = {\n  owner: \"\",\n  dataset: [],\n  filtered: null,\n  values: {},\n  configuration: {\n    fields: [],\n    keyFields: [],\n    hashFields: []\n  },\n  isFetching: false,\n  lastUpdated: null,\n};\n\nconst getHashFields = (allFields, ignoredFields) => {\n  if(!ignoredFields || ignoredFields.length === 0){\n    return allFields;\n  }\n\n  return allFields.filter(f => !ignoredFields.includes(f));\n}\n\nconst addHashKey = (keys, obj) => {\n  //console.log(\"addHashKey keys: %o\", keys);\n  const hashKey = keys.reduce( (h, k) => h + path(k.path, obj) + \":\", \"\");\n  obj.CRVIZ[\"_HASH_KEY\"] = hashKey;\n}\n\nconst addHashWithoutIgnored = (fields, obj) => {\n  const hash = fields.reduce( (h, f) => h + path(f.path, obj) + \"|\", \"\");\n  obj.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] = hash;\n}\n\nconst applyHashes = (dataset, configuration) => {\n  dataset.forEach((i) => {\n    if(!('CRVIZ' in i)){\n      i['CRVIZ'] = {};\n    }\n    addHashKey(configuration.keyFields.length > 0 ? configuration.keyFields : configuration.hashFields, i);\n    addHashWithoutIgnored(configuration.hashFields, i);\n  });\n};\n\n/**\n * Return a string that uniquely identify the field\n */\nconst getFieldId = (field) => {\n  if(field.path.length >= 1 && field.path[0])\n    return field.path.join(\".\")\n  else\n    return \" \";\n}\n\n/**\n * Returns an array of paths to literal values and arrays in a POJO.\n *\n * Example:\n * pathsIn({ a: 'A', b: { c: 'C', d: [1, 2] } }) //=> [['a'], ['b', 'c'], ['b', 'd']]\n */\nconst pathsIn = (obj) =>\n  chain(\n    ([key, value]) =>\n      is(Object, value) ? map(concat([key]), pathsIn(value)) : [[key]],\n    toPairs(obj)\n  );\n\n/**\n * Return all fields for an object\n */\nconst fieldsFor = (obj, overrides = []) => {\n  const paths = pathsIn(obj).filter(p => p[0] !== 'CRVIZ');\n  return map((path) => {\n    const override = find(propEq('path', path), overrides) || {};\n    return merge(\n      {\n        path: path,\n        displayName: path.join('.'),\n        groupable: true\n      },\n      override\n    )\n  }, paths);\n\n  // var fields = difference(pathsIn(obj), map(prop('path'), overrides));\n  // return [\n  //   ...overrid,\n  //   ...map(\n  //     (path) => ({\n  //       path: path,\n  //       displayName: path.join(\".\"),\n  //       groupable: true\n  //     }),\n  //     unspecified\n  //   )\n  // ];\n};\n\n/**\n * Returns a configuration with any missing items populated\n */\nconst configurationFor = (dataset, keyFields, ignoredFields, configuration = {}) => {\n  const fields = fieldsFor(dataset[0] || {}, configuration.fields);\n  const hashFields = getHashFields(fields, ignoredFields);\n  return {\n    ...configuration,\n    fields: fieldsFor(dataset[0] || {}, configuration.fields),\n    keyFields: keyFields,\n    hashFields: hashFields\n  };\n};\n\n\nconst valuesFor = (dataset, configuration) => {\n  return fromPairs(map((field) => {\n    const values = pipe(\n      map(path(field.path)),\n      uniq,\n      sortBy(identity)\n    )(dataset);\n\n    return [getFieldId(field), values];\n  }, configuration.fields));\n};\n\nconst configureDataset = (dataset, initialConfig, keyFields, ignoredFields) => {\n  const configuration = configurationFor(\n    dataset || [],\n    keyFields,\n    ignoredFields,\n    initialConfig || {}\n  );\n  applyHashes(dataset, configuration);\n\n  const values = valuesFor(dataset, configuration);\n  const isFetching = false;\n  const lastUpdated = new Date();\n  return {\n    dataset: dataset,\n    filtered: null,\n    values: values,\n    configuration: configuration,\n    isFetching: isFetching,\n    lastUpdated: lastUpdated\n  }\n}\n\n// ACTIONS\n\n/**\n * Payload: {\n *   dataset: [], // Array of devices\n *   configuration: {} // Configuration\n * }\n*/\nconst setDatasets = createAction(\"SET_DATASETS\");\nconst setDataset = createAction(\"SET_DATASET\");\nconst setFilteredDataset = createAction(\"SET_FILTERED_DATASET\");\nconst setDatasetDiff = createAction(\"SET_DATASET_DIFF\");\nconst removeDataset = createAction(\"REMOVE_DATASET\");\nconst removeFilteredDataset = createAction(\"REMOVE_FILTERED_DATASET\");\nconst removeDatasetDiff = createAction(\"REMOVE_DATASET_DIFF\");\nconst setIsFetching = createAction(\"SET_IS_FETCHING\");\nconst setKeyFields = createAction(\"SET_KEY_FIELDS\");\nconst setIgnoredFields = createAction(\"SET_IGNORED_FIELDS\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setDatasets]: (state, { payload }) => {\n      const datasets = payload.datasets;\n      const keyFields = payload.keyFields || getKeyFields(state);\n      const ignoredFields = payload.ignoredFields || getIgnoredFields(state);\n\n      Object.keys(datasets).forEach((owner) =>{\n        const dataset = datasets[owner].dataset;\n        const initialConfig = datasets[owner].configuration;\n        state.datasets[owner] = configureDataset(dataset, initialConfig, keyFields, ignoredFields);\n      })\n      \n      return { ...state};\n    },\n    [setDataset]: (state, { payload }) => {\n      const dataset = payload.dataset;\n      const owner = payload.owner;\n      const initialConfig = payload.configuration;\n      const keyFields = getKeyFields(state);\n      const ignoredFields = getIgnoredFields(state);\n      state.datasets[owner] = configureDataset(dataset, initialConfig, keyFields, ignoredFields);\n      return { ...state};\n    },\n    [setFilteredDataset]: (state, { payload }) => {\n      const filtered = payload.filtered;\n      const owner = payload.owner;\n\n      state.datasets[owner].filtered = filtered;\n      return { ...state};\n    },\n    [setDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const differences = payload.differences\n      const newDiff = {\n        'start': start,\n        'end': end,\n        'differences': differences\n      }\n\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx === -1){\n        state.diffs.push(newDiff);\n      } else {\n        state.diffs[idx] = newDiff;\n      }\n      return { ...state};\n    },\n    [removeDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        delete state.datasets[owner];\n\n      return { ...state }\n    },\n    [removeFilteredDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].filtered = null;\n\n      return { ...state }\n    },\n    [removeDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx !== -1){\n        state.diffs.splice(idx, 1);\n      }\n\n      return { ...state }\n    },\n    [setIsFetching]: (state, { payload }) => {\n      const owner = payload.owner;\n      const isFetching = !!payload.isFetching;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].isFetching = isFetching;\n      return { ...state, isFetching};\n    },\n    [setKeyFields]: (state, { payload }) => { \n      const keyFields = payload;\n      const datasets = _selectDatasets(state);\n\n      if(datasets){\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];\n          ds.configuration.keyFields = keyFields;\n          applyHashes(ds.dataset, ds.configuration);\n        });\n      }\n\n      return {...state, keyFields: keyFields };\n    },\n    [setIgnoredFields]: (state, { payload }) => {\n      const ignoredFields = payload;\n      const datasets = _selectDatasets(state);\n\n      if(datasets){\n        const allFields = _selectMergedConfiguration(state).fields;\n        const hashFields = getHashFields(allFields, ignoredFields);\n\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];    \n          ds.configuration.hashFields = hashFields\n          applyHashes(ds.dataset, ds.configuration);\n        });\n      }\n\n      return { ...state, ignoredFields: ignoredFields };\n    }\n  },\n  defaultState\n);\n\n//methods where we need to deal with state both inside and outside of the reducer\n//outside of the reducer state represents the entire state tree, but inside of the\n//reducer the provided state is only the state for the reducer's subset of the \n//state tree.  to avoid duplication of code these methods will be called be used\n//internally from the reducer.  and methods that recieve the full state tree will \n//pare the tree down to just the relevant attributes. in these cases the\n//variable \"dataset\" will represent the segment of the state tree owned by the datset reducer.\nconst _selectDatasets = (dataset) => {\n  return dataset.datasets || {};\n}\nconst _selectMergedConfiguration = (dataset) => {\n  let fields = [];\n  const ds = dataset.datasets;\n  for (var key in ds){\n    for (var f of ds[key].configuration.fields){ \n      // eslint-disable-next-line no-loop-func\n      if(!fields.some(field => field.displayName === f.displayName)){\n        fields.push(f);\n      }\n    }\n  }\n\n  return { fields: fields };\n}\n\n// SELECTORS\nconst selectDatasets = (state) => {\n  return _selectDatasets(state.dataset);\n}\nconst selectDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].dataset ? state.dataset.datasets[owner].dataset : defaultItemState.dataset;\nconst selectFilteredDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].filtered ? state.dataset.datasets[owner].filtered : defaultItemState.filtered;\nconst selectDatasetDiff = (state, start, end) => {\n  let diff = null;\n  const idx = state.dataset.diffs.findIndex(d => d.start === start && d.end === end);\n  if(idx !== -1){\n    diff = state.dataset.diffs[idx].differences;;\n  }\n  return diff;\n}\nconst selectConfiguration = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].configuration ? state.dataset.datasets[owner].configuration : defaultItemState.configuration;\nconst selectMergedConfiguration = (state) => {\n  return _selectMergedConfiguration(state.dataset)\n}\nconst selectValues = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].values ? state.dataset.datasets[owner].values : defaultItemState.values;\nconst selectMergedValues = (state) => {\n  let vals = {};\n  const ds = state.dataset.datasets;\n  for (var key in ds){\n    for (var v in ds[key].values){\n      if(vals.hasOwnProperty(v)){\n        const valSet = new Set([...vals[v], ...ds[key].values[v]]);\n        vals[v] = [...valSet];\n      }\n      else {\n        vals[v] = ds[key].values[v];\n      }\n    }\n  }\n\n  return vals;\n}\nconst getIsFetching = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].isFetching ? state.dataset.datasets[owner].isFetching : defaultItemState.isFetching;\nconst getLastUpdated = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].lastUpdated ? state.dataset.datasets[owner].lastUpdated : defaultItemState.lastUpdated;\nconst getKeyFields = (state) => state.dataset && state.dataset.keyFields ? state.dataset.keyFields : [];\nconst getIgnoredFields = (state) => state.dataset && state.dataset.ignoredFields ? state.dataset.ignoredFields : [];\nconst selectDatasetIntersection = (state, startOwner, endOwner) => {\n  let ds = [];\n  const start = selectDataset(state, startOwner);\n  start.forEach((s)=>{\n    s.CRVIZ._isRemoved = false;\n    s.CRVIZ._isChanged = false;\n    s.CRVIZ._isAdded = false;\n  });\n  const end = selectDataset(state, endOwner);\n  end.forEach((e)=>{\n    e.CRVIZ._isRemoved = false;\n    e.CRVIZ._isChanged = false;\n    e.CRVIZ._isAdded = false;\n  });\n  \n  if(start.length > 0 && end.length === 0){\n    ds = start;\n  } else if(start.length === 0 && end.length > 0){\n    ds = end;\n  } else if(start.length > 0 && end.length > 0) {\n    start.forEach((s) => {\n      const idx = end.findIndex(e => e.CRVIZ._HASH_KEY === s.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        s.CRVIZ._isRemoved = true;\n      } else {\n        s.CRVIZ._isRemoved = false;\n      }\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n      ds.push(s);\n    });\n    end.forEach((e) => {\n      const idx = ds.findIndex(i => i.CRVIZ._HASH_KEY === e.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        e.CRVIZ._isAdded = true;\n        ds.push(e);\n      } else if(ds[idx].CRVIZ._HASH_WITHOUT_IGNORED !== e.CRVIZ._HASH_WITHOUT_IGNORED){\n        ds[idx].CRVIZ._isChanged = true;\n      }\n    })\n  }\n  return ds;\n}\n\n\nexport default reducer;\n\nexport { setDatasets, setDataset, selectDataset, selectDatasets, removeDataset, setFilteredDataset, selectFilteredDataset, removeFilteredDataset, selectConfiguration, selectMergedConfiguration,\n  selectValues, selectMergedValues, getFieldId, configurationFor, setIsFetching, getIsFetching, setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields, getHashFields, getLastUpdated, \n  valuesFor, setDatasetDiff, removeDatasetDiff, selectDatasetDiff, selectDatasetIntersection, applyHashes };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dataControls\":\"DatasetControls_dataControls__2WPxV\",\"selectorContainer\":\"DatasetControls_selectorContainer__3zdeO\",\"uploadContainer\":\"DatasetControls_uploadContainer__izwKQ\",\"selector\":\"DatasetControls_selector__1-ZPD\",\"fileUpload\":\"DatasetControls_fileUpload__1vorY\",\"label\":\"DatasetControls_label__3bRl3\",\"utilityContainer\":\"DatasetControls_utilityContainer__3RsyZ\",\"fileDownload\":\"DatasetControls_fileDownload__3N8pM\",\"urlRefreshContainer\":\"DatasetControls_urlRefreshContainer__2BOh7\",\"urlRefresh\":\"DatasetControls_urlRefresh__hpLj8\",\"urlContainer\":\"DatasetControls_urlContainer__2iQFV\",\"urlRefreshTime\":\"DatasetControls_urlRefreshTime__3heCp\",\"modal\":\"DatasetControls_modal__2nY-_\",\"modalMain\":\"DatasetControls_modalMain__3s5YH\",\"centerSpan\":\"DatasetControls_centerSpan__2HEg3\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"appContainer\":\"App_appContainer__QtPXV\",\"controls\":\"App_controls__2wA6i\",\"section\":\"App_section__s3xOK\",\"footerContainer\":\"App_footerContainer__2RDOr\",\"dimSection\":\"App_dimSection__1zfwr\",\"hierarchySection\":\"App_hierarchySection__2fUkf\",\"canvas\":\"App_canvas__1fY9M\",\"hideControls\":\"App_hideControls__2GMem\",\"modal\":\"App_modal__z_4zM\",\"modalMain\":\"App_modalMain__3oa8j\",\"justifySpan\":\"App_justifySpan__3GGJs\",\"icon\":\"App_icon__3qmGE\",\"centerSpan\":\"App_centerSpan__37_5U\",\"accordionHeader\":\"App_accordionHeader__3V3d_\",\"dataControlHeader\":\"App_dataControlHeader__3H7yU\",\"hidden\":\"App_hidden__1emPK\",\"emptyDataset\":\"App_emptyDataset__3STIn\",\"label\":\"App_label__3YLJx\",\"selectorContainer\":\"App_selectorContainer__HjwSW\",\"selector\":\"App_selector__1F3OW\",\"checkboxContainer\":\"App_checkboxContainer__1mdST\",\"switch\":\"App_switch__3COkM\",\"switchLabel\":\"App_switchLabel__3AJYF\",\"switch-inner\":\"App_switch-inner__17Dcc\",\"uploadContainer\":\"App_uploadContainer__nB6vF\",\"fileUpload\":\"App_fileUpload__1bzQK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkboxContainer\":\"MiscControls_checkboxContainer__3qEun\",\"colorBy\":\"MiscControls_colorBy__36jis\",\"fieldSelect\":\"MiscControls_fieldSelect__23xNi\",\"switch\":\"MiscControls_switch__3u3nl\",\"switchLabel\":\"MiscControls_switchLabel__aj7RI\",\"switch-inner\":\"MiscControls_switch-inner__1-N2V\",\"selectorContainer\":\"MiscControls_selectorContainer__ktFZV\",\"selector\":\"MiscControls_selector__18lbV\"};"],"sourceRoot":""}