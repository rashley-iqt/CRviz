{"version":3,"sources":["features/drag-drop-utils/AvailableFieldList.module.css","App.module.css","features/dataset-controls/DatasetControls.module.css","epics/fetch-dataset-epic.js","epics/load-dataset-epic.js","features/header/Header.module.css","features/search/SearchControls.module.css","domain/controls.js","features/visualization/Visualization.module.css","features/header/crlogo.png","epics/upload-dataset-epic.js","features/header/Header.js","features/drag-drop-utils/SelectedField.js","features/drag-drop-utils/SelectedFieldList.js","features/drag-drop-utils/AvailableField.js","features/drag-drop-utils/AvailableFieldList.js","features/drag-drop-utils/DropTarget.js","features/hierarchy-selector/HierarchySelector.js","epics/diff-dataset-epic.js","features/comparison-selector/ComparisonSelector.js","features/misc-controls/FieldSelect.js","features/misc-controls/MiscControls.js","epics/search-dataset-epic.js","features/search/SearchControls.js","features/visualization/d3-viz/pack-grid.js","features/visualization/d3-viz/pack-with-label.js","features/visualization/d3-viz/to-hierarchy.js","features/visualization/d3-viz/datum-key.js","features/visualization/d3-viz/class-name.js","features/visualization/d3-viz/append-circles.js","features/visualization/d3-viz/setup-zoom.js","features/visualization/d3-viz/setup-tooltip.js","features/visualization/d3-viz/color-scheme.js","features/visualization/d3-viz/setup-legend.js","features/visualization/d3-viz/setup-annotations.js","features/visualization/d3-viz.js","features/visualization/Visualization.js","epics/refresh-dataset-epic.js","features/dataset-controls/DatasetSelector.js","features/dataset-controls/DatasetUpload.js","features/dataset-controls/DatasetDownload.js","features/dataset-controls/DatasetRefresh.js","features/dataset-controls/DatasetTimedRefresh.js","features/dataset-controls/export.js","features/dataset-controls/DatasetControls.js","features/dataset-controls/DatasetSlider.js","App.js","registerServiceWorker.js","domain/filter.js","domain/root-reducer.js","epics/filter-dataset-epic.js","epics/root-epic.js","configure-store.js","index.js","domain/error.js","epics/index-dataset-epic.js","domain/dataset.js","features/misc-controls/MiscControls.module.css","features/drag-drop-utils/SelectedFieldList.module.css"],"names":["module","exports","listContainer","draggableContainer","dragForeignContainer","isDraggingOver","field","dragForeign","groupBy","fieldName","appContainer","controls","section","footerContainer","dimSection","hierarchySection","canvas","sliderContainer","hideControls","modal","modalMain","justifySpan","icon","centerSpan","accordionHeader","dataControlHeader","hidden","emptyDataset","label","selectorContainer","selector","checkboxContainer","switch","switchLabel","switch-inner","uploadContainer","fileUpload","dataControls","utilityContainer","fileDownload","urlRefreshContainer","urlRefresh","urlContainer","urlRefreshTime","sliderSelectedScale","slider","sliderScale","sliderThumb","sliderThumbMin","sliderThumbMax","slot","scaleMark","slotScale","line","lineSelected","Buffer","__webpack_require__","d","__webpack_exports__","fetchDataset","buildAuthHeader","redux_actions__WEBPACK_IMPORTED_MODULE_0__","redux_observable__WEBPACK_IMPORTED_MODULE_1__","rxjs__WEBPACK_IMPORTED_MODULE_2__","rxjs_ajax__WEBPACK_IMPORTED_MODULE_3__","rxjs_operators__WEBPACK_IMPORTED_MODULE_4__","rxjs_operators__WEBPACK_IMPORTED_MODULE_5__","rxjs_operators__WEBPACK_IMPORTED_MODULE_6__","rxjs_operators__WEBPACK_IMPORTED_MODULE_7__","domain_error__WEBPACK_IMPORTED_MODULE_8__","_load_dataset_epic__WEBPACK_IMPORTED_MODULE_9__","createAction","username","password","token","header","scheme","getScheme","Authorization","concat","toString","fetchDatasetEpic","action$","store","ajax","arguments","length","undefined","rxAjax","pipe","ofType","debounceTime","mergeMap","action","owner","payload","url","headers","crossDomain","responseType","map","result","content","response","loadDataset","catchError","error","newErr","Error","message","of","setError","CSVconvert","rxjs_operators__WEBPACK_IMPORTED_MODULE_3__","ramda__WEBPACK_IMPORTED_MODULE_6__","ramda__WEBPACK_IMPORTED_MODULE_7__","_index_dataset_epic__WEBPACK_IMPORTED_MODULE_8__","domain_error__WEBPACK_IMPORTED_MODULE_9__","domain_dataset__WEBPACK_IMPORTED_MODULE_10__","domain_controls__WEBPACK_IMPORTED_MODULE_11__","data","lines","file","trim","split","delimiter","hdr","delims","delim","max","i","finddelim","jsonstring","colnames","entry","j","formatPayload","datasets","keyFields","ignoredFields","includeData","includeControls","final","isNil","dataset","is","Array","configuration","ValidationError","obj","Object","entries","forEach","key","value","keys","initialConfig","configureDataset","this","name","prototype","create","loadDatasetEpic","_ref","setDatasets","setKeyFields","setIgnoredFields","setControls","buildIndices","logo","appName","infoIcon","infoPopup","tagline","searchControls","searchContainer","search","defaultState","hierarchyConfig","shouldShowNodes","darkTheme","colorBy","start","end","setStartDataset","setEndDataset","setHierarchyConfig","showNodes","useDarkTheme","reducer","handleActions","_handleActions","_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","state","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_ref2","_ref3","_ref4","_ref5","_ref6","_ref7","selectControls","viz","delta","plus","minus","bg-circle","uploadDataset","fromReader","Observable","observer","reader","window","FileReader","addEventListener","next","complete","readAsText","fromJson","JSON","parse","uploadDatasetEpic","SyntaxError","Header","showInfo","hideTooltip","_this","setState","showTooltip","react_default","a","createElement","className","style","href","target","rel","src","alt","id","onMouseEnter","onMouseLeave","index_es","faInfoCircle","react_portal_tooltip_lib_default","active","position","parent","tooltipTimeout","process","React","Component","Field","_classNames","initialItemText","subsequentItemText","displayName","dragIndex","animated","provided","assign","draggable","ref","innerRef","draggableProps","dragHandleProps","classNames","defineProperty","placeholder","SelectedField","_ref$count","count","index","draggableId","react_beautiful_dnd_esm","type","snapshot","SelectedFieldList","lastFields","toAnimate","props","fields","_this2","_this$props","values","getFieldId","droppableId","dragState","draggingOver","droppableProps","droppable","List","destination","differenceWith","eqBy","findIndex","isEmpty","drag_drop_utils_SelectedField","path","source","from","to","Math","min","defaultProps","AvailableField","objectSpread","transform","isDragging","AvailableFieldList","isDraggingForeign","sortBy","getCount","drag_drop_utils_AvailableField","withPlaceholder","faTrashAlt","curry","contains","DropTarget","isDropDisabled","_classNames2","dropTarget","SELECTED_FIELD_LIST_ID","DROP_TARGET_ID","HierarchySelector","onDragStart","dragStart","onDragUpdate","dragUpdate","onDragEnd","dropResult","updateHierarchy","removeField","fieldId","newIndex","findFieldIndex","find","removeOld","identity","remove","addNew","insert","updatedHierarchy","compose","availableFields","filter","f","groupable","marginBottom","drag_drop_utils_SelectedFieldList","selectedFieldListStyle","drag_drop_utils_DropTarget","drag_drop_utils_AvailableFieldList","availableFieldListStyle","list","matchId","equals","mapDispatchToProps","connect","selectMergedConfiguration","selectMergedValues","generateDiff","startOwner","startDs","endOwner","endDs","diffs","added","changed","removed","ei","si","CRVIZ","differences","diffDatasetEpic","switchMap","setDatasetDiff","KEY_FIELD_LIST_ID","IGNORED_FIELD_LIST_ID","KEY_TARGET_ID","IGNORED_TARGET_ID","ComparisonSelector","updateKeyFields","updateIgnoreFields","getUpdatedFields","fieldsToUpdate","updatedKeys","updateDiff","updatedIgnored","keyIndex","ignoredIndex","toDiff","startUuid","endUuid","ignore","diffDataset","usedFields","ownProps","selectDataset","getKeyFields","getIgnoredFields","fieldToString","join","prop","stringToField","string","propEq","FieldSelect","onChange","evt","dispatch","container","checked","htmlFor","fieldSelect","misc_controls_FieldSelect","searchDataset","performSearch","results","toFind","queryString","indices","searchIndices","hash","idxResults","toLowerCase","temp","Set","toConsumableArray","el","_isSearchResult","r","res","push","searchDatasetEpic","tap","setSearchResults","QueryParseError","hasSearch","Search","handleQueryStringChange","e","handleKeyPress","handleSearch","onKeyPress","onClick","title","faSearch","clearSearch","faTimesCircle","selectConfiguration","getSearchIndices","getSearchResults","eachWithIndex","addIndex","placeRows","rows","middleOut","maxRadii","maxRadius","ys","coordinatesForRadii","xs","row","node","x","y","apply","c","radii","diameters","first","reduce","add","coords","slicedToArray","lastRadius","currentRadius","last","aperture","above","reject","_","below","pickOdd","reverse","toRows","circles","splitEvery","ceil","sqrt","packGrid","enclosingCircle","packEnclose","radiusLeaf","radius","children","packChildren","packSiblings","padding","k","paddingSize","child","enclosingRadius","translateChild","labelSize","labelY","labelWidth","pow","packWithLabel","options","size","pack","root","eachBefore","eachAfter","nestHierarchy","nest","countSearchResults","_searchResultCount","countAdded","_addedCount","_isAdded","countChanged","_changedCount","_isChanged","countRemoved","_removedCount","_isRemoved","entriesToHierarchy","fieldValue","chain","getLeaves","head","tail","toHierarchy","nesting","d3Hierarchy","datumKey","datum","depth","height","uid","appendCircles","nodeRoot","packedData","labelRoot","descendants","nodes","selectAll","exit","nodesEnter","enter","append","classed","merge","attr","order","select","hideSmall","tooSmall","viewBound","width","boundWidth","boundHeight","nodeBound","boundOverlap","bound0","bound1","setupZoom","zoomRoot","transformRoot","zoomTo","zoomToTransform","zoomTransform","zoomBehavior","zoom","on","event","d3Event","call","viewPadding","rootR","rootX","rootY","scaleExtent","leaves","translateExtent","floor","bound","animate","zoomIdentity","scale","translate","transition","duration","offsetTop","offsetLeft","tooltip","text","innerHTML","cont","pairs","setupTooltip","boundingRect","getBoundingClientRect","left","top","colorScheme","extendColorScheme","extraLayers","extraColors","times","currentLayer","previous","hcl","neighbor","hScale","scaleLinear","domain","range","h","cScale","scalePow","exponent","lScale","l","updateLegend","legend","colorMap","toggleValue","items","toPairs","itemsEnter","disabled","_ref8","color","_ref9","_ref11","createStylesheet","coloring","styleEnter","html","_ref13","_ref14","_ref14$","colorNodes","_ref15","getValue","coloredField","isColoringGroup","_ref16","_ref18","colorAnnotations","_ref19","annotations","_ref20","console","log","setupLegend","legendConfig","update","either","uniq","configs","zip","fromPairs","setupAnnotations","annotationRoot","leafRadius","fontScale","annotationsEnter","baseAngle","PI","newChangeIcon","cos","sin","annotation","newRingMenu","newBgCircles","newX","newTotalContainer","newCircles","newTotalText","isNaN","newAddedContainer","newPluses","newAddedText","newChangedContainer","newDeltas","newChangedText","newRemovedContainer","newMinuses","newRemovedText","allEqProps","o1","o2","allPass","eqProps","makeHierarchy","sort","composeComparators","b","localeCompare","comparators","reduceWhile","comparator","findAncestor","hierarchy","ancestors","findChild","reduced","d3Viz","rootNode","svg","clientWidth","clientHeight","labels","countLabels","selectedNode","nextProps","dataUpdated","sizeUpdated","legendUpdated","repack","resetAnnotations","rerender","resetLegend","resetZoom","ResizeSensor","debounce","_appendCircles","selected","zoomToNode","Visualization","ReactDOM","findDOMNode","updateFromProps","styles","PureComponent","selectDatasetIntersection","startUid","endUid","getQueryString","startRefresh","stopRefresh","refreshDatasetEpic","interval","timer","setIsFetching","isFetching","takeUntil","eqUrl","DatasetSelector","DatasetUpload","inputId","ownerUuid","display","files","faUpload","DatasetDownload","download","faDownload","DatasetRefresh","faRedoAlt","DatasetTimedRefresh","timerIsRunning","onIntervalChange","onStartClick","onStopClick","faSyncAlt","faStopCircle","getDataToExport","exportData","sanitizeForExport","clonedeep","item","uuidv4","require","CUSTOM_DATASET","authTypes","host","location","hostname","port","indexOf","String","parseInt","POSEIDON_DATASET","Modal","setAppElement","DatasetControls","classCallCheck","possibleConstructorReturn","getPrototypeOf","resetDataset","setDataset","selectedFile","fetchAndSetDataset","uuid","authHeader","toURL","onSelected","removeDataset","removeSearchIndex","showUrlEntry","authScheme","refreshInterval","refreshTimerRunning","onUpload","onUrlChange","onTokenChange","onUsernameChange","onPasswordChange","onUrlOk","onUrlCancel","getDownloadUrl","fullDatasets","urlObject","URL","webkitURL","json","stringify","blob","Blob","createObjectURL","onRefresh","onTimedRefreshStart","onTimedRefreshStop","onTimedRefreshIntervalChanged","numInt","canDownload","canRefresh","dataset_controls_DatasetSelector","dataset_controls_DatasetUpload","dataset_controls_DatasetDownload","dataset_controls_DatasetRefresh","dataset_controls_DatasetTimedRefresh","faCog","lastUpdated","toLocaleDateString","toLocaleTimeString","lib_default","isOpen","onRequestClose","contentLabel","at","Token","userName","faCheck","faTimes","TypeError","configHasChanged","Date","DragDropTouch","getIsFetching","getLastUpdated","selectDatasets","DatasetSlider","labelMode","onDragEnter","preventDefault","onDragOver","sliderType","onDrag","onDrop","Number","MinSlider","data-slider","onTouchStart","MaxSlider","points","currentScale","minThumb","maxThumb","_loop","_classNames3","currentLabel","lineIsSelected","data-slot","onTouchMove","onTouchEnd","DragDropTouch_1","DataTransfer","_dropEffect","_effectAllowed","_data","get","set","enumerable","configurable","clearData","getData","setData","setDragImage","img","offsetX","offsetY","ddt","_instance","_imgCustom","_imgOffset","_lastClick","supportsPassive","document","passive","ts","_touchstart","bind","tm","_touchmove","te","_touchend","opt","capture","getInstance","_shouldHandle","now","_DBLCLICK","_dispatchEvent","_reset","_closestDraggable","_dragSource","_ptDown","_getPoint","_lastTouch","setTimeout","_img","_CTXMENU","_getTarget","_getDelta","_THRESHOLD","_createImage","_lastTarget","_moveImage","_destroyImage","defaultPrevented","touches","_dataTransfer","page","pageX","clientX","pageY","clientY","p","abs","pt","elementFromPoint","getComputedStyle","pointerEvents","parentElement","cloneNode","_copyStyle","rc","opacity","_OPACITY","body","appendChild","removeChild","requestAnimationFrame","s","zIndex","round","_copyProps","dst","_rmvAtts","att","removeAttribute","HTMLCanvasElement","cSrc","cDst","getContext","drawImage","cs","createEvent","t","initEvent","button","which","buttons","_kbdProps","_ptProps","dataTransfer","dispatchEvent","hasAttribute","IMPORT","EXPORT","defaultOptions","App","showData","showGrouping","showFiltering","uuids","datasetAdded","showOptions","exportName","componentWillReceiveProps","uniqueUuids","toggleShowData","showComparison","toggleShowComparison","toggleShowGrouping","toggleShowFiltering","onErrorClose","clearError","resetControls","showImportOptions","showExportOptions","setOptions","processOptions","exportNameChange","cancelOptions","addDatasetEntry","newItem","removeDatasetEntry","includes","newUuids","splice","setStartUuid","setEndUuid","_classNames4","_classNames5","_classNames6","_classNames7","_classNames8","_classNames9","hasDataset","header_Header","faHome","faAngleDoubleDown","faAngleDoubleUp","faMinusCircle","dataset_controls_DatasetControls","faPlus","SearchControls","comparison_selector_ComparisonSelector","hierarchy_selector_HierarchySelector","misc_controls_MiscControls","faFileImport","faFileExport","visualization_Visualization","dataset_controls_DatasetSlider","faDizzy","getError","isLocalhost","Boolean","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","catch","setFilter","clearFilter","filterString","isValid","compileExpression","combineReducers","filterDataset","applyFilter","filtered","filterDatasetEpic","empty","setFilteredDataset","rootEpic","combineEpics","indexDatasetEpic","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","initialState","middleware","createEpicMiddleware","createStore","rootReducer","applyMiddleware","run","configureStore","render","es","src_App","getElementById","origin","fetch","status","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","lunr","searchResults","searchReducer","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","rsowner","hasOwnProperty","generateIndex","configurationFor","flat","ds","cfg","flattened","CRVIZ_HASH_KEY","flattenDataset","idx","buildIndicesSuccess","defaultItemState","hashFields","getHashFields","allFields","applyHashes","hashKey","addHashKey","addHashWithoutIgnored","fieldsFor","overrides","paths","pathsIn","_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_3__","override","_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__","valuesFor","removeFilteredDataset","removeDatasetDiff","_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_1__","newDiff","_ref10","_selectDatasets","_ref12","_selectMergedConfiguration","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","done","some","err","return","vals","v","valSet","_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","_HASH_KEY","_HASH_WITHOUT_IGNORED","groupByEnter","dragHandle"],"mappings":"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","file":"static/js/main.a7278ca9.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"AvailableFieldList_listContainer__lZgLB\",\"draggableContainer\":\"AvailableFieldList_draggableContainer__Oe2ZM\",\"dragForeignContainer\":\"AvailableFieldList_dragForeignContainer__ffQYG\",\"isDraggingOver\":\"AvailableFieldList_isDraggingOver__2ZI_i\",\"field\":\"AvailableFieldList_field__AjaO2\",\"dragForeign\":\"AvailableFieldList_dragForeign__1lWgq\",\"groupBy\":\"AvailableFieldList_groupBy__3Mn-q\",\"fieldName\":\"AvailableFieldList_fieldName__1p886\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"appContainer\":\"App_appContainer__QtPXV\",\"controls\":\"App_controls__2wA6i\",\"section\":\"App_section__s3xOK\",\"footerContainer\":\"App_footerContainer__2RDOr\",\"dimSection\":\"App_dimSection__1zfwr\",\"hierarchySection\":\"App_hierarchySection__2fUkf\",\"canvas\":\"App_canvas__1fY9M\",\"sliderContainer\":\"App_sliderContainer__3mGyf\",\"hideControls\":\"App_hideControls__2GMem\",\"modal\":\"App_modal__z_4zM\",\"modalMain\":\"App_modalMain__3oa8j\",\"justifySpan\":\"App_justifySpan__3GGJs\",\"icon\":\"App_icon__3qmGE\",\"centerSpan\":\"App_centerSpan__37_5U\",\"accordionHeader\":\"App_accordionHeader__3V3d_\",\"dataControlHeader\":\"App_dataControlHeader__3H7yU\",\"hidden\":\"App_hidden__1emPK\",\"emptyDataset\":\"App_emptyDataset__3STIn\",\"label\":\"App_label__3YLJx\",\"selectorContainer\":\"App_selectorContainer__HjwSW\",\"selector\":\"App_selector__1F3OW\",\"checkboxContainer\":\"App_checkboxContainer__1mdST\",\"switch\":\"App_switch__3COkM\",\"switchLabel\":\"App_switchLabel__3AJYF\",\"switch-inner\":\"App_switch-inner__17Dcc\",\"uploadContainer\":\"App_uploadContainer__nB6vF\",\"fileUpload\":\"App_fileUpload__1bzQK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"dataControls\":\"DatasetControls_dataControls__2WPxV\",\"selectorContainer\":\"DatasetControls_selectorContainer__3zdeO\",\"uploadContainer\":\"DatasetControls_uploadContainer__izwKQ\",\"selector\":\"DatasetControls_selector__1-ZPD\",\"fileUpload\":\"DatasetControls_fileUpload__1vorY\",\"label\":\"DatasetControls_label__3bRl3\",\"utilityContainer\":\"DatasetControls_utilityContainer__3RsyZ\",\"fileDownload\":\"DatasetControls_fileDownload__3N8pM\",\"urlRefreshContainer\":\"DatasetControls_urlRefreshContainer__2BOh7\",\"urlRefresh\":\"DatasetControls_urlRefresh__hpLj8\",\"urlContainer\":\"DatasetControls_urlContainer__2iQFV\",\"urlRefreshTime\":\"DatasetControls_urlRefreshTime__3heCp\",\"modal\":\"DatasetControls_modal__2nY-_\",\"modalMain\":\"DatasetControls_modalMain__3s5YH\",\"centerSpan\":\"DatasetControls_centerSpan__2HEg3\",\"sliderContainer\":\"DatasetControls_sliderContainer__1fkIz\",\"sliderSelectedScale\":\"DatasetControls_sliderSelectedScale__36y37\",\"slider\":\"DatasetControls_slider__1wUuT\",\"sliderScale\":\"DatasetControls_sliderScale__1axI9\",\"sliderThumb\":\"DatasetControls_sliderThumb__2F5_W\",\"sliderThumbMin\":\"DatasetControls_sliderThumbMin__3Oexy\",\"sliderThumbMax\":\"DatasetControls_sliderThumbMax__qnrYc\",\"slot\":\"DatasetControls_slot__-a2uw\",\"scaleMark\":\"DatasetControls_scaleMark__2iiPp\",\"slotScale\":\"DatasetControls_slotScale__-bU_2\",\"line\":\"DatasetControls_line__26LiF\",\"lineSelected\":\"DatasetControls_lineSelected__WnP1L\"};","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport { of } from 'rxjs';\nimport { ajax  as rxAjax } from 'rxjs/ajax';\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\";\nimport { loadDataset } from './load-dataset-epic';\n\n// ACTIONS\nconst fetchDataset = createAction('FETCH_DATASET');\n\n// EPIC\nconst fetchDatasetEpic = (action$, store, ajax = rxAjax) => {\n  return action$.pipe(\n    ofType(fetchDataset.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner;\n      const url = action.payload.url;\n      const header = action.payload.header;\n      return ajax({ 'url': url, 'headers':header, 'crossDomain': true, 'responseType': 'json' }).pipe(\n        map((result) => { \n          return { 'owner': owner, 'content': result.response };\n        })\n        ,map(loadDataset)\n        // I believe this was done oddly and debounce should have been used\n        // to ensure that file input was only processed once, instead of using take until\n        // which seems to be stopping the epic the second time the action passes through the stream\n        // it seems like this change doesn't change functionality and makes unit testing easier\n        // I intend to do more thorough user testing later\n        //.takeUntil(action$.ofType(fetchDataset.toString()))\n        \n      );\n    })\n    ,catchError((error) => {\n      const newErr = new Error(\"Error fetching dataset: \" + error.message);\n      return of(setError(newErr));\n    })\n  );\n}\n\nconst getScheme = (username, password, token) =>{\n   let scheme = 'None';\n    if(token) {\n      scheme = 'Bearer'\n    } else if (username && password) {\n      scheme = 'Basic'\n    }\n    return scheme;\n}\n\nconst buildAuthHeader = (username, password, token) => {\n  let header = null;\n  var scheme = getScheme(username, password, token);\n\n  switch (scheme){\n    case 'Basic':\n       var basic = \"Basic \" + new Buffer(`${username}:${password}`).toString(\"base64\");\n       header = {'Authorization' : basic};\n      break;\n    case 'Bearer':\n      var bearer = `Bearer ${token}`;\n      header = {'Authorization' : bearer};\n      break;\n    default:\n      header = null;\n      break;\n  }\n  \n  return header;\n}\n\nexport default fetchDatasetEpic;\nexport { fetchDataset, buildAuthHeader };\n","import { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { map, mergeMap, catchError } from 'rxjs/operators';\nimport { isNil, is } from \"ramda\";\n\nimport { buildIndices } from './index-dataset-epic';\n\nimport { setError } from \"domain/error\"\nimport { setDatasets, setKeyFields, setIgnoredFields, configureDataset } from \"domain/dataset\";\nimport { setControls } from \"domain/controls\";\n\nconst loadDataset = createAction(\"LOAD_DATASET\");\n\nconst loadDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(loadDataset.toString())\n    ,mergeMap(({ payload }) => {\n      return of(payload).pipe(\n        map(formatPayload)\n        ,mergeMap((payload) => {\n          return of(\n            setDatasets(payload)\n            ,setKeyFields(payload.keyFields)\n            ,setIgnoredFields(payload.ignoredFields)\n            ,setControls(payload.controls)\n            ,buildIndices(payload)\n          )\n        })\n        ,catchError((error) => {\n          if (is(ValidationError, error)) {\n            return of(setError(error));\n          } else {\n            /* istanbul ignore next */\n            throw error;\n          }\n        })\n      );\n    })\n  );\n}; \n\n// doesn't really care if it's not CSV; if it *is* CSV, convert to JSON.\n// Otherwise, just pass it along.\nconst CSVconvert = (data) => {\n  const owner = data.owner;\n  var lines = data.file.trim().split(/[\\r\\n]+/g);\n  if (lines.length < 2) { // bail if there's not even linebreaks\n    return data;\n  }\n\n  function finddelim(hdr) {\n    var delims = [',','|','\\t',';']\n    var delim = 0\n    var max = -1\n    for (var i=0; i < hdr.length; i++) {\n      if (max < hdr.split(delims[i]).length-1) {\n        max = hdr.split(delims[i]).length-1\n        delim = i\n      }\n    }\n    return delims[delim];\n  }\n\n  var delimiter = finddelim(lines[0])\n  var jsonstring = '['\n  var colnames = lines[0].split(delimiter)\n  for (var i=1; i < lines.length; i++) {\n    var entry = lines[i].split(delimiter)\n    if (entry.length !== colnames.length) { // malformed CSV, or not even CSV.\n      return data;\n    }\n    jsonstring += \"{ \"\n    for (var j=0; j < colnames.length; j++) {\n      jsonstring += '\"'+colnames[j]+'\": \"'+entry[j]+'\"';\n      if (j < colnames.length-1 ) {\n        jsonstring += \", \"\n      } else {\n        jsonstring += \" }\"\n        if (i < lines.length-1) {\n          jsonstring += \",\\n\"\n        }\n      }\n    }\n  }\n  jsonstring += ']'\n  return { 'owner': owner, 'file': jsonstring };\n}\n\n//if we have a naked array or an object not containing a dataset instead of an object containing a dataset\n//transfer the array into an object's dataset to maintain a consistent\n//schema with what is used elsewhere see https://github.com/CyberReboot/CRviz/issues/33\nconst formatPayload = (data) => {\n  const owner = data.owner;\n  const content = data.content;\n  const datasets = content.datasets;\n  const keyFields = content.keyFields || [];\n  const ignoredFields = content.ignoredFields || [];\n  const controls = content.controls || {};\n  const includeData = ('includeData' in data) ? data.includeData : true;\n  const includeControls = ('includeControls' in data) ? data.includeControls: false;\n\n  var final = {};\n\n  if(datasets){\n    final =  datasets;\n  } else if(!isNil(content.dataset) && is(Array, content.dataset)){\n    final[owner] = { 'dataset': content.dataset };\n    if(content.configuration){\n      final[owner].configuration = content.configuration;\n    }\n  } else if(isNil(content.dataset) && is(Array, content)) {\n    final[owner] = { 'dataset': content };\n  } else if(isNil(content.dataset)) {\n    let obj = {};\n    Object.entries(content).forEach( (entry) =>{\n      let key = entry[0];\n      let value = entry[1]\n      obj[key] = value;\n      })\n    final[owner] = { 'dataset': [obj] };\n  } else {\n    throw ValidationError('Data in invalid format');\n  }\n\n  Object.keys(final).forEach((owner) =>{\n    const dataset = final[owner].dataset;\n    const initialConfig = final[owner].configuration;\n    final[owner] = configureDataset(dataset, initialConfig, keyFields, ignoredFields);\n  })\n\n  data = { \n          'datasets': includeData ? final : {},\n          'keyFields': includeData ? keyFields : {},\n          'ignoredFields': includeData ? ignoredFields : {},\n          'controls': includeControls ? controls : {}\n        };\n  return data;\n};\n\nfunction ValidationError(message) {\n  this.name = 'ValidationError';\n  this.message = message;\n}\n\nValidationError.prototype = Object.create(Error.prototype);\n\nexport default loadDatasetEpic;\n\nexport { loadDataset, CSVconvert };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"Header_header__22iYy\",\"logo\":\"Header_logo__1Q9PB\",\"appName\":\"Header_appName__3ZkiC\",\"infoIcon\":\"Header_infoIcon__37dfu\",\"infoPopup\":\"Header_infoPopup__vFXpZ\",\"tagline\":\"Header_tagline__2wfq6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"searchControls\":\"SearchControls_searchControls__3c9kl\",\"searchContainer\":\"SearchControls_searchContainer__11kME\",\"search\":\"SearchControls_search__1lu7v\",\"label\":\"SearchControls_label__3sWW2\"};","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  hierarchyConfig: [], // Array of fields to group by.\n  shouldShowNodes: true, // Whether to show individual nodes\n  darkTheme: false, // Whether to use dark theme\n  colorBy: null, // The field for which to color the devices/groupings by.\n  start: null, // The uuid of the dataset to use as the starting point for comparison\n  end: null // The uuid of the dataset to use as the end point for comparison\n};\n\n// ACTIONS\n\nconst setControls = createAction(\"SET_CONTROLS\");\nconst setStartDataset = createAction(\"SET_START_DATASET\");\nconst setEndDataset = createAction(\"SET_END_DATASET\");\nconst setHierarchyConfig = createAction(\"SET_HIERARCHY_CONFIG\");\nconst showNodes = createAction(\"SHOW_NODES\");\nconst useDarkTheme = createAction(\"USE_DARK_THEME\");\nconst colorBy = createAction(\"COLOR_BY\");\n\nconst reducer = handleActions(\n  {\n    [setControls]: (state, { payload }) =>{\n      const hierarchyConfig = payload.hierarchyConfig || defaultState.hierarchyConfig;\n      const shouldShowNodes = ('shouldShowNodes' in payload) ? !!payload.shouldShowNodes : true;\n      const darkTheme = ('darkTheme' in payload) ? !!payload.darkTheme : false;\n      const colorBy = payload.colorBy || defaultState.colorBy\n      const start = payload.start || defaultState.start\n      const end = payload.end || defaultState.end\n      return { \n        ...state,\n        hierarchyConfig: hierarchyConfig,\n        shouldShowNodes: shouldShowNodes,\n        darkTheme: darkTheme,\n        colorBy: colorBy,\n        start: start,\n        end: end\n      }\n    },\n    [setStartDataset]: (state, { payload }) => {\n      return { ...state, start: payload }\n    },\n    [setEndDataset]: (state, { payload }) => ({ ...state, end: payload }),\n    [setHierarchyConfig]: (state, { payload }) => ({ ...state, hierarchyConfig: payload }),\n    [showNodes]: (state, { payload }) => ({ ...state, shouldShowNodes: !!payload }), // Convert payload to boolean for easier debugging\n    [useDarkTheme]: (state, { payload }) => ({ ...state, darkTheme: !!payload }), // Convert payload to boolean for easier debugging\n    [colorBy]: (state, { payload }) => ({ ...state, colorBy: payload })\n  },\n  defaultState\n);\n\nconst selectControls = (state) => state.controls;\n\nexport default reducer;\nexport { setControls, setHierarchyConfig, showNodes, colorBy, useDarkTheme, selectControls, setStartDataset, setEndDataset };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"viz\":\"Visualization_viz__ukgQP\",\"delta\":\"Visualization_delta__3vDxh\",\"plus\":\"Visualization_plus__2hiPX\",\"minus\":\"Visualization_minus__2rrmV\",\"bg-circle\":\"Visualization_bg-circle__1JrSq\"};","module.exports = \"data:image/png;base64,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\"","import { createAction } from \"redux-actions\";\nimport { Observable, of } from \"rxjs\";\nimport { catchError, debounceTime, mergeMap, map } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\n\nimport { loadDataset, CSVconvert } from './load-dataset-epic';\n\n// ACTIONS\nconst uploadDataset = createAction(\"UPLOAD_DATASET\");\n\n// EPIC\nconst uploadDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(uploadDataset.toString()).pipe(\n      mergeMap((action) => {\n        const owner = action.payload.owner;\n        const file = action.payload.file;\n        return fromReader(owner, file).pipe(\n            debounceTime(500)\n            ,map(CSVconvert)\n            ,map(fromJson)\n            ,map(loadDataset)\n            ,catchError((error) => {\n              if (error instanceof SyntaxError) {\n                const newErr = new Error(\"Invalid JSON.\");\n                return of(setError(newErr));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          )\n      })\n    );\n};\n\n/**\n * Little function to create an observable to read local files.\n * RxJS DOM v5 doesn't have it!?\n */\nconst fromReader = (owner, file) => {\n  return Observable.create((observer) => {\n    const reader = new window.FileReader();\n\n    reader.addEventListener('load', () => {\n      observer.next({ 'owner': owner, 'file': reader.result });\n      observer.complete();\n    });\n\n    reader.addEventListener('error', () => {\n      observer.error(reader.error);\n      observer.complete();\n    });\n\n    reader.readAsText(file)\n  });\n}\n\nconst fromJson = (payload) =>{\n  const owner = payload.owner;\n  const content = JSON.parse(payload.file);\n  const includeData = ('includeData' in payload) ? payload.includeData : true;\n  const includeControls = ('includeControls' in payload) ? payload.includeControls: false;\n\n  return {\n    'owner': owner,\n    'content': content, \n    'includeData': includeData,\n    'includeControls': includeControls,\n  };\n}\n\nexport default uploadDatasetEpic;\nexport { uploadDataset, fromJson };\n","import React from 'react';\nimport ToolTip from 'react-portal-tooltip'\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nimport logo from './crlogo.png';\nimport style from './Header.module.css';\n\nclass Header extends React.Component {\n\n\tstate ={\n\t\tshowInfo: false\n\t}\n\n\thideTooltip = () => {\n\t\tthis.setState({\n\t\t\tshowInfo: false\n\t\t})\n\t}\n\n\tshowTooltip = () =>  {\n\t\tthis.setState({\n\t\t\tshowInfo: true\n\t\t})\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={ style.header }>\n\t\t\t  <a href=\"http://www.cyberreboot.org/\" target=\"_blank\" rel=\"noopener noreferrer\">\n\t\t\t  \t<img src={ logo } className={ style.logo } alt='Cyber Reboot' />\n\t\t\t  </a>\n\t\t\t  <span className={ style.appName }>CRviz</span>\n\t\t\t  <span className={ style.infoIcon }>\n\t\t\t\t<label id=\"showInfo\" onMouseEnter={this.showTooltip} onMouseLeave={this.hideTooltip}>\n\t\t\t      <FontAwesomeIcon icon={faInfoCircle} />\n\t\t\t    </label>\n\t\t\t    <ToolTip active={this.state.showInfo} position=\"bottom\" parent=\"#showInfo\" tooltipTimeout={250}>\n\t\t\t      <div className={ style.infoPopup }>\n\t\t\t        About CRviz:<br/>\n\t\t\t        Home: <a href=\"https://www.cyberreboot.org/projects/crviz/\">https://www.cyberreboot.org/projects/crviz/</a><br/>\n\t\t\t        Version: { process.env.REACT_APP_VERSION } <br/>\n\t\t\t        Copyright  2017-2018 IQT Labs LLC.\n\t\t\t      </div>\n\t\t\t    </ToolTip>\n\t    \t  </span>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default Header;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport { Draggable } from \"react-beautiful-dnd\";\n\nimport classNames from \"classnames\";\n\nfunction SelectedField({\n  style,\n  initialItemText,\n  subsequentItemText,\n  displayName,\n  count = 0,\n  index,\n  draggableId,\n  dragIndex,\n  animated\n}) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {\n        (provided, snapshot) => {\n        return (\n          <Field\n            style={style}\n            initialItemText={initialItemText}\n            subsequentItemText={subsequentItemText}\n            displayName={displayName + \" (\" + count + \")\"}\n            dragIndex={dragIndex}\n            provided={provided}\n            animated={animated}\n          />\n        );\n      }}\n    </Draggable>\n  );\n}\n\nfunction Field({ style, initialItemText, subsequentItemText, displayName, dragIndex, animated, provided }) {\n  return (\n    <div>\n      <div\n        className={style.draggable}\n        ref={provided.innerRef}\n        {...provided.draggableProps}\n        {...provided.dragHandleProps}\n      >\n        <div className={style.field}>\n          <span\n            className={classNames({\n              [style.groupBy]: true,\n              [style.animated]: animated\n            })}\n          >\n            {dragIndex === 0 ? initialItemText : subsequentItemText}\n          </span>\n          <span className={style.fieldName}>{displayName}</span>\n        </div>\n      </div>\n\n      {provided.placeholder}\n    </div>\n  );\n}\n\nSelectedField.propTypes = {\n  style: PropTypes.shape({\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n    fieldName: PropTypes.string.isRequired\n  }),\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired,\n  dragIndex: PropTypes.number.isRequired,\n  animated: PropTypes.bool.isRequired\n};\n\nexport default SelectedField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { findIndex, eqBy, differenceWith, isEmpty, isNil, path } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport SelectedField from \"./SelectedField\";\n\nclass SelectedFieldList extends React.Component {\n  state = {\n    lastFields: [],\n    toAnimate: null\n  };\n\n  componentDidMount() {\n    this.setState({\n      lastFields: this.props.fields\n    });\n  }\n\n  static getDerivedStateFromProps(props, state){\n    const { getFieldId } = props;\n\n    // Find newly inserted item, if any\n    let toAnimate = differenceWith(\n      eqBy(getFieldId),\n      props.fields,\n      state.lastFields\n    )[0];\n\n    if (toAnimate) {\n      // Only animate item that are not inserted at the bottom using AffordanceDroppable\n      const newIndex = findIndex(eqBy(getFieldId, toAnimate), props.fields);\n      toAnimate = newIndex < state.lastFields.length ? toAnimate : null;\n    }\n\n    return {\n      lastFields: props.fields,\n      toAnimate: toAnimate\n    };\n  }\n\n  render() {\n    const { style, initialItemText, subsequentItemText, fields, values, getFieldId, droppableId, dragState } = this.props;\n\n    const draggingOver = isDraggingOver(droppableId, dragState);\n    return (\n      <div className={style.listContainer}>\n        <Droppable droppableId={droppableId} type=\"Field\">\n          {\n            (provided, snapshot) => {\n            return (\n              <div\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n                className={style.droppable}\n              >\n                <List\n                  style={style}\n                  initialItemText={initialItemText}\n                  subsequentItemText={subsequentItemText}\n                  fields={fields}\n                  values={values}\n                  getFieldId={getFieldId}\n                  droppableId={droppableId}\n                  dragState={dragState}\n                  toAnimate={this.state.toAnimate}\n                />\n\n                {draggingOver &&\n                  dragState.destination.index !== fields.length &&\n                  provided.placeholder}\n              </div>\n            );\n          }}\n        </Droppable>\n      </div>\n    );\n  }\n}\n\nfunction List({\n  fields,\n  values,\n  getFieldId,\n  style,\n  initialItemText,\n  subsequentItemText,\n  droppableId,\n  dragState,\n  toAnimate\n}) {\n  if (isEmpty(fields)) {\n    return null;\n  }\n  return fields.map((field, index) => {\n    const id = getFieldId(field);\n    const animated = toAnimate && getFieldId(field) === getFieldId(toAnimate);\n    const count = values[id].length\n    return (\n      <SelectedField\n        style={style}\n        initialItemText={initialItemText}\n        subsequentItemText={subsequentItemText}\n        draggableId={id}\n        key={id}\n        displayName={field.displayName}\n        count={count}\n        index={index}\n        dragIndex={dragIndex(droppableId, dragState, index)}\n        animated={animated || false}\n      />\n    );\n  });\n}\n\nconst isDraggingOver = (droppableId, dragState) => {\n  return (\n    !isNil(dragState) &&\n    path([\"destination\", \"droppableId\"], dragState) === droppableId\n  );\n};\n\n/**\n * Calculate the potential indices during drag based on the current dragState.\n *\n * This is used to update the groupBy label on the fly.\n */\nconst dragIndex = (droppableId, dragState, index) => {\n  if (!isDraggingOver(droppableId, dragState)) {\n    return index;\n  }\n\n  const { source, destination } = dragState;\n\n  const from = source.index;\n  const to = destination.index;\n\n  // When inserting, bump down everything below the new index\n  if (source.droppableId !== destination.droppableId) {\n    return index >= to ? index + 1 : index;\n  }\n\n  // For an item that is being dragged, the new index is the destination index.\n  if (index === from) {\n    return to;\n  }\n  // Items not between the source and destination indices are not affected\n  if (index < Math.min(from, to) || index > Math.max(from, to)) {\n    return index;\n  }\n\n  if (from < to) {\n    // If moving down, bump up everything in between\n    return index - 1;\n  } else {\n    // Otherwise, bump down everything in between\n    return index + 1;\n  }\n};\n\nSelectedFieldList.defaultProps = {\n  fields: []\n};\n\nSelectedFieldList.propTypes = {\n  fields: PropTypes.array,\n  droppableId: PropTypes.string.isRequired,\n  getFieldId: PropTypes.func.isRequired,\n\n  style: PropTypes.shape({\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired\n  })\n};\n\nexport default SelectedFieldList;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Draggable } from \"react-beautiful-dnd\";\n\nfunction AvailableField({ style, displayName, index, draggableId }) {\n  return (\n    <Draggable draggableId={draggableId} type=\"Field\" index={index}>\n      {(provided, snapshot) => {\n        return (\n          <span className={style.draggableContainer}>\n            <span\n              className={style.field}\n              ref={provided.innerRef}\n              {...provided.draggableProps}\n              {...provided.dragHandleProps}\n              style={{\n                ...provided.draggableProps.style,\n                // Disable animation of items moving out of the way when\n                // dragging. It implies the list is sortable, and it doesn't\n                // work well with multiline list anyway.\n                transform: snapshot.isDragging\n                  ? provided.draggableProps.style.transform\n                  : \"none\"\n              }}\n            >\n              {displayName}\n            </span>\n          </span>\n        );\n      }}\n    </Draggable>\n  );\n}\n\nconst StyleProps = PropTypes.shape({\n  draggableContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n});\n\nAvailableField.propTypes = {\n  style: StyleProps.isRequired,\n  displayName: PropTypes.string.isRequired,\n  index: PropTypes.number.isRequired,\n  draggableId: PropTypes.string.isRequired\n};\n\nexport default AvailableField;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport classNames from \"classnames\";\n\nimport { isEmpty, contains, map, sortBy, curry } from \"ramda\";\n\nimport { Droppable } from \"react-beautiful-dnd\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTrashAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nimport AvailableField from \"./AvailableField\";\n\nfunction AvailableFieldList({\n  style,\n  fields,\n  values,\n  getFieldId,\n  droppableId,\n  dragState\n}) {\n  return (\n    <Droppable droppableId={droppableId} type=\"Field\">\n      {(provided, snapshot) => {\n        const dragForeign = isDraggingForeign(dragState, fields, getFieldId);\n\n        return (\n          <div\n            className={classNames(style.listContainer, {\n              [style.dragForeign]: dragForeign,\n              [style.isDraggingOver]: snapshot.isDraggingOver\n            })}\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {!isEmpty(fields) &&\n              sortBy(getCount(getFieldId, values), fields).map((field, index) => {\n                const id = getFieldId(field);\n                const count = values[id].length || 0;\n                return (\n                  <AvailableField\n                    style={style}\n                    key={id}\n                    draggableId={id}\n                    displayName={`${field.displayName} (${count})`}\n                    index={index}\n                    withPlaceholder={false}\n                  />\n                );\n              })}\n\n            {dragForeign && (\n              <div className={style.dragForeignContainer}>\n                <span>\n                  <FontAwesomeIcon icon={faTrashAlt} />\n                </span>\n              </div>\n            )}\n          </div>\n        );\n      }}\n    </Droppable>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst isDraggingForeign = (dragState, fields, getFieldId) => {\n  return (\n    dragState &&\n    dragState.draggableId &&\n    !contains(dragState.draggableId, map(getFieldId, fields))\n  );\n};\n\nAvailableFieldList.defaultProps = {\n  fields: []\n};\n\nconst StyleProps = PropTypes.shape({\n  listContainer: PropTypes.string.isRequired,\n  field: PropTypes.string.isRequired,\n  fieldName: PropTypes.string.isRequired\n});\n\nAvailableFieldList.propTypes = {\n  style: StyleProps.isRequired,\n  fields: PropTypes.array,\n  values: PropTypes.object,\n  getFieldId: PropTypes.func.isRequired,\n  droppableId: PropTypes.string.isRequired\n};\n\nexport default AvailableFieldList;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nimport classNames from \"classnames\";\nimport { Droppable } from \"react-beautiful-dnd\";\n\n/**\n * Droppable component to use as a dummy drop target next to SelectedFieldList.\n * This droppable doesn't contain any draggable.\n *\n * Note: this cannot be used nested inside SelectedFieldList, because they need\n * to accept the same type, and react-beautiful-dnd doesn't allow that.\n */\nfunction DropTarget({ style, initialItemText, subsequentItemText, droppableId, isDropDisabled, fields }) {\n  return (\n    <div\n      className={classNames({\n        [style.listContainer]: true,\n        [style.isDropDisabled]: isDropDisabled\n        })}>\n      <div className={style.draggable}>\n        <div className={style.field}>\n          <span className={style.groupBy}>\n            { fields.length === 0 ? initialItemText : subsequentItemText }\n          </span>\n\n          <Droppable\n            isDropDisabled={ isDropDisabled }\n            droppableId={droppableId}\n            type=\"Field\">\n\n            {(provided, snapshot) => {\n              return (\n                <span\n                  ref={provided.innerRef}\n                  {...provided.droppableProps}\n                  className={\n                    classNames({\n                      [style.dropTarget]: true,\n                      [style.isDraggingOver]: snapshot.isDraggingOver\n                    })}\n                >\n                    Drop attribute here\n                </span>\n              )\n            }}\n          </Droppable>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nDropTarget.propTypes = {\n  style: PropTypes.shape({\n    isDropDisabled: PropTypes.string.isRequired,\n    dropTarget: PropTypes.string.isRequired,\n    isDraggingOver: PropTypes.string.isRequired,\n\n    // The classes below should be identical to the styling of SelectedFieldList\n    // to make both layout the same.\n    listContainer: PropTypes.string.isRequired,\n    draggable: PropTypes.string.isRequired,\n    field: PropTypes.string.isRequired,\n    groupBy: PropTypes.string.isRequired,\n  }),\n\n  droppableId: PropTypes.string.isRequired,\n  isDropDisabled: PropTypes.bool.isRequired,\n  fields: PropTypes.array.isRequired\n}\n\n\nexport default DropTarget;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\n\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\nimport { setHierarchyConfig, selectControls, showNodes } from \"domain/controls\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\n\nconst SELECTED_FIELD_LIST_ID = 'SelectedFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst DROP_TARGET_ID = 'DropTarget';\n\nclass HierarchySelector extends React.Component {\n\n  state = {\n    dragState: null\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === SELECTED_FIELD_LIST_ID) {\n      this.updateHierarchy(draggableId, destination.index)\n    } else if (destination.droppableId === (DROP_TARGET_ID)) {\n      this.updateHierarchy(draggableId, this.props.controls.hierarchyConfig.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  updateHierarchy = (fieldId, newIndex) => {\n    const { fields } = this.props.configuration;\n    const { hierarchyConfig } = this.props.controls;\n\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedHierarchy = compose(addNew, removeOld)(hierarchyConfig)\n\n    this.props.setHierarchyConfig(updatedHierarchy)\n  }\n\n  removeField = (fieldId) => {\n    const { hierarchyConfig } = this.props.controls;\n    const { setHierarchyConfig } = this.props;\n    const index = findFieldIndex(hierarchyConfig, fieldId);\n\n    if (index !== null) {\n      setHierarchyConfig(remove(index, 1, hierarchyConfig ))\n    }\n\n    if(this.props.controls.hierarchyConfig.length === 0 ){\n      this.props.showNodes(true);\n    }\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n\n    const hierarchyConfig = this.props.controls.hierarchyConfig;\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      hierarchyConfig\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Group By\"\n              subsequentItemText=\"Then By\"\n              fields={ hierarchyConfig }\n              values={ values }\n              droppableId={ SELECTED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Group By\"\n            subsequentItemText=\"Then By\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === SELECTED_FIELD_LIST_ID }\n            droppableId= { DROP_TARGET_ID }\n            fields={ this.props.controls.hierarchyConfig }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nHierarchySelector.propTypes = {\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n  controls: PropTypes.shape({\n    hierarchyConfig: PropTypes.array.isRequired\n  }),\n  showNodes: PropTypes.func.isRequired\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state) => ({\n  configuration: selectMergedConfiguration(state),\n  values: selectMergedValues(state),\n  controls: selectControls(state)\n});\n\nconst mapDispatchToProps = {\n  setHierarchyConfig,\n  showNodes\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HierarchySelector);\n","import { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { switchMap, map } from 'rxjs/operators';\n\nimport { setDatasetDiff } from \"domain/dataset\";\n\nconst DIFF_DATASET = \"DIFF_DATASET\";\n\nconst diffDataset = (payload) => ({'type': DIFF_DATASET, 'payload': payload })\n\nconst diffDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(DIFF_DATASET)\n      ,switchMap(({ payload }) => {\n        return of(payload).pipe(\n        \tmap(generateDiff)\n          ,map((payload) =>\n            setDatasetDiff(payload)\n          )\n        );\n      })\n    );\n};\n\n\nconst generateDiff = (payload) => {\n  const startOwner = payload.start.owner;\n  const startDs = payload.start.dataset;\n  const endOwner = payload.end.owner;\n  const endDs = payload.end.dataset;\n\n  let diffs = {\n  \tadded: [],\n  \tchanged:[],\n  \tremoved:[]\n  };\n  diffs.added = diffs.added.concat(endDs.filter(ei => startDs.findIndex(si => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n  diffs.removed = diffs.removed.concat(startDs.filter(si => endDs.findIndex(ei => ei.CRVIZ[\"_HASH_KEY\"] === si.CRVIZ[\"_HASH_KEY\"]) === -1).map(i => i.CRVIZ[\"_HASH_KEY\"]));\n\n  diffs.changed = diffs.changed.concat(\n  \tendDs.filter(\n  \t\tei => startDs.findIndex(\n  \t\t\tsi => si.CRVIZ[\"_HASH_KEY\"] === ei.CRVIZ[\"_HASH_KEY\"] &&\n  \t\t\t\t\t\tsi.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] !== ei.CRVIZ[\"_HASH_WITHOUT_IGNORED\"]\n  \t\t) !== -1\n  \t).map(i => i.CRVIZ[\"_HASH_KEY\"])\n  );\n\n  //console.log(\"diffs to return: %o\", diffs);\n  const result = {\n  \t'start': startOwner,\n  \t'end': endOwner,\n  \t'differences': diffs\n  }\n  return result;\n};\n\nexport default diffDatasetEpic;\n\nexport { diffDataset };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { DragDropContext} from 'react-beautiful-dnd';\n\nimport {\n  compose,\n  differenceWith,\n  eqBy,\n  equals,\n  find,\n  findIndex,\n  identity,\n  insert,\n  isEmpty,\n  isNil,\n  path,\n  remove\n} from \"ramda\";\n\nimport { \n  selectMergedConfiguration, selectMergedValues, getFieldId, selectDataset,\n  setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields\n} from \"domain/dataset\";\nimport { diffDataset } from \"epics/diff-dataset-epic\";\n\nimport SelectedFieldList from 'features/drag-drop-utils/SelectedFieldList';\nimport AvailableFieldList from 'features/drag-drop-utils/AvailableFieldList';\nimport DropTarget from 'features/drag-drop-utils/DropTarget';\n\nimport availableFieldListStyle from 'features/drag-drop-utils/AvailableFieldList.module.css';\nimport selectedFieldListStyle from 'features/drag-drop-utils/SelectedFieldList.module.css';\n\nconst KEY_FIELD_LIST_ID = 'KeyFieldList';\nconst IGNORED_FIELD_LIST_ID = 'IgnoredFieldList';\nconst AVAILABLE_FIELD_LIST_ID = 'AvailableFieldList';\nconst KEY_TARGET_ID = 'KeyTarget';\nconst IGNORED_TARGET_ID = 'IgnoredTarget';\n\nclass ComparisonSelector extends React.Component {\n\n  state = {\n    dragState: null\n  }\n\n  onDragStart = (dragStart) => {\n    this.setState({\n      dragState: dragStart\n    });\n  }\n\n  onDragUpdate = (dragUpdate) => {\n    this.setState({\n      dragState: dragUpdate\n    })\n  }\n\n  onDragEnd = (dropResult) => {\n    const { draggableId, destination } = dropResult;\n    this.setState({ dragState: null })\n\n    if (destination === null) {\n      return;\n    } else if (destination.droppableId === KEY_FIELD_LIST_ID) {\n      this.updateKeyFields(draggableId, destination.index)\n    } else if (destination.droppableId === (KEY_TARGET_ID)) {\n      this.updateKeyFields(draggableId, this.props.keyFields.length);\n    } else if (destination.droppableId === IGNORED_FIELD_LIST_ID) {\n      this.updateIgnoreFields(draggableId, destination.index)\n    } else if (destination.droppableId === (IGNORED_TARGET_ID)) {\n      this.updateIgnoreFields(draggableId, this.props.ignoredFields.length);\n    } else {\n      this.removeField(draggableId);\n    }\n  }\n\n  getUpdatedFields = (fieldId, newIndex, fieldsToUpdate) =>{\n  \tconst { fields } = this.props.configuration;\n\n  \tconst index = findFieldIndex(fieldsToUpdate, fieldId);\n    if (index === newIndex) { return; }\n\n    const hasId = (id) => (field) => getFieldId(field) === id;\n    const field = find(hasId(fieldId), fields)\n\n    const removeOld = isNil(index) ? identity : remove(index, 1);\n    const addNew = insert(newIndex, field);\n    const updatedFields = compose(addNew, removeOld)(fieldsToUpdate);\n\n    return updatedFields;\n  }\n\n  updateKeyFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedKeys = this.getUpdatedFields(fieldId, newIndex, keyFields);\n    \n    if(updatedKeys){\n    \tthis.props.setKeyFields(updatedKeys);\n      this.updateDiff(updatedKeys, ignoredFields);\n    }\n  }\n\n  updateIgnoreFields = (fieldId, newIndex) =>{\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n\n    const updatedIgnored = this.getUpdatedFields(fieldId, newIndex, ignoredFields);\n\n    if(updatedIgnored){\n    \tthis.props.setIgnoredFields(updatedIgnored);\n      this.updateDiff(keyFields, updatedIgnored);\n\t  }\n  }\n\n  removeField = (fieldId) => {\n    const keyFields = this.props.keyFields;\n    const keyIndex = findFieldIndex(keyFields, fieldId);\n\n    const ignoredFields = this.props.ignoredFields;\n    const ignoredIndex = findFieldIndex(ignoredFields, fieldId);\n\n    let updatedKeys = null;\n    let updatedIgnored = null;\n\n    if (keyIndex !== null) {\n      updatedKeys = remove(keyIndex, 1, keyFields );\n      this.props.setKeyFields(updatedKeys);\n    }\n\n    if (ignoredIndex !== null) {\n      updatedIgnored = remove(ignoredIndex, 1, ignoredFields );\n      this.props.setIgnoredFields(updatedIgnored);      \n    }\n\n    if(updatedKeys || updatedIgnored){\n      this.updateDiff(updatedKeys || keyFields, updatedIgnored || ignoredFields);\n    }\n  }\n\n  updateDiff = (keyFields, ignoredFields) => {\n    const toDiff ={\n      'start': {\n        'owner': this.props.startUuid,\n        'dataset': this.props.start\n      },\n      'end':{\n        'owner': this.props.endUuid,\n        'dataset': this.props.end\n      },\n      'configuration': this.props.configuration,\n      'key': keyFields,\n      'ignore': ignoredFields,\n    }\n\n    this.props.diffDataset(toDiff);\n  }\n\n  render() {\n    if (this.props.configuration === null) {\n      return null;\n    }\n\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const usedFields = keyFields.concat(ignoredFields);\n\n    if (isEmpty(this.props.configuration.fields)) {\n      return null;\n    }\n\n    const availableFields = differenceWith(\n      eqBy(getFieldId),\n      this.props.configuration.fields.filter((f) => f.groupable),\n      usedFields\n    );\n\n    const values = this.props.values;\n\n    const dragState = this.state.dragState;\n\n    return (\n      <div>\n        <DragDropContext\n          onDragStart={ this.onDragStart }\n          onDragUpdate={ this.onDragUpdate }\n          onDragEnd={ this.onDragEnd }>\n\n          <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n              fields={ keyFields }\n              values={ values }\n              droppableId={ KEY_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Key On\"\n              subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === KEY_FIELD_LIST_ID }\n            droppableId= { KEY_TARGET_ID }\n            fields={ this.props.keyFields }\n          />\n        </div>\n\n        <div style={{ marginBottom: '2rem' }}>\n            <SelectedFieldList\n              style={ selectedFieldListStyle }\n              initialItemText=\"Ignore\"\n              subsequentItemText=\"And\"\n              fields={ ignoredFields }\n              values={ values }\n              droppableId={ IGNORED_FIELD_LIST_ID }\n              getFieldId={ getFieldId }\n              dragState={ dragState }\n            />\n\n          <DropTarget\n            style={ selectedFieldListStyle }\n            initialItemText=\"Ignore\"\n            subsequentItemText=\"And\"\n            isDropDisabled={ path(['source', 'droppableId'], dragState) === IGNORED_FIELD_LIST_ID }\n            droppableId= { IGNORED_TARGET_ID }\n            fields={ this.props.ignoredFields }\n          />\n        </div>\n\n          <AvailableFieldList\n            style={ availableFieldListStyle }\n            fields={ availableFields }\n            values={ values }\n            droppableId={ AVAILABLE_FIELD_LIST_ID }\n            getFieldId={ getFieldId }\n            dragState={ this.state.dragState }\n          />\n\n        </DragDropContext>\n      </div>\n    );\n  }\n}\n\nComparisonSelector.propTypes = {\n  startUuid: PropTypes.string,\n  start: PropTypes.array,\n  endUuid: PropTypes.string,\n  end: PropTypes.array,\n  keyFields: PropTypes.array.isRequired,\n  ignoredFields: PropTypes.array.isRequired,\n  configuration: PropTypes.shape({\n    fields: PropTypes.array.isRequired\n  }),\n};\n\nconst findFieldIndex = (list, fieldId) => {\n  const matchId = compose(equals(fieldId), getFieldId)\n  const index = findIndex(matchId, list)\n  return index === -1 ? null : index;\n}\n\nconst mapStateToProps = (state, ownProps) => ({\n  start: selectDataset(state, ownProps.startUuid),\n  end: selectDataset(state, ownProps.endUuid),\n  keyFields: getKeyFields(state),\n  ignoredFields: getIgnoredFields(state),\n  configuration: selectMergedConfiguration(state),\n  values: selectMergedValues(state)\n});\n\nconst mapDispatchToProps = {\n  setKeyFields,\n  setIgnoredFields,\n  diffDataset\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ComparisonSelector);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport {\n  sortBy,\n  curry,\n  compose,\n  join,\n  split,\n  find,\n  propEq,\n  prop,\n  isNil\n} from \"ramda\";\n\nfunction FieldSelect({\n  fields,\n  values,\n  getFieldId,\n  value,\n  onChange,\n  className,\n  name\n}) {\n\n  return (\n    <div className={className}>\n      <label className=\"select\">\n        <select\n          \n          name={name}\n          onChange={(evt) => onChange(stringToField(fields, evt.target.value))}\n          value={isNil(value) ? \"\" : fieldToString(value)}\n        >\n          <option value=\"\">&mdash;None&mdash;</option>\n          {sortBy(getCount(getFieldId, values), fields).map((field) => {\n            const key = getFieldId(field);\n            return (\n              <option key={key} value={key}>\n                {field.displayName} ({values[getFieldId(field)].length})\n              </option>\n            );\n          })}\n        </select>\n      </label>\n    </div>\n  );\n}\n\nconst getCount = curry((getFieldId, values, field) => {\n  return values[getFieldId(field)].length;\n});\n\nconst FieldShape = PropTypes.shape({\n  path: PropTypes.array.isRequired,\n  displayName: PropTypes.string.isRequired\n});\n\nFieldSelect.propTypes = {\n  fields: PropTypes.arrayOf(FieldShape).isRequired,\n  value: FieldShape,\n  onChange: PropTypes.func.isRequired,\n  className: PropTypes.string,\n  name: PropTypes.string\n};\n\nconst fieldToString = compose(join(\".\"), prop(\"path\"));\n\nconst stringToField = (fields, string) => {\n  const path = split(\".\", string);\n  return find(propEq(\"path\", path), fields);\n};\n\nexport default FieldSelect;\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport {\n  showNodes,\n  useDarkTheme,\n  colorBy,\n  selectControls\n} from \"domain/controls\";\nimport { selectMergedConfiguration, selectMergedValues, getFieldId } from \"domain/dataset\";\n\nimport FieldSelect from \"./FieldSelect\";\n\nimport style from \"./MiscControls.module.css\";\n\nfunction MiscControls({\n  controls,\n  configuration,\n  values,\n  showNodes,\n  colorBy,\n  useDarkTheme\n}) {\n  const fields = configuration.fields.filter((f) => f.groupable);\n  return (\n    <div className={style.container}>\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"show-node-check\"\n            checked={controls.shouldShowNodes}\n            onChange={(evt) => showNodes(evt.target.checked)}\n          />\n          <label htmlFor=\"show-node-check\" className={ style.switchLabel }>\n          </label>\n        </div>\n        <label >Show nodes</label>\n      </div>\n\n      <div className={`${style.checkboxContainer} input-group`}>\n        <div className={ style.switch }>\n          <input\n            type=\"checkbox\"\n            id=\"dark-theme-check\"\n            checked={controls.darkTheme}\n            onChange={(evt) => useDarkTheme(evt.target.checked)}\n          />\n          <label htmlFor=\"dark-theme-check\" className={ style.switchLabel }> \n          </label>\n        </div>\n        <label>Use dark theme</label>\n      </div>\n\n      <div className={`input-group ${style.colorBy}`}>\n        <label htmlFor=\"colorBy\">Color by</label>\n        <div className={style.fieldSelect}>\n          <FieldSelect\n            name=\"colorBy\"\n            className={style.selector}\n            onChange={colorBy}\n            fields={fields}\n            values={values}\n            getFieldId={getFieldId}\n            value={controls.colorBy}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    controls: selectControls(state),\n    configuration: selectMergedConfiguration(state),\n    values: selectMergedValues(state)\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    showNodes: (shouldShowNodes) => dispatch(showNodes(shouldShowNodes)),\n    useDarkTheme: (darkTheme) => dispatch(useDarkTheme(darkTheme)),\n    colorBy: (field) => dispatch(colorBy(field))\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(MiscControls);\n","import { is } from \"ramda\";\nimport { createAction } from \"redux-actions\";\nimport { ofType } from 'redux-observable';\nimport { of } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\nimport { QueryParseError } from 'lunr';\n\nimport { setError } from \"domain/error\"\nimport { setSearchResults} from \"./index-dataset-epic\";\n\nconst searchDataset = createAction(\"SEARCH_DATASET\");\n\nconst searchDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(searchDataset.toString())\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            tap(performSearch)\n            ,map((payload) =>\n              setSearchResults({\n                queryString: payload.queryString,\n                results: payload.results || []\n              })\n            )\n            ,catchError((error) => {\n              if (is(QueryParseError, error)) {\n                return of(setError(error));\n              } else {\n                /* istanbul ignore next */\n                throw error;\n              }\n            })\n          );\n      })\n    );\n};\n\nconst performSearch = (data) => {\n  data.results = [];\n  var toFind = data.queryString || '';\n  const indices = data.searchIndices;\n  var results = [];\n  if(indices && toFind){\n    for(var hash in indices){\n      const idx = indices[hash];\n      const idxResults = idx.search(toFind.toLowerCase());\n      const temp = new Set([...results, ...idxResults]);\n      results = [...temp];\n    }\n  }\n\n  data.dataset.forEach((el) => { el.CRVIZ._isSearchResult = false; });\n  results.forEach((r) => {\n    const res = data.dataset.find(i => i.CRVIZ[\"_HASH_KEY\"] === r.ref);\n    if(res){\n      res.CRVIZ._isSearchResult = true;\n      data.results.push(res);\n    }\n  });\n};\n\nexport default searchDatasetEpic;\n\nexport { searchDataset };\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSearch,  faTimesCircle} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { selectDataset, selectConfiguration } from \"domain/dataset\";\n\nimport { getSearchIndices, getSearchResults } from \"epics/index-dataset-epic\";\nimport { searchDataset } from \"epics/search-dataset-epic\";\n\nimport style from \"./SearchControls.module.css\";\n\nconst defaultState = {\n  queryString: '',\n  searchIndices: [],\n  hasSearch: false\n}\n\nclass Search extends React.Component {\n\n  state = defaultState\n\n  handleSearch(){\n    this.setState({\n      hasSearch: this.state.queryString !== ''\n    });\n    var data = {\n      dataset: this.props.dataset,\n      configuration: this.props.configuration,\n      searchIndices: this.props.searchIndices,\n      queryString: this.state.queryString,\n      results: this.props.results\n    }\n    this.props.searchDataset(data);\n  }\n\n  clearSearch(){\n    this.setState(defaultState, function() {\n      this.handleSearch();\n    });\n  }\n\n  handleQueryStringChange = (e) =>{\n        this.setState({\n          queryString: e.target.value\n        });\n  }\n\n  handleKeyPress = (e) => {\n    if(e.key === 'Enter'){\n      this.handleSearch();\n    }\n  }\n\n  render() {\n    return (\n      <div className={style.searchContainer}>\n        <span className={ style.search }>\n          <input\n            type=\"search\"\n            id=\"search-string\"\n            placeholder=\"Search\"\n            value={this.state.queryString}\n            onChange={this.handleQueryStringChange}\n            onKeyPress={this.handleKeyPress}\n          />\n\n          <label htmlFor=\"search-string\" className=\"button circular\" onClick={() => this.handleSearch()} title=\"Search\">\n            <FontAwesomeIcon icon={faSearch} />\n          </label>\n        </span>\n        { this.state.hasSearch &&\n          <span>\n            <label id=\"search-results\"> {this.props.results.length} Results found </label>\n            <label htmlFor=\"search-results\" className=\"button circular\" onClick={() => this.clearSearch()}>\n              <FontAwesomeIcon icon={faTimesCircle} />\n              </label>\n          </span>\n        }\n      </div>\n    );\n  }\n}\n\nSearch.propTypes = {\n  dataset: PropTypes.array,\n  configuration: PropTypes.object,\n  searchIndex: PropTypes.object,\n  queryString: PropTypes.string,\n  results: PropTypes.array,\n  searchDataset: PropTypes.func.isRequired\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  const hash = Object.keys(state.dataset.datasets)[0] || \"\"\n  return {\n    dataset: selectDataset(state, hash),\n    configuration: selectConfiguration(state, hash),\n    searchIndices: getSearchIndices(state),\n    queryString: state.search.queryString,\n    results: getSearchResults(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  searchDataset,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Search);\n","import {\n  add,\n  addIndex,\n  aperture,\n  concat,\n  forEach,\n  map,\n  last,\n  prop,\n  reject,\n  reverse,\n  splitEvery,\n  reduce\n} from \"ramda\";\n\nimport { packEnclose } from \"d3-hierarchy\";\n\n/**\n * Pack circles into rows and columns.\n */\nconst packGrid = (circles) => {\n  const rows = toRows(circles);\n  placeRows(rows);\n\n  // Recenter everything over the origin\n  var enclosingCircle = packEnclose(circles);\n  forEach((c) => {\n    c.x -= enclosingCircle.x;\n    c.y -= enclosingCircle.y\n  }, circles);\n};\n\nconst eachWithIndex = addIndex(forEach);\n\n/**\n * Assign x and y coordinates to rows of circles\n */\nconst placeRows = (rows) => {\n  rows = middleOut(map(middleOut, rows));\n\n  const maxRadii = map(maxRadius, rows);\n  const ys = coordinatesForRadii(maxRadii);\n  const xs = map(coordinatesForRadii, map(map(prop('r')), rows));\n\n  return eachWithIndex(\n    (row, i) =>\n      eachWithIndex((node, j) => {\n        node.x = xs[i][j];\n        node.y = ys[i];\n      }, row),\n    rows\n  );\n};\n\nconst maxRadius = (row) => {\n  return Math.max(...row.map((c) => c.r));\n};\n\n// Calculate the coordinates for the given list of radii\n// such that circles of these radii sit on the same line without colliding.\n// The circles are distributed evenly over the origin.\nconst coordinatesForRadii = (radii) => {\n  const diameters = map((r) => r * 2, radii)\n  const size = reduce(add, 0, diameters);\n\n  const first = 0 - size / 2 + radii[0]; // Calculate the first coordinate\n\n  return reduce((coords, [lastRadius, currentRadius]) => {\n    return [...coords, last(coords) + lastRadius + currentRadius];\n  }, [first], aperture(2, radii))\n};\n\n\nconst pickEven = (list) => addIndex(reject)((_, i) => i % 2 === 0, list);\nconst pickOdd = (list) => addIndex(reject)((_, i) => i % 2 !== 0, list);\n\n/**\n/ Re-order items from the middle out, alternating in direction.\n/\n/ Example:\n/ middleOut([1, 2, 3, 4, 5]) //=> [4, 2, 1, 3, 5]\n*/\nconst middleOut = (rows) => {\n  const above = pickEven(rows);\n  const below = pickOdd(rows);\n  return concat(reverse(above), below);\n};\n\nconst toRows = (circles) => {\n  return splitEvery(Math.ceil(Math.sqrt(circles.length)), circles);\n};\n\nexport default packGrid;\n","import { packEnclose } from \"d3-hierarchy\";\nimport packGrid from \"./pack-grid\";\n\n/**\n * An adaptation of the circle packing algorithm to reserve spacing at the\n * bottom of each non-leaf circle for labeling.\n */\nconst packWithLabel = () => {\n  let options = {\n    // Radius funcion\n    // See d3.pack.radius\n    radius: null,\n\n    // Layout size\n    // See d3.pack.size\n    size: [1, 1],\n\n    // Padding constant/function\n    // See d3.pack.padding\n    padding: () => 30,\n\n    // The packing method for packing siblings node.\n    // By default use the packGrid method. Can be set to use D3's packSiblings\n    // method instead.\n    packSiblings: packGrid\n  };\n\n  /**\n   * @param root - A D3 hierarchy object\n   * @return A `pack` object similar to `d3.pack` but with additional options (see above)\n   */\n  const pack = (root) => {\n    root.x = options.size[0] / 2;\n    root.y = options.size[1] / 2;\n    const { radius, size, packSiblings } = options;\n    const padding =\n      typeof options.padding === \"function\" ? options.padding : () => options.padding;\n\n    if (radius) {\n      root\n        .eachBefore(radiusLeaf(radius))\n        .eachAfter(packChildren(packSiblings, padding, 0.5))\n        .eachBefore(translateChild(1));\n    } else {\n      // If radius is not specified, set each leaf node's radius based on its\n      // value, then resize the entire layout to fit options.size\n      root\n        .eachBefore(radiusLeaf((d) => Math.sqrt(d.value)))\n        .eachAfter(packChildren(packSiblings, () => 20, 1))\n        .eachAfter(\n          packChildren(\n            packSiblings,\n            padding,\n            root.r / Math.min(...size)\n          )\n        )\n        .eachBefore(translateChild(Math.min(...size) / (2 * root.r)));\n    }\n    return root;\n  };\n\n  /**\n   * Create an option method for each of the option above.\n   * Calling the method without arguments returns the current value.\n   * Calling the method with argument sets the option.\n   *\n   * Example:\n   * var pack = packWithLabel(root)\n   *              .radius(() => 20)\n   * pack.radius() //=> () => 20.\n   */\n  Object.keys(options).forEach((key) => {\n    pack[key] = (...values) => {\n\n      if (values.length === 0) {\n        return options[key];\n      }\n      options[key] = values[0];\n      return pack;\n    };\n  });\n\n  return pack;\n};\n\nconst radiusLeaf = (radius) => {\n  return (node) => {\n    if (!node.children) {\n      node.r = Math.max(radius(node), 0);\n    }\n  };\n};\n\n\n/**\n * Pack children of a node, then set the node's radius to enclose all the children\n */\nconst packChildren = (packSiblings, padding, k) => (node) => {\n  if (!node.children) {\n    return;\n  }\n\n  const children = node.children;\n  const paddingSize = padding(node) * k || 0;\n\n  // Padding is implemented by adding it to the children's radii, pack,\n  // then returning the radii to their original value.\n  if (paddingSize) {\n    children.forEach((child) => (child.r += paddingSize));\n  }\n\n  packSiblings(children);\n  const enclosingRadius = packEnclose(children).r;\n\n  if (paddingSize) {\n    children.forEach((child) => (child.r -= paddingSize));\n  }\n\n  node.r = enclosingRadius + (0.10 * enclosingRadius) + paddingSize;\n};\n\n// Set the the node's children's positions to be inside the node and above the\n// space reserved for labeling.\nconst translateChild = (k) => (node) => {\n  const parent = node.parent;\n  node.r *= k;\n\n  if (node.labelSize) {\n    node.labelSize *= k;\n    node.labelY = node.r - node.labelSize / 2;\n    node.labelWidth = 2 * Math.sqrt(node.r ** 2 - node.labelY ** 2);\n  }\n\n  if (parent) {\n    node.x = parent.x + k * node.x;\n    node.y = parent.y + k * node.y;\n    if (parent.labelSize) {\n      node.y -= parent.labelSize / 2;\n    }\n  }\n};\n\nexport default packWithLabel;\n","import { chain, head, tail, map, reduce, path, isNil } from \"ramda\";\nimport { nest } from \"d3-collection\";\nimport { hierarchy as d3Hierarchy } from \"d3-hierarchy\";\n\n/**\n * Convert an array of nodes into a D3 hierarchy\n *\n * @param [array] data - an array of data\n * @hierarchy [array] - an array of objects in the shape of\n * {\n *   displayName: string,\n *   path: array[string]\n * }\n */\n\nconst toHierarchy = (data, hierarchyConfig) => {\n  const nesting = nestHierarchy(hierarchyConfig).entries(data);\n  const result = entriesToHierarchy(\"root\", null, hierarchyConfig, nesting);\n  return d3Hierarchy(result);\n};\n\n/**\n * Create the D3 nest function that will nest data given the hierarchyConfig.\n */\nconst nestHierarchy = (hierarchyConfig) => {\n  return reduce(\n    (nest, field) => {\n      return nest.key((d) => path(field.path, d));\n    },\n    nest(),\n    hierarchyConfig\n  );\n};\n\nconst countSearchResults = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._searchResultCount || 0) + (children[c].CRVIZ._isSearchResult || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countSearchResults(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countAdded = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._addedCount || 0) + (children[c].CRVIZ._isAdded || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countAdded(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countChanged = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._changedCount || 0) + (children[c].CRVIZ._isChanged || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countChanged(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\nconst countRemoved = (children) => {\n  if(isNil(children)){\n    return 0;\n  }\n\n  var result = 0;\n\n  for(var c in children){\n    if(!('CRVIZ' in children[c])){\n      children[c]['CRVIZ'] = {};\n    }\n    result += (children[c].CRVIZ._removedCount || 0) + (children[c].CRVIZ._isRemoved || 0) +\n              (\n                !isNil(children[c].values)\n                  ? countRemoved(children[c].values) : 0\n              );\n  }\n\n  return result;\n};\n\n/**\n * Convert nest entries into the format accepted by d3.hierarchy\n */\nconst entriesToHierarchy = (fieldValue, field, hierarchyConfig, entries) => {\n  if (fieldValue === 'Unknown') {\n    return {\n      fieldValue,\n      field,\n      children: chain(getLeaves, entries),\n      CRVIZ:{ \n        _searchResultCount: countSearchResults(entries),\n        _addedCount: countAdded(entries),\n        _changedCount: countChanged(entries),\n        _removedCount: countRemoved(entries),\n      }\n    }\n  }\n\n  return {\n    fieldValue,\n    field,\n    children: map((entry) => {\n      if (entry.values) {\n        return entriesToHierarchy(\n          entry.key,\n          head(hierarchyConfig),\n          tail(hierarchyConfig),\n          entry.values\n        );\n      } else {\n        return entry;\n      }\n    }, entries),\n    CRVIZ:{ \n      _searchResultCount: countSearchResults(entries),\n      _addedCount: countAdded(entries),\n      _changedCount: countChanged(entries),\n      _removedCount: countRemoved(entries),\n    }\n  };\n};\n\nconst getLeaves = (entry) => {\n  if (entry.values) {\n    return chain(getLeaves, entry.values)\n  } else {\n    return [entry]\n  }\n}\n\nexport default toHierarchy;\n","\n/**\n * Return a string that can be used to check if two data are the same.\n*/\nconst datumKey = (datum) => {\n  if (datum.depth === 0) {\n    return 'root';\n  } else if (datum.height > 0) {\n    return [\n      datumKey(datum.parent),\n      datum.data.field.path.join(\".\"),\n      datum.data.fieldValue\n    ].join(\".\");\n  } else {\n    return datum.data.uid;\n  }\n};\n\nexport default datumKey;\n","const className = (name) => `viz-${name}`;\n\nexport default className;","import datumKey from \"./datum-key\";\nimport className from \"./class-name\";\n\nconst appendCircles = ({ nodeRoot, labelRoot, packedData, showNodes, hasSearch }) => {\n  const data = packedData.descendants();\n\n  const nodes = nodeRoot\n    .selectAll(`g.${className(\"node\")}`)\n    .data(data, datumKey);\n\n  nodes.exit().remove();  \n\n  const nodesEnter = nodes.enter().append(\"g\").classed(className(\"node\"), true);\n  nodesEnter\n    .merge(nodes)\n    .attr('data-key', datumKey)\n    .classed(className(\"rootNode\"), (d) => d.depth === 0)\n    .classed(className(\"groupingNode\"), (d) => d.depth > 0 && d.height > 0)\n    .classed(className(\"containsSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount > 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"containsNoSearchResult\"), (d) => hasSearch && d.data.CRVIZ._searchResultCount === 0 && d.depth > 0 && d.height > 0)\n    .classed(className(\"searchResult\"), (d) => hasSearch && d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"isChanged\"), (d) => d.data.CRVIZ._isChanged && d.depth > 0 && d.height === 0)\n    .classed(className(\"isAdded\"), (d) => d.data.CRVIZ._isAdded && d.depth > 0 && d.height === 0)\n    .classed(className(\"isRemoved\"), (d) => d.data.CRVIZ._isRemoved && d.depth > 0 && d.height === 0)\n    .classed(className(\"searchExcluded\"), (d) => hasSearch && !d.data.CRVIZ._isSearchResult && d.depth > 0 && d.height === 0)\n    .classed(className(\"leafNode\"), (d) => d.height === 0)\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .attr(\"display\", (d) => !showNodes && d.height === 0 ? 'none' : null)\n    .order();\n\n  const circles = nodes.select(\"circle\").merge(nodesEnter.append(\"circle\"));\n\n  circles.attr(\"r\", (d) => d.r);\n\n  return [\n    nodes.merge(nodesEnter),\n  ];\n};\n\n/**\n * Calculate the d attribute of a path element representing the shape of the\n * label area (the partial circles at the bottom of the grouping nodes)\n */\n// const getLabelShape = (d) => {\n//   const top = d.r - d.labelSize;\n//   const radius = d.r;\n\n//   const startAngle = Math.PI / 2 + Math.acos(top / radius);\n//   const endAngle = Math.PI / 2 - Math.acos(top / radius);\n\n//   const shape = path();\n//   shape.arc(0, 0, radius, startAngle, endAngle, true);\n//   shape.closePath();\n//   return shape.toString();\n\n// }\n\nexport default appendCircles;\n","import { zoom, zoomTransform } from \"d3-zoom\";\nimport { event as d3Event } from \"d3-selection\";\nimport { zoomIdentity } from \"d3-zoom\";\n\nconst setupZoom = ({\n  zoomRoot,\n  transformRoot,\n  nodes,\n  showNodes,\n  width,\n  height,\n  packedData\n}) => {\n\n  const state = {\n    zoomTo: null,\n    zoomToTransform: null,\n    // Find the current zoom transform if any\n    transform: zoomTransform(zoomRoot.node())\n  };\n\n  const zoomBehavior = zoom();\n\n  zoomBehavior.on(\"zoom\", () => {\n    const event = d3Event;\n    state.transform = event.transform;\n    zoomToTransform(event.transform)\n  });\n\n  zoomRoot.call(zoomBehavior);\n\n  // Amount of space to leave around a node when zoomed into that node\n  // (as a fraction of the node diameter)\n  const viewPadding = 0.25;\n\n  const { r: rootR, x: rootX, y: rootY } = packedData;\n\n  const scaleExtent = [\n    Math.min(width, height) / (rootR * 2),\n    Math.min(width, height) / (packedData.leaves()[0].r * 2 * (1 + viewPadding))\n  ];\n\n  const translateExtent = [\n    [\n      rootX - width / 2 / scaleExtent[0] * 2,\n      rootY - height / 2 / scaleExtent[0] * 2\n    ],\n    [\n      rootX + width / 2 / scaleExtent[0] * 2,\n      rootY + height / 2 / scaleExtent[0] * 2\n    ]\n  ];\n\n  zoomBehavior.scaleExtent(scaleExtent).translateExtent(translateExtent);\n\n  // Assume everything is hidden by default.\n  //\n  // Note:\n  // This could have been done using inline style.\n  // The odd thing is, when using inline style, apparently each node's style is\n  // recalculated in every frame during zooming regardless of whether or not\n  // the inline style was changed.\n  //\n  // Using a class avoided this issue.\n  nodes.classed('viz-zoomMinutia', true);\n\n  function zoomToTransform(transform) {\n    transformRoot\n      .style(\"transform\", `translate(${ Math.floor(transform.x) }px, ${ Math.floor(transform.y) }px) scale(${ transform.k })`);\n\n    const bound = viewBound(width, height, transform);\n\n    const nodesInView = nodes.filter((d) => boundOverlap(bound, nodeBound(d)));\n\n    nodesInView\n      .call(hideSmall, transform)\n  };\n\n  function zoomTo(datum, animate = true) {\n    const size = datum.r * 2 * (1 + viewPadding);\n    const k = Math.min(width, height) / size;\n    const transform = zoomIdentity\n      .scale(k)\n      .translate(\n          - datum.x + width / 2 / k,\n          - datum.y + height / 2 / k,\n      );\n\n    zoomBehavior.transform(\n      !animate ? zoomRoot : zoomRoot.transition().duration(1000),\n      transform\n    );\n  }\n\n  if (state.transform) {\n    zoomToTransform(state.transform);\n  }\n\n  state.zoomTo = zoomTo;\n  state.zoomToTransform = zoomToTransform;\n\n  return state;\n};\n\nconst hideSmall = (nodes, transform) => {\n  const tooSmall = (d) => d.r * transform.k < 1;\n\n  nodes\n    .filter(\":not(.viz-zoomMinutia)\")\n    .filter((d) => tooSmall(d))\n    .classed(\"viz-zoomMinutia\", true);\n\n  nodes\n    .filter(\".viz-zoomMinutia\")\n    .filter((d) => !tooSmall(d))\n    .classed(\"viz-zoomMinutia\", false)\n};\n\n/**\n * The bound of the view given the original width, height, and transform\n */\nconst viewBound = (width, height, transform) => {\n  var size = Math.min(width, height);\n  var boundWidth = size * Math.max(width / height, 1);\n  var boundHeight = size * Math.max(height / width, 1);\n\n  var bound = [\n    -transform.x / transform.k,\n    -transform.y / transform.k,\n    (-transform.x + boundWidth) / transform.k,\n    (-transform.y + boundHeight) / transform.k\n  ];\n  return bound;\n};\n\nconst nodeBound = (datum) => [\n  datum.x - datum.r,\n  datum.y - datum.r,\n  datum.x + datum.r,\n  datum.y + datum.r\n];\n\nconst boundOverlap = (bound0, bound1) => {\n  return (\n    bound0[0] <= bound1[2] &&\n    bound0[2] >= bound1[0] &&\n    bound0[1] <= bound1[3] &&\n    bound0[3] >= bound1[1]\n  );\n};\n\nexport default setupZoom;\n","import { map, join, path } from \"ramda\";\nimport { select, event as d3Event } from \"d3-selection\";\n\nconst setupTooltip = ({ nodeRoot, tooltip, fields }) => {\n  tooltip\n    .style(\"display\", \"block\")\n    .style(\"position\", \"absolute\")\n    .style(\"transform\", null)\n    .style(\"top\", \"0px\")\n    .style(\"left\", \"0px\");\n\n  const boundingRect = tooltip.node().getBoundingClientRect();\n\n  const offsetLeft = -boundingRect.left + 5;\n  const offsetTop = -boundingRect.top + 5;\n\n  // Measurements need to be taken before hiding the tooltip, otherwise they are\n  // not accurate.\n  tooltip.style(\"display\", \"none\")\n\n  nodeRoot.on(\"mousemove\", () => {\n    const event = d3Event;\n    showTooltip(event, fields, offsetTop, offsetLeft, tooltip);\n\n  });\n};\n\nconst showTooltip = (event, fields, offsetTop, offsetLeft, tooltip) => {\n  const target = select(event.target);\n  const datum = target.datum();\n  const text = content(datum, fields);\n  if (text) {\n    tooltip.node().innerHTML = text;\n    tooltip\n      .style(\"display\", \"block\")\n      .style(\"transform\", `translate3d(${ event.x + offsetLeft + 1 }px, ${ event.y + offsetTop + 1 }px, 0)`)\n  } else {\n    tooltip.style(\"display\", \"none\");\n  }\n  //tooltip.classed(\"searchResult\", datum.data.isSearchResult);\n};\n\nconst content = (datum, fields) => {\n  if (datum.depth > 0 && datum.height > 0) {\n    let cont = `${ datum.data.fieldValue } (${datum.value})`;\n    if(datum.data.CRVIZ._searchResultCount > 0){\n      cont += `<br/><span>${datum.data.CRVIZ._searchResultCount} search results</span>`\n    }\n    return cont;\n  } else if (datum.height === 0) {\n    const pairs = map(\n      (field) => [`<strong>${ field.displayName }</strong>`, path(field.path, datum.data)],\n      fields\n    );\n    return map(join(\": \"), pairs).join(\"<br />\");\n  } else {\n    return null;\n  }\n};\n\nexport default setupTooltip;\n","import { times, concat } from \"ramda\";\nimport { scaleLinear, scalePow } from 'd3-scale';\nimport { hcl } from \"d3-color\";\n\nconst colorScheme = [\n  \"#a6cee3\",\n  \"#3366cc\",\n  \"#b2df8a\",\n  \"#33a02c\",\n  \"#fb9a99\",\n  \"#996699\",\n  \"#fdbf6f\",\n  \"#ff7f00\",\n  \"#cc99ff\",\n  \"#6a3d9a\",\n  \"#ffff99\",\n  \"#b15928\",\n  \"#ffcc99\",\n  \"#333399\"\n];\n\nconst extendColorScheme = (colorScheme, count) => {\n  const extraLayers = Math.floor(count / colorScheme.length);\n\n  if (extraLayers === 0) {\n    return colorScheme;\n  }\n\n  const extraColors = times((i) => {\n    const currentLayer = (i + colorScheme.length) / colorScheme.length;\n\n    const previous = hcl(colorScheme[i % colorScheme.length])\n    const neighbor = hcl(colorScheme[(i + 1) % colorScheme.length])\n\n    const hScale = scaleLinear()\n      .domain([0, extraLayers])\n      .range([previous.h, neighbor.h]);\n\n    const cScale = scalePow()\n      .exponent(5)\n      .domain([0, extraLayers])\n      .range([previous.c, 100]);\n\n    const lScale = scalePow()\n      .exponent(2)\n      .domain([0, extraLayers])\n      .range([previous.l, previous.l / 2]);\n\n    const h = hScale(currentLayer)\n    const c = cScale(currentLayer);\n    const l = lScale(currentLayer);\n\n    const nextColor = hcl(h, c, l);\n    return nextColor.toString();\n  }, count - colorScheme.length);\n\n  return concat(colorScheme, extraColors)\n}\n\nexport { colorScheme, extendColorScheme };\n","import { selectAll, select, event as d3Event } from 'd3-selection';\n\nimport {\n  contains,\n  either,\n  equals,\n  fromPairs,\n  toPairs,\n  identity,\n  map,\n  path,\n  pipe,\n  sortBy,\n  uniq,\n  zip\n} from \"ramda\";\n\nimport className from \"./class-name\";\nimport { colorScheme, extendColorScheme } from './color-scheme';\n\nfunction setupLegend({ legend, data, hierarchyConfig, coloredField, legendConfig }) {\n  if (!coloredField) {\n    legend.style(\"display\", \"none\");\n\n    const state = { nodes: [], annotations: [] }\n\n    function update({ nodes, annotations }) {\n      state.nodes = nodes;\n      nodes.classed('viz-coloredNode', coloredField);\n      if (!coloredField) {\n        nodes.select('circle').attr('class', null);  \n        return;\n      }\n    }\n\n    return { update };\n  } else {\n    legend.style(\"display\", null);\n  }\n\n  const getValue = either(path(coloredField.path), path([\"fieldValue\"]));\n\n  // If coloring groupings, don't color devices with the same value\n  const isColoringGroup = contains(coloredField, hierarchyConfig);\n\n  const values = pipe(\n    map(getValue),\n    uniq,\n    sortBy(identity)\n  )(data);\n\n  const scheme = extendColorScheme(colorScheme, values.length);\n\n  const configs = scheme.map((color, index) => {\n    return {\n      color,\n      disabled: false,\n      className: `legend-color-${index}`\n    }\n  });\n\n  const coloring = zip(values, configs);\n  const colorMap = fromPairs(coloring);\n\n  createStylesheet(coloring);\n\n  const state = { nodes: [] }\n\n  function update({ nodes, annotations }) {\n    state.nodes = nodes;\n    //state.annotations = annotations;\n    nodes.classed('viz-coloredNode', coloredField);\n    if (!coloredField) {\n      nodes.select('circle').attr('class', null);   \n      return;\n    }\n\n    colorNodes({ nodes, colorMap, getValue, coloredField, isColoringGroup });\n    colorAnnotations({ annotations, colorMap, getValue, coloredField, isColoringGroup })\n    updateLegend({ legend, colorMap, toggleValue })\n  }\n\n  function toggleValue(value) {\n    colorMap[value].disabled = !colorMap[value].disabled;\n    update({ nodes: state.nodes });\n  }\n\n  return { update, colorMap };\n}\n\nconst updateLegend = ({ legend, colorMap, toggleValue }) => {\n  const items = legend\n    .selectAll(\"p.viz-legendItem\")\n    .data(toPairs(colorMap), ([value]) => value );\n\n  items.exit().remove();\n\n  const itemsEnter = items.enter().append(\"p\").classed(\"viz-legendItem\", true)\n  itemsEnter.append(\"span\").classed(\"viz-legendColor\", true);\n  itemsEnter.append(\"span\").classed(\"viz-legendLabel\", true);\n\n  items.merge(itemsEnter)\n    .classed(\"viz-legendDisabled\", (d) => d[1].disabled);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendColor\")\n    .style(\"background-color\", ([value, { color }]) => color);\n\n  items.merge(itemsEnter)\n    .select(\".viz-legendLabel\")\n    .attr('title', ([value]) => value)\n    .text(([value]) => value);\n\n  legend.on('click.toggle', () => {\n    const datum = select(d3Event.target).datum();\n    if (datum) {\n      toggleValue(datum[0]);\n    }\n  })\n}\n\n/**\n * Having inline style trigger an expensive \"recalculate style\" in every frame\n * during zooming (even if the style attribute is empty!).\n *\n * We work around this by creating a style element that contains a class for\n * each item in the legend and assign those classes to each circle.\n*/\nconst createStylesheet = (coloring) => {\n  const style = selectAll('style#coloring').data([coloring]);\n  const styleEnter = style.enter().append('style').attr('id', 'coloring');\n\n  const html = coloring.map(([ value, { color, className } ], index) => {\n    return `\n      .viz-node circle.${className} {\n        fill: ${color} !important\n      }\n    `\n  }).join(\"\\n\");\n\n  style.merge(styleEnter)\n    .html(html)\n}\n\nconst colorNodes = ({ nodes, colorMap, getValue, coloredField, isColoringGroup }) => {\n  nodes\n    .filter((d) => d.height === 0)\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return !isColoringGroup && !disabled && className ? className : null\n    });\n\n  nodes\n    .filter((d) => d.height > 0)\n    .classed(\"viz-coloredNode\", (d) => {\n      const { disabled } = colorMap[getValue(d.data)] || {};\n      return !disabled &&\n        equals(d.data.field, coloredField) \n    })\n    .select(\"circle\")\n    .attr('class', (d) => {\n      const { disabled, className } = colorMap[getValue(d.data)] || {};\n      return isColoringGroup\n        && equals(d.data.field, coloredField)\n        && !disabled\n        && className;\n    });\n}\n\nconst colorAnnotations = ({ annotations, colorMap, getValue, coloredField, isColoringGroup }) => {\n  if(annotations){\n    annotations\n      .select(`g.${className(\"total-container\")}`)\n      .attr('class', (d) => {\n        const { disabled, className } = colorMap[getValue(d.data)] || {};\n        console.log(className)\n        return isColoringGroup\n          && equals(d.data.field, coloredField)\n          && !disabled\n          && className;\n      });\n  }\n  // nodes\n  //   .filter((d) => d.height > 0)\n  //   .classed(\"viz-coloredNode\", (d) => {\n  //     const { disabled } = colorMap[getValue(d.data)] || {};\n  //     return !disabled &&\n  //       equals(d.data.field, coloredField) \n  //   })\n  //   .select(\"circle\")\n  //   .attr('class', (d) => {\n  //     const { disabled, className } = colorMap[getValue(d.data)] || {};\n  //     return isColoringGroup\n  //       && equals(d.data.field, coloredField)\n  //       && !disabled\n  //       && className;\n  //   });\n}\n\nexport default setupLegend;\n","import { selectAll } from \"d3\";\n\nimport datumKey from \"./datum-key\";\nimport className from \"./class-name\";\n\nconst setupAnnotations = ({packedData, annotationRoot}) =>{\n  //sum up change counts because we only are interested in groups that have changes to display\n  const data = packedData.descendants().filter(d => d.depth > 0 && d.height > 0 \n    && d.data.CRVIZ && (d.data.CRVIZ[\"_addedCount\"] + d.data.CRVIZ[\"_changedCount\"] + d.data.CRVIZ[\"_removedCount\"]) > 0);\n  const firstLeaf = packedData.descendants().filter(d => d.height === 0)[0];\n  const leafRadius = firstLeaf.r || 0;\n  const fontScale = ((2*leafRadius)/16) *100;\n  const annotations = annotationRoot\n    .selectAll(`g.${className(\"annotation\")}`)\n    .data(data, datumKey);\n\n  annotations.exit().remove();\n\n  const annotationsEnter = annotations.enter().append(\"g\")\n  .classed(className(\"annotation\"), true);\n\n  const baseAngle = -60 * (Math.PI/180);\n  annotationsEnter\n    .merge(annotations)\n    .attr('data-key', datumKey)\n    .attr(\"transform\", (d) => `translate(${[d.x, d.y].join(\",\")})`)\n    .order();\n\n  //changed nodes indicator\n  const newChangeIconContainer = annotationsEnter\n    .append('g')\n      .classed(className(\"change-icon-container\"), true);\n  const newChangeIcon = newChangeIconContainer\n  .append('text')\n    .classed('svg-icon', true)\n    .style('font-size', (d) => fontScale +\"%\")\n    .text('\\uf005');\n    // .append('g')\n    //   .classed(className(\"isChanged-fixed\"), true)\n    // .append('circle')\n    //   .attr('r', leafRadius);\n\n  annotations\n  .select(`g.${className(\"change-icon-container\")}`)\n  .select('text.svg-icon')\n  // .select(`g.${className(\"isChanged-fixed\")}`)\n  // .select('circle')\n  .merge(newChangeIcon)\n    .attr('x', (d) => (d.r * Math.cos(baseAngle)))\n    .attr('y', (d) => (d.r * Math.sin(baseAngle)))\n    .on(\"click\", (d) => {\n      const annotation = selectAll(`g.${className(\"annotation\")}[data-key=\"${datumKey(d)}\"]`);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n        .classed(className(\"annotation-hidden\"), true);\n\n      annotation\n      .select(`g.${className(\"ring-menu\")}`)\n        .classed(className(\"annotation-hidden\"), false);\n\n    })\n\n\n  //ring menu\n  const newRingMenu = annotationsEnter\n    .append('g')\n      .classed(className(\"ring-menu\"), true)\n      .classed(className(\"annotation-hidden\"), true);\n\n  const newBgCircles = newRingMenu\n    .append('circle')\n      .classed('bg-circle', true)\n      .style('fill', 'white')\n      .attr('r', 6*leafRadius)\n\n  annotations\n  .select(`g.${className(\"ring-menu\")}`)\n  .select('circle')\n  .merge(newBgCircles)\n    .attr('cx', (d) => (d.r * Math.cos(baseAngle)))\n    .attr('cy', (d) => (d.r * Math.sin(baseAngle)));\n\n  const newX = newRingMenu\n  .append('text')\n    .classed('svg-icon', true)\n    .text('\\uf00d');\n\n  annotations\n  .select(`g.${className(\"ring-menu\")}`)\n  .select('text.svg-icon')\n  .merge(newX)\n    .attr('x', (d) => d.r * Math.cos(baseAngle))\n    .attr('y', (d) => (d.r * Math.sin(baseAngle)))\n    .style('font-size', (d) => fontScale +\"%\")\n    .on(\"click\", (d) => {\n      const annotation = selectAll(`g.${className(\"annotation\")}[data-key=\"${datumKey(d)}\"]`);\n\n      annotation\n      .select(`g.${className(\"change-icon-container\")}`)\n        .classed(className(\"annotation-hidden\"), false);\n\n      annotation\n      .select(`g.${className(\"ring-menu\")}`)\n        .classed(className(\"annotation-hidden\"), true);\n    });\n\n  //Icons inside ring menu  \n  //totals \n  const newTotalContainer = newRingMenu\n    .append('g')\n      .classed(className(\"total-container\"), true);;\n  const newCircles = newTotalContainer\n    .append('g')\n      .classed(className(\"leafNode\"), true)\n    .append('circle')\n      .attr('r', leafRadius)\n\n  annotations\n  .select(`g.${className(\"total-container\")}`)\n  .select(`g.${className(\"leafNode\")}`)\n  .select('circle')\n  .merge(newCircles)\n    .attr('cx', (d) => (d.r * Math.cos(baseAngle)) - 2*leafRadius)\n    .attr('cy', (d) => (d.r * Math.sin(baseAngle)) - 3*leafRadius);\n\n  const newTotalText = newTotalContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true);\n\n  annotations\n  .select(`g.${className(\"total-container\")}`)\n  .select('text')\n  .merge(newTotalText)\n    .style('font-size', (d) => fontScale +\"%\")\n    .attr('x', (d) => (d.r * Math.cos(baseAngle)) + 1.5*leafRadius)\n    .attr('y', (d) => (d.r * Math.sin(baseAngle)) - 3*leafRadius)\n    .text((d) => !isNaN(d.value) ? \": \" + d.value : \": 0\");\n\n  //added nodes\n  const newAddedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"added-container\"), true);;\n  const newPluses = newAddedContainer\n    .append('g')\n      .classed(className(\"isAdded-fixed\"), true)\n    .append('circle')\n      .attr('r', leafRadius)\n\n  annotations\n  .select(`g.${className(\"added-container\")}`)\n  .select(`g.${className(\"isAdded-fixed\")}`)\n  .select('circle')\n  .merge(newPluses)\n    .attr('cx', (d) => (d.r * Math.cos(baseAngle)) - 4.5*leafRadius)\n    .attr('cy', (d) => (d.r * Math.sin(baseAngle)));\n\n  const newAddedText = newAddedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true);\n\n  annotations\n  .select(`g.${className(\"added-container\")}`)\n  .select('text')\n  .merge(newAddedText)\n    .style('font-size', (d) => fontScale +\"%\")\n    .attr('x', (d) => (d.r * Math.cos(baseAngle)) - 2.5*leafRadius)\n    .attr('y', (d) => (d.r * Math.sin(baseAngle)))\n    .text((d) => !isNaN(d.data.CRVIZ[\"_addedCount\"]) ? \": \" + d.data.CRVIZ[\"_addedCount\"] : \": 0\");\n\n  //changed nodes\n  const newChangedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"changed-container\"), true);;\n  const newDeltas = newChangedContainer\n    .append('g')\n      .classed(className(\"isChanged-fixed\"), true)\n    .append('circle')\n      .attr('r', leafRadius)\n\n  annotations\n  .select(`g.${className(\"changed-container\")}`)\n  .select(`g.${className(\"isChanged-fixed\")}`)\n  .select('circle')\n  .merge(newDeltas)\n    .attr('cx', (d) => (d.r * Math.cos(baseAngle)) - 1*leafRadius)\n    .attr('cy', (d) => (d.r * Math.sin(baseAngle)) + 3*leafRadius);\n\n  const newChangedText = newChangedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true);\n\n  annotations\n  .select(`g.${className(\"changed-container\")}`)\n  .select('text')\n  .merge(newChangedText)\n    .style('font-size', (d) => fontScale +\"%\")\n    .attr('x', (d) => (d.r * Math.cos(baseAngle)) + 1.5*leafRadius)\n    .attr('y', (d) => (d.r * Math.sin(baseAngle)) + 3*leafRadius)\n    .text((d) => !isNaN(d.data.CRVIZ[\"_changedCount\"]) ? \": \" + d.data.CRVIZ[\"_changedCount\"] : \": 0\");\n\n  //removed nodes\n  const newRemovedContainer = newRingMenu\n    .append('g')\n      .classed(className(\"removed-container\"), true);;\n  const newMinuses = newRemovedContainer\n    .append('g')\n      .classed(className(\"isRemoved-fixed\"), true)\n    .append('circle')\n      .attr('r', leafRadius)\n\n  annotations\n  .select(`g.${className(\"removed-container\")}`)\n  .select(`g.${className(\"isRemoved-fixed\")}`)\n  .select('circle')\n  .merge(newMinuses)\n    .attr('cx', (d) => (d.r * Math.cos(baseAngle)) + 2.5*leafRadius)\n    .attr('cy', (d) => (d.r * Math.sin(baseAngle)));\n\n  const newRemovedText = newRemovedContainer\n  .append(\"text\")\n    .classed(className(\"annotation-text\"), true);\n\n  annotations\n  .select(`g.${className(\"removed-container\")}`)\n  .select('text')\n  .merge(newRemovedText)\n    .style('font-size', (d) => fontScale +\"%\")\n    .attr('x', (d) => (d.r * Math.cos(baseAngle)) + 4.5*leafRadius)\n    .attr('y', (d) => (d.r * Math.sin(baseAngle)))\n    .text((d) => !isNaN(d.data.CRVIZ[\"_removedCount\"]) ? \": \" + d.data.CRVIZ[\"_removedCount\"] : \": 0\");\n\n  return annotations.merge(annotationsEnter);\n}\n\n// const getAngleOfLeafNodeDiameter = (radius, offsetIncrement) => {\n//   const c = 2*radius*Math.PI;\n//   const ratio = (2*offsetIncrement)/c;\n//   return ratio*2*Math.PI;\n// }\n\nexport default setupAnnotations;","import { select, event as d3Event } from \"d3-selection\";\n\nimport { ResizeSensor } from \"css-element-queries\";\nimport debounce from \"lodash.debounce\";\n\nimport {\n  allPass,\n  eqProps,\n  eqBy,\n  find,\n  map,\n  reduce,\n  reduceWhile,\n  reduced,\n  reverse,\n  tail\n} from \"ramda\";\n\nimport packWithLabel from \"./d3-viz/pack-with-label\";\nimport toHierarchy from \"./d3-viz/to-hierarchy\";\nimport appendCircles from \"./d3-viz/append-circles\";\nimport setupZoom from \"./d3-viz/setup-zoom\";\nimport setupTooltip from \"./d3-viz/setup-tooltip\";\nimport setupLegend from \"./d3-viz/setup-legend\";\nimport setupAnnotations from \"./d3-viz/setup-annotations\";\nimport datumKey from \"./d3-viz/datum-key\";\n\nfunction d3Viz(rootNode) {\n  const root = select(rootNode);\n  // const width = rootNode.clientWidth;\n  // const height = rootNode.clientHeight;\n\n  /**\n   * Stationary div that receive mouse events for zooming.\n   */\n  const zoomRoot = root\n    .append(\"div\")\n    .attr(\"data-node\", \"zoomRoot\")\n    .style(\"position\", \"relative\")\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  root.style(\"position\", \"relative\");\n\n  /**\n   * The container that is scaled and transformed.\n   *\n   * Use a div with CSS 3D transform to get hardware acceleration.\n   * SVG transform are not hardware accelerated.\n   */\n  const transformRoot = zoomRoot\n    .append(\"div\")\n    .attr(\"data-node\", \"transformRoot\")\n    .style(\"position\", \"absolute\")\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\")\n    .style(\"transform-origin\", \"top left\");\n\n  /**\n   * Label are placed in a separate element so that they are not scaled\n   * together with the circles.\n   */\n  const labelRoot = zoomRoot\n    .append(\"svg\")\n    .style(\"position\", \"absolute\")\n    .style(\"pointer-events\", \"none\") // Let the underlying circles get mouse events.\n    .style(\"top\", 0)\n    .style(\"left\", 0)\n    .style(\"width\", \"100%\")\n    .style(\"height\", \"100%\");\n\n  const svg = transformRoot.append(\"svg\")\n                           .style(\"overflow\", \"visible\")\n                           .attr(\"class\", \"nodeRoot\");\n\n  const tooltip = root.append(\"div\").classed(\"viz-tooltip\", true);\n  const legend = root.append(\"div\").classed(\"viz-legend\", true);\n\n  const nodeRoot = svg.append(\"g\");\n\n  const annotationRoot = svg.append(\"g\").attr(\"class\", \"annotation-root\")\n\n\n  // State\n  let props = {\n    hierarchyConfig: null,\n    data: null,\n    fields: null,\n    width: rootNode.clientWidth,\n    height: rootNode.clientHeight,\n    showNodes: true,\n    coloredField: null,\n    queryString: ''\n  };\n\n  const state = {\n    packedData: null,\n    nodes: null,\n    annotations: null,\n    labels: null,\n    countLabels: null,\n    zoom: null,\n    selectedNode: null,\n    legend: null\n  };\n\n  new ResizeSensor(rootNode, debounce(() => update(props), 100));\n\n  function update(nextProps) {\n    nextProps = {\n      ...nextProps,\n      width: rootNode.clientWidth,\n      height: rootNode.clientHeight,\n      hasSearch: nextProps.hasSearch\n    };\n\n    const dataUpdated = !allEqProps(\n      [\"hierarchyConfig\", \"data\", \"fields\", \"queryString\"],\n      props,\n      nextProps\n    );\n\n    const sizeUpdated = !allEqProps([\"width\", \"height\"], props, nextProps);\n\n    const legendUpdated = !allEqProps([\"coloredField\", \"hierarchyConfig\", \"data\"], props, nextProps);\n\n    props = nextProps;\n\n    if (dataUpdated) {\n      repack(props, state);\n      resetAnnotations(props, state);\n    }\n\n    rerender(props, state);\n\n    if (legendUpdated) {\n      resetLegend(props, state);\n    } else {\n      state.legend && state.legend.update({ nodes: state.nodes })\n    }\n\n    if (sizeUpdated || dataUpdated) {\n      resetZoom(props, state);\n    }\n  }\n\n  const repack = (props, state) => {\n    const hierarchy = makeHierarchy(props.data, props.hierarchyConfig);\n\n    const pack = packWithLabel().size([props.width, props.height]);\n\n    // Pack once without padding to calculate the radius of the leaf node\n    // then repack with new padding, similar to how d3-pack\n    // works when the size is not given.\n    //\n    // This way spacing between leaf nodes is consistent between visualizations.\n    //\n    // Doesn't seem to have a noticable performance impact.\n    const packed = pack(hierarchy);\n    const padding = packed.leaves()[0].r;\n    pack.padding((d) => padding * d.height);\n\n    state.packedData = pack(hierarchy);\n  };\n\n  const rerender = (props, state) => {\n    const [nodes] = appendCircles({\n      nodeRoot: nodeRoot,\n      labelRoot: labelRoot,\n      packedData: state.packedData,\n      showNodes: props.showNodes,\n      hasSearch: props.queryString !== ''\n    });\n\n    setupTooltip({\n      tooltip: tooltip,\n      fields: props.fields,\n      nodeRoot: nodeRoot\n    });\n\n    state.nodes = nodes;\n  };\n\n  const resetLegend = (props, state) => {\n    state.legend = setupLegend({\n      legend: legend,\n      hierarchyConfig: props.hierarchyConfig,\n      data: props.data,\n      coloredField: props.coloredField\n    });\n\n    if(state.legend != null){\n      state.legend.update({ nodes: state.nodes, annotations: state.annotations })\n    }\n  };\n\n  const resetZoom = (props, state) => {\n    state.zoom = setupZoom({\n      zoomRoot: zoomRoot,\n      transformRoot: transformRoot,\n      nodes: state.nodes,\n      width: props.width,\n      height: props.height,\n      packedData: state.packedData\n    });\n\n    let animate = true;\n\n    if (state.selectedNode) {\n      const selected = findAncestor(state.selectedNode, state.packedData);\n      state.selectedNode = selected;\n      animate = false; // smarter animation??\n    } else {\n      state.selectedNode = state.packedData;\n    }\n\n    state.zoom.zoomTo(state.selectedNode, animate);\n\n    nodeRoot.on(\"click.select\", () => {\n      const datum = select(d3Event.target).datum();\n      let zoomToNode = datum;\n      if(datum.height === 0 && datum.parent){\n        zoomToNode = datum.parent;\n      }\n      state.selectedNode = datum;\n      state.zoom.zoomTo(zoomToNode);\n    });\n  };\n\n  const resetAnnotations = (props, state) =>{\n    state.annotations = setupAnnotations({\n      packedData: state.packedData,\n      annotationRoot: annotationRoot,\n    })\n  };\n\n  return {\n    update\n  };\n}\n\nconst allEqProps = (props, o1, o2) => allPass(map(eqProps, props))(o1, o2);\n\nconst makeHierarchy = (data, hierarchyConfig) => {\n  const hierarchy = toHierarchy(data, hierarchyConfig).count();\n\n  const byUnknown = (a, b) => {\n    if (a.data.fieldValue === \"Unknown\") {\n      return b.data.fieldValue === \"Unknown\" ? 0 : 1;\n    } else {\n      return b.data.fieldValue === \"Unknown\" ? -1 : 0;\n    }\n  };\n\n  const bySize = (a, b) => (b.value || 0) - (a.value || 0);\n  const byName = (a, b) =>\n    (a.data.fieldValue || \"\").localeCompare(b.data.fieldValue || \"\");\n\n  return hierarchy.sort(composeComparators([byUnknown, bySize, byName]));\n};\n\n/**\n * Combine a list of comparator function ( (a, b) => Boolean )\n * in order into a single comparator.\n */\nconst composeComparators = (comparators) => (a, b) =>\n  reduceWhile(\n    (result) => result === 0, // keep comparing while a === b\n    (_, comparator) => comparator(a, b),\n    0,\n    comparators\n  );\n\n/**\n * Find the lowest ancestors of a node (or it self) that exists in a tree.\n */\nconst findAncestor = (node, hierarchy) => {\n  const path = reverse(node.ancestors());\n  const findChild = (parent, child) => {\n    return find(eqBy(datumKey, child), parent.children || []);\n  };\n\n  const res = reduce(\n    (last, child) => findChild(last, child) || reduced(last),\n    hierarchy,\n    tail(path)\n  );\n  return res;\n};\n\nexport default d3Viz;\n","import React from \"react\";\nimport ReactDOM from 'react-dom';\n\nimport { connect } from \"react-redux\";\n\nimport { selectDatasetIntersection, selectMergedConfiguration } from \"domain/dataset\";\nimport { getQueryString } from \"epics/index-dataset-epic\";\nimport { selectControls } from \"domain/controls\";\n\nimport d3Viz from './d3-viz';\nimport styles from './Visualization.module.css';\n\nclass Visualization extends React.PureComponent {\n\n  componentDidMount() {\n    const el = ReactDOM.findDOMNode(this);\n    this.viz = d3Viz(el);\n    this.updateFromProps();\n  }\n\n  updateFromProps() {\n    this.viz.update({\n      hierarchyConfig: this.props.controls.hierarchyConfig,\n      fields: this.props.configuration.fields || [],\n      showNodes: this.props.controls.shouldShowNodes,\n      coloredField: this.props.controls.colorBy,\n      data: this.props.dataset || [],\n      queryString: this.props.queryString\n    });\n  }\n\n  componentDidUpdate() {\n    this.updateFromProps();\n  }\n\n  render() {\n    return <div className={ styles.viz }></div>;\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  return {\n    dataset: selectDatasetIntersection(state, ownProps.startUid, ownProps.endUid),\n    configuration: selectMergedConfiguration(state),\n    controls: selectControls(state),\n    queryString: getQueryString(state)\n  };\n};\n\nexport default connect(mapStateToProps, null)(Visualization);\n","import { createAction } from 'redux-actions';\nimport { ofType } from 'redux-observable';\nimport {  timer, of } from 'rxjs';\nimport { mergeMap, takeUntil, debounceTime } from 'rxjs/operators';\n\nimport { setIsFetching } from \"domain/dataset\";\nimport { fetchDataset } from './fetch-dataset-epic';\n\n// ACTIONS\nconst startRefresh = createAction('START_REFRESH_DATASET');\nconst stopRefresh = createAction('STOP_REFRESH_DATASET');\n\n// EPIC\nconst refreshDatasetEpic = (action$, store) => {\n  return action$.pipe(\n    ofType(startRefresh.toString())\n    ,debounceTime(500)\n    ,mergeMap((action) => {\n      const owner = action.payload.owner\n      const url = action.payload.url;\n      const header = action.payload.header;\n      const interval = action.payload.interval * 1000;\n      return timer(0, interval).pipe(\n          mergeMap(() => {\n            return of(\n              setIsFetching({'owner': owner, 'isFetching': true})\n              ,fetchDataset({'owner': owner, 'url': url, 'header':header})\n            )\n          })\n        ,takeUntil(action$.ofType(stopRefresh.toString()))\n        )\n    })  \n  );\n}\n\nexport default refreshDatasetEpic;\nexport { startRefresh, stopRefresh };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { isNil, find, propEq } from \"ramda\";\n\nfunction DatasetSelector({ className, selected, datasets, onChange }) {\n  return (\n    <div className={className}>\n      <label className=\"select\">\n      <select\n        onChange={(evt) => onChange(find(eqUrl(evt.target.value), datasets)) }\n        value={isNil(selected) ? \"\" : selected.url}\n      >\n        <option value=\"\">&mdash;None&mdash;</option>\n        {datasets.map((dataset) => {\n          return (\n            <option key={dataset.url} value={dataset.url}>\n              {dataset.name}\n            </option>\n          );\n        })}\n      </select>\n      </label>\n    </div>\n  );\n}\n\nconst eqUrl = propEq(\"url\");\n\nconst PropTypesDataset = PropTypes.shape({\n  name: PropTypes.string.isRequired,\n  url: PropTypes.string.isRequired\n});\n\nDatasetSelector.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypesDataset,\n  datasets: PropTypes.arrayOf(PropTypesDataset).isRequired,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetSelector;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { isNil } from \"ramda\";\n\nimport { FontAwesomeIcon }from \"@fortawesome/react-fontawesome\";\nimport { faUpload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetUpload({ className, selected, onChange, ownerUuid }) {\n  const inputId = \"file-input-\" + ownerUuid;\n  return (\n    <span className={ className }>\n      <input\n        type=\"file\"\n        id={inputId}\n        value=''\n        style={{'display':'none'}}\n        onChange={(evt) => onChange(evt.target.files[0])}\n      />\n\n    <span>\n      { isNil(selected) ? \"No file selected\" : selected }\n    </span>\n\n      <label htmlFor={inputId} className=\"button circular\" title=\"Upload data from file\">\n        <FontAwesomeIcon icon={faUpload} />\n      </label>\n    </span>\n  );\n}\n\nDatasetUpload.propTypes = {\n  ownerUuid: PropTypes.string.isRequired,\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  onChange: PropTypes.func.isRequired\n};\n\nexport default DatasetUpload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faDownload } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetDownload({ className, selected, url, disabled }) {\n  return (\n    <span className={ className }>\n      <a className=\"button circular\" href={ url } download={ selected + \".json\" }\n        title=\"Download\" disabled={disabled} >\n        <FontAwesomeIcon icon={faDownload} />\n      </a>\n    </span>\n  );\n}\n\nDatasetDownload.propTypes = {\n  className: PropTypes.string,\n  selected: PropTypes.string,\n  url: PropTypes.string\n};\n\nexport default DatasetDownload;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faRedoAlt } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetRefresh({ className, onClick, disabled }) {\n  return (\n    <span className={ className }>\n      <div className=\"button circular\" disabled={disabled} title=\"Refresh\" onClick={() => onClick()}>\n        <FontAwesomeIcon icon={faRedoAlt} />\n      </div>\n    </span>\n  );\n}\n\nDatasetRefresh.propTypes = {\n  className: PropTypes.string,\n  onClick: PropTypes.func.isRequired\n};\n\nexport default DatasetRefresh;\n","import React from \"react\";\nimport PropTypes from 'prop-types';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faSyncAlt,faStopCircle } from \"@fortawesome/free-solid-svg-icons\";\n\nfunction DatasetTimedRefresh({ className, interval, timerIsRunning, disabled, onIntervalChange, onStartClick, onStopClick }) {\n  return (\n    <span className={ className }>\n      <input type='text' title=\"Refresh interval in seconds\" value={interval} onChange={(evt) => onIntervalChange(evt.target.value)}/>\n      {!timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Start Refresh Timer\" onClick={() => onStartClick()}>\n\t        <FontAwesomeIcon icon={faSyncAlt} />\n\t      </div>\n  \t  }\n  \t  {timerIsRunning && \n\t      <div className=\"button circular\" disabled={disabled} title=\"Stop Refresh Timer\" onClick={() => onStopClick()}>\n\t        <FontAwesomeIcon icon={faStopCircle} />\n\t      </div>\n  \t  }\n    </span>\n  );\n}\n\nDatasetTimedRefresh.propTypes = {\n  className: PropTypes.string,\n  interval: PropTypes.number,\n  timerIsRunning: PropTypes.bool,\n  onIntervalChange: PropTypes.func.isRequired,\n  onStartClick: PropTypes.func.isRequired,\n  onStopClick: PropTypes.func.isRequired\n};\n\nexport default DatasetTimedRefresh;\n","import clonedeep from \"lodash.clonedeep\";\n\nconst getDataToExport = (datasets, keyFields, ignoredFields, controls) => {\n\tlet exportData = {};\n\n\tif(datasets)\n\t\texportData[\"datasets\"] = sanitizeForExport(datasets);\n\n\tif(keyFields)\n\t\texportData[\"keyFields\"] = keyFields;\n\n\tif(ignoredFields)\n\t\texportData[\"ignoredFields\"] = ignoredFields;\n\n\tif(controls)\n\t\texportData[\"controls\"] = controls;\n\n\treturn exportData;\n}\n\nconst sanitizeForExport = (datasets) =>{\n\tlet result = clonedeep(datasets);\n\tObject.keys(result).forEach((key) => {\n\t\tresult[key].dataset.forEach((item) => {\n\t\t\tdelete item.CRVIZ;\n\t\t});\n\t});\n\treturn result;\n}\n\nexport default getDataToExport;\nexport { getDataToExport };","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { connect } from \"react-redux\";\nimport { isNil } from \"ramda\";\nimport Modal from 'react-modal';\n\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faCheck, faTimes, faCog } from \"@fortawesome/free-solid-svg-icons\";\n\nimport { fetchDataset, buildAuthHeader } from \"epics/fetch-dataset-epic\";\nimport { startRefresh, stopRefresh } from \"epics/refresh-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport { showNodes, setHierarchyConfig, colorBy, selectControls } from \"domain/controls\"\n\nimport { setError } from \"domain/error\"\nimport { \n  setDataset, selectDataset, selectDatasets, removeDataset, \n  getIsFetching, setIsFetching, getLastUpdated, getKeyFields,\n  getIgnoredFields\n} from \"domain/dataset\";\n\nimport DatasetSelector from \"./DatasetSelector\";\nimport DatasetUpload from \"./DatasetUpload\";\nimport DatasetDownload from \"./DatasetDownload\";\nimport DatasetRefresh from \"./DatasetRefresh\";\nimport DatasetTimedRefresh from \"./DatasetTimedRefresh\";\nimport { getDataToExport } from \"./export\"\n\nimport style from \"./DatasetControls.module.css\";\n\nconst uuidv4 = require('uuid/v4');\n\nconst CUSTOM_DATASET = {\n  name: \"Custom URL\",\n  url: \"custom-url\"\n};\n\nconst authTypes = [\n  {'name': '-None-', 'scheme':'None' },\n  {'name': 'Username\\\\Password', 'scheme':'Basic' },\n  {'name': 'Token', 'scheme':'Bearer' },\n];\n\nvar host = window.location.host;\nvar hostname = window.location.hostname;\nvar port = '80';\nconst radix = 10;\nif (host.indexOf(':') > -1) {\n  port = String(parseInt(host.split(\":\")[1], radix)-1);\n}\n\nvar POSEIDON_DATASET = {\n  name: \"Poseidon Network\",\n  url: \"http://\"+hostname+\":\"+port+\"/v1/network\"\n};\n\nModal.setAppElement('#root');\n\nclass DatasetControls extends React.Component {\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      dataset: null,\n      selected: null,\n      selectedFile: null,\n      showUrlEntry: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n      refreshInterval: 0,\n      refreshTimerRunning: false\n    };\n  }\n\n  resetDataset = () => {\n    this.props.setDataset({ dataset: [], configuration: {} });\n    this.setState({\n      selected: null,\n      selectedFile: null\n    });\n  }\n\n  fetchAndSetDataset = (url, dataset, username, password, token) => {\n    this.props.setIsFetching({owner: this.props.uuid, isFetching: true});\n    const authHeader = buildAuthHeader(username, password, token);\n    if (toURL(url)) {\n      this.props.fetchDataset({ 'owner': this.props.uuid, 'url': url, 'header': authHeader });\n      this.setState({\n        selected: dataset,\n        selectedFile: null,\n      });\n    } else {\n      this.props.setError(new Error(\"Please enter a valid URL.\"));\n    }\n  }\n\n  onSelected = (dataset) => {\n    if (isNil(dataset)) {\n      return this.resetDataset();\n    }\n\n    this.props.removeDataset({owner: this.props.uuid});\n    this.props.removeSearchIndex({owner: this.props.uuid});\n    this.props.stopRefresh();\n\n    const showUrlEntry = dataset === CUSTOM_DATASET;\n    this.setState({ \n      showUrlEntry: showUrlEntry,\n      url: '',\n      authScheme:null,\n      token: '',\n      username: '',\n      password: '',\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n     });\n    if(!showUrlEntry)\n    {\n      const url = dataset.url;\n      this.fetchAndSetDataset(url, dataset, null, null, null);\n    }\n  }\n\n  onUpload = (file) => {\n    this.props.uploadDataset({ \n      'owner': this.props.uuid, \n      'file': file,\n      'includeData': true,\n      'includeControls': false,\n    });\n    this.props.stopRefresh();\n    this.setState({\n      selected: null,\n      selectedFile: file.name,\n      refreshInterval: 0,\n      refreshTimerRunning: false,\n    });\n  }\n\n  onUrlChange = (evt) => {\n    this.setState({ url: evt.target.value });\n  }\n\n  onTokenChange = (evt) => {\n    this.setState({ token: evt.target.value });\n  }\n\n  onUsernameChange = (evt) => {\n    this.setState({ username: evt.target.value });\n  }\n\n  onPasswordChange = (evt) => {\n    this.setState({ password: evt.target.value });\n  }\n\n  onUrlOk = () => {\n    this.setState({ showUrlEntry: false });\n    const dataset = CUSTOM_DATASET;\n    if(!isNil(this.state.url))\n    {\n      const url = this.state.url;\n      dataset.url = url;\n      this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n    }\n  }\n\n  onUrlCancel = () => {\n    this.setState({ \n      showUrlEntry: false,\n      url: '',\n      authScheme:'',\n      token: '',\n      username: '',\n      password: '',\n     });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.props.fullDatasets;\n    const controls = this.props.controls;\n    const keyFields = this.props.keyFields;\n    const ignoredFields = this.props.ignoredFields;\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(getDataToExport(datasets, keyFields, ignoredFields, controls));\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  onRefresh = () =>{\n    const url = this.state.selected.url;\n    const dataset = this.state.selected;\n    this.fetchAndSetDataset(url, dataset, this.state.username, this.state.password, this.state.token);\n  }\n\n  onTimedRefreshStart = () =>{\n    this.props.setIsFetching({'owner': this.props.uuid, 'isFetching': true});\n    this.setState({\n      'refreshTimerRunning': true\n    });\n    const authHeader = buildAuthHeader(this.state.username, this.state.password, this.state.token);\n    const url = this.state.selected.url;\n    const interval = this.state.refreshInterval;\n    this.props.startRefresh({'owner': this.props.uuid,'url': url, 'header': authHeader, 'interval': interval});\n  }\n\n  onTimedRefreshStop = () =>{\n    this.setState({\n      'refreshTimerRunning': false\n    });\n    this.props.stopRefresh();\n  }\n\n  onTimedRefreshIntervalChanged = (interval) =>{\n    const numInt = parseInt(interval, 10);\n    if(!isNaN(numInt)){\n      this.setState({\n        refreshInterval: numInt,\n      });\n    }\n    else if(!interval){\n      this.setState({\n        refreshInterval: null,\n      });\n    }\n  }\n\n  render() {\n    if (port === '80') {\n      POSEIDON_DATASET = {name:\"\",url:\"\"};\n    }\n    const canDownload = this.state.selected && !this.state.selectedFile;\n    const canRefresh = this.state.selected && !isNil(this.state.selected.url)\n    return (\n      <div className={style.dataControls}>\n        <div className={style.selectorContainer}>\n          <span className={style.label}>Dataset</span>\n          <DatasetSelector\n            className={style.selector}\n            selected={this.state.selected}\n            onChange={this.onSelected}\n            datasets={[...this.props.datasets, POSEIDON_DATASET, CUSTOM_DATASET]}\n          />\n        </div>\n\n        <div className={style.uploadContainer}>\n          <span className={style.label}>Upload</span>\n          <DatasetUpload\n            ownerUuid={this.props.uuid}\n            className={style.fileUpload}\n            selected={this.state.selectedFile}\n            onChange={this.onUpload}\n          />\n        </div>\n\n          <div className={style.utilityContainer}>\n          { canDownload &&\n            <DatasetDownload\n              className={style.fileDownload}\n              selected={this.state.selected.name}\n              url={this.getDownloadUrl()}\n              disabled={this.props.isFetching}\n            />\n          }\n          { canRefresh &&\n            <div className={style.urlRefreshContainer}>\n              <DatasetRefresh\n                className={style.urlRefresh}\n                onClick={this.onRefresh}\n                disabled={this.props.isFetching}\n              />\n              <DatasetTimedRefresh\n                className={style.urlRefresh}\n                interval={this.state.refreshInterval}\n                timerIsRunning={this.state.refreshTimerRunning}\n                disabled={this.props.isFetching}\n                onIntervalChange={this.onTimedRefreshIntervalChanged}\n                onStartClick={this.onTimedRefreshStart}\n                onStopClick={this.onTimedRefreshStop}\n              />\n            </div>\n          }\n          </div>\n          <div className={style.urlRefreshTime}>\n            { canRefresh && this.props.isFetching &&\n              <span>\n                <FontAwesomeIcon className=\"fa-spin\" icon={faCog} /> Fetching Data...\n              </span>\n            }\n            { canRefresh && !this.props.isFetching &&\n              <span>\n                Last Updated: { this.props.lastUpdated ? (this.props.lastUpdated.toLocaleDateString() || \"\") + \" \" + (this.props.lastUpdated.toLocaleTimeString() || \"\") : \"Never\" }\n              </span>\n            }\n          </div>\n          <Modal isOpen={ this.state.showUrlEntry } onRequestClose={this.onUrlCancel} contentLabel=\"Enter a Url\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span>\n                  <label> URL </label>\n                  <input type=\"text\" value={this.state.url} onChange={ this.onUrlChange }/>\n                </span>\n                <span>\n                  <label> AuthType </label>\n                  <select\n                    onChange={(evt) => this.setState({ authScheme: evt.target.value })}\n                    value={isNil(this.state.authScheme) ? '' : this.state.authScheme}\n                  >\n                    {authTypes.map((at) => {\n                      return (\n                        <option key={at.scheme} value={at.scheme}>\n                          {at.name}\n                        </option>\n                      );\n                    })}\n                  </select>\n                </span>\n                { this.state.authScheme === 'Bearer' &&\n                  <span>\n                    <label> Token </label>\n                    <input type=\"text\" value={this.state.Token} onChange={ this.onTokenChange }/>\n                  </span> \n                }\n                { this.state.authScheme === 'Basic' &&\n                  <div>\n                    <span>\n                      <label> Username </label>\n                      <input type=\"text\" value={this.state.userName} onChange={ this.onUsernameChange }/>\n                    </span>\n                    <span>\n                      <label> Password </label>\n                      <input type=\"password\" value={this.state.password} onChange={ this.onPasswordChange }/>\n                    </span>\n                  </div>\n                }\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onUrlOk}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                    <div className=\"button circular\" title=\"Cancel\" onClick={this.onUrlCancel}>\n                        <FontAwesomeIcon icon={faTimes} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n          </Modal>\n      </div>\n    );\n  }\n}\n\nconst toURL = (url) => {\n  try {\n    return new URL(url)\n  } catch(error) {\n    if (error instanceof TypeError) {\n      return null;\n    } else {\n      throw error;\n    }\n  }\n}\n\nDatasetControls.defaultProps = {\n  uuid: uuidv4(),\n  datasets: [],\n  dataset: null,\n  hierarchyConfig: [],\n  configHasChanged: false,\n  isFetching: false,\n  lastUpdated: new Date(),\n  \n};\n\nDatasetControls.propTypes = {\n  uuid: PropTypes.string,\n  datasets: PropTypes.array,\n  dataset: PropTypes.array,\n  fetchDataset: PropTypes.func.isRequired,\n  uploadDataset: PropTypes.func.isRequired,\n  setDataset: PropTypes.func.isRequired,\n  removeDataset: PropTypes.func.isRequired,\n  removeSearchIndex: PropTypes.func.isRequired,\n  getIsFetching: PropTypes.func.isRequired,\n  setIsFetching: PropTypes.func.isRequired,\n  showNodes: PropTypes.func.isRequired,\n  setHierarchyConfig: PropTypes.func.isRequired, \n  colorBy: PropTypes.func.isRequired,\n  startRefresh: PropTypes.func.isRequired,\n  stopRefresh: PropTypes.func.isRequired,\n  isFetching: PropTypes.bool,\n  lastUpdated: PropTypes.instanceOf(Date),\n  setError: PropTypes.func.isRequired,\n  hierarchyConfig: PropTypes.array,\n  configHasChanged: PropTypes.bool,\n  fullDatasets: PropTypes.object,\n  controls: PropTypes.object,\n  keyFields: PropTypes.array,\n  ignoredFields: PropTypes.array\n};\n\nconst mapStateToProps = (state, ownProps) => {\n  const owner = ownProps.uuid;\n  return {\n    dataset: selectDataset(state,owner),\n    isFetching: getIsFetching(state, owner),\n    lastUpdated: getLastUpdated(state, owner),\n    fullDatasets: selectDatasets(state),\n    controls: selectControls(state),\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state)\n  };\n}\n\nconst mapDispatchToProps = {\n  fetchDataset,\n  uploadDataset,\n  setDataset,\n  selectDataset,\n  removeDataset,\n  removeSearchIndex,\n  getIsFetching,\n  setIsFetching,\n  showNodes,\n  setHierarchyConfig, \n  colorBy,\n  startRefresh,\n  stopRefresh,\n  setError\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetControls);\n","import React from 'react';\n//import PropTypes from 'prop-types';\nimport classNames from 'classnames';\n\nimport { connect } from 'react-redux';\n\nimport style from \"./DatasetControls.module.css\";\n\nclass DatasetSlider extends React.Component {\n    state = {\n      start: null,\n      end: null,\n      labelMode: \"long\",   // mid, long\n    }\n    \n    onDragEnter = (e) => {\n      e.preventDefault();\n      console.log(\"dragEnter\");\n    }\n\n    onDragOver = (e) => {\n      e.preventDefault();\n      console.log(\"dragover\");\n    }\n    \n    onDragStart = (e) => {\n      let slider  = e.target.dataset.slider;\n      this.sliderType = slider;\n      //e.dataTransfer.setData(\"text/plain\", slider)\n      console.log(\"drag start complete\");\n    }\n    \n    onDrag = (e) => {\n      console.log(\"drag complete\");\n    }\n    \n    \n    onDrop = (e, target) => {\n      //let source = e.dataTransfer.getData(\"text/plain\");\n      console.log(\"drop e target: %o\", e.target)\n      let source = this.sliderType;\n      let slot = Number(e.target.dataset.slot);\n      \n      if (isNaN(slot)) return;\n      \n      if (source === \"min\") {\n        if (slot >= this.state.end) return;\n        this.setState({\n          start: slot\n        })\n      } else if (source === \"max\") {\n        if (slot <= this.state.start) return;\n        this.setState({\n          end: slot\n        })\n      }\n      this.sliderType = null;\n    }\n    \n    MinSlider=()=> {\n      return (\n        <div data-slider=\"min\" \n            onDragStart={(e) => this.onDragStart(e)} \n            onTouchStart={(e) => this.onDragStart(e)}\n            onDrag = {this.onDrag}\n            draggable className={\n          classNames({[style.sliderThumb]:true, [style.sliderThumbMin]:true})}>\n        </div>\n      );\n    }\n\n    MaxSlider=()=> {\n      return (\n        <div data-slider=\"max\" \n            onDragStart={this.onDragStart}  \n            onTouchStart={this.onDragStart}\n            onDrag={this.onDrag}\n            draggable className={classNames({[style.sliderThumb]:true, [style.sliderThumbMax]:true})}></div>\n      );\n    }\n   \n    render() {\n      const points = this.props.points;\n      const startUuid = this.props.startUuid;\n      const endUuid = this.props.endUuid;\n      let scale =[];\n      let slider=[];\n      let currentScale = [];\n      let minThumb = null;\n      let maxThumb = null\n      \n      \n      for (let i = 0; i <= points.length - 1; i++) {\n        let label = \"s\" + i;\n\n        scale.push(\n          <div \n            key={points[i]} \n            className={style.slotScale}>\n            {label}\n          </div>\n        );\n      \n        let currentLabel = \"\";\n        \n        if (points[i] === startUuid){\n          currentLabel = \"Start\";\n          minThumb = <this.MinSlider />\n          maxThumb = null;\n        } else if(points[i] === endUuid){\n          currentLabel = \"End\";\n          minThumb = null;\n          maxThumb = <this.MaxSlider />\n        } else {\n          minThumb = null;\n          maxThumb = null;\n        }\n        \n        currentScale.push(\n          <div \n            \n            key={points[i]}\n            className={style.slotScale}>\n            {currentLabel}\n          </div>\n        );\n          \n        const lineIsSelected = startUuid !== null && endUuid !== null && i > points.indexOf(startUuid) && i < points.indexOf(endUuid);\n\n        slider.push(\n          <div \n            data-slot={i}\n            onDragOver={(e) => {e.preventDefault();}} \n            onDragEnter={(e) => {this.onDragEnter(e)}} \n            onTouchMove = {this.onDragOver}\n            onTouchEnd = {this.onDrop}\n            onDrop = {(e) => this.onDrop(e, i)}\n            key={points[i]} \n            className={style.slot}>\n              <div  data-slot={i} \n              className={classNames({\n                [style.line]: true,\n                [style.lineSelected]: lineIsSelected\n              })}/>\n              <span className={style.scaleMark}></span>\n              {minThumb}\n              {maxThumb}\n          </div>\n        );\n      }\n     \n      return (\n        <div>\n          <div>\n            <div className={style.sliderContainer}>\n             \n             <div className={style.sliderScale}>\n                 {scale}\n              </div>\n        \n              <div className={style.slider}>\n                  {slider}\n              </div>\n             \n              <div className={style.sliderSelectedScale}>\n                  {currentScale}\n              </div>\n             \n            </div>\n          </div>\n        </div>\n      );\n    }\n}      \n      \nvar DragDropTouch;\n(function (DragDropTouch_1) {\n    /**\n     * Object used to hold the data that is being dragged during drag and drop operations.\n     *\n     * It may hold one or more data items of different types. For more information about\n     * drag and drop operations and data transfer objects, see\n     * <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer\">HTML Drag and Drop API</a>.\n     *\n     * This object is created automatically by the @see:DragDropTouch singleton and is\n     * accessible through the @see:dataTransfer property of all drag events.\n     */\n    var DataTransfer = (function () {\n        function DataTransfer() {\n            this._dropEffect = 'move';\n            this._effectAllowed = 'all';\n            this._data = {};\n        }\n        Object.defineProperty(DataTransfer.prototype, \"dropEffect\", {\n            /**\n             * Gets or sets the type of drag-and-drop operation currently selected.\n             * The value must be 'none',  'copy',  'link', or 'move'.\n             */\n            get: function () {\n                return this._dropEffect;\n            },\n            set: function (value) {\n                this._dropEffect = value;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(DataTransfer.prototype, \"effectAllowed\", {\n            /**\n             * Gets or sets the types of operations that are possible.\n             * Must be one of 'none', 'copy', 'copyLink', 'copyMove', 'link',\n             * 'linkMove', 'move', 'all' or 'uninitialized'.\n             */\n            get: function () {\n                return this._effectAllowed;\n            },\n            set: function (value) {\n                this._effectAllowed = value;\n            },\n            enumerable: true,\n            configurable: true\n        });\n        Object.defineProperty(DataTransfer.prototype, \"types\", {\n            /**\n             * Gets an array of strings giving the formats that were set in the @see:dragstart event.\n             */\n            get: function () {\n                return Object.keys(this._data);\n            },\n            enumerable: true,\n            configurable: true\n        });\n        /**\n         * Removes the data associated with a given type.\n         *\n         * The type argument is optional. If the type is empty or not specified, the data\n         * associated with all types is removed. If data for the specified type does not exist,\n         * or the data transfer contains no data, this method will have no effect.\n         *\n         * @param type Type of data to remove.\n         */\n        DataTransfer.prototype.clearData = function (type) {\n            if (type != null) {\n                delete this._data[type];\n            }\n            else {\n                this._data = null;\n            }\n        };\n        /**\n         * Retrieves the data for a given type, or an empty string if data for that type does\n         * not exist or the data transfer contains no data.\n         *\n         * @param type Type of data to retrieve.\n         */\n        DataTransfer.prototype.getData = function (type) {\n            return this._data[type] || '';\n        };\n        /**\n         * Set the data for a given type.\n         *\n         * For a list of recommended drag types, please see\n         * https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Recommended_Drag_Types.\n         *\n         * @param type Type of data to add.\n         * @param value Data to add.\n         */\n        DataTransfer.prototype.setData = function (type, value) {\n            this._data[type] = value;\n        };\n        /**\n         * Set the image to be used for dragging if a custom one is desired.\n         *\n         * @param img An image element to use as the drag feedback image.\n         * @param offsetX The horizontal offset within the image.\n         * @param offsetY The vertical offset within the image.\n         */\n        DataTransfer.prototype.setDragImage = function (img, offsetX, offsetY) {\n            var ddt = DragDropTouch._instance;\n            ddt._imgCustom = img;\n            ddt._imgOffset = { x: offsetX, y: offsetY };\n        };\n        return DataTransfer;\n    }());\n    DragDropTouch_1.DataTransfer = DataTransfer;\n    /**\n     * Defines a class that adds support for touch-based HTML5 drag/drop operations.\n     *\n     * The @see:DragDropTouch class listens to touch events and raises the\n     * appropriate HTML5 drag/drop events as if the events had been caused\n     * by mouse actions.\n     *\n     * The purpose of this class is to enable using existing, standard HTML5\n     * drag/drop code on mobile devices running IOS or Android.\n     *\n     * To use, include the DragDropTouch.js file on the page. The class will\n     * automatically start monitoring touch events and will raise the HTML5\n     * drag drop events (dragstart, dragenter, dragleave, drop, dragend) which\n     * should be handled by the application.\n     *\n     * For details and examples on HTML drag and drop, see\n     * https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Drag_operations.\n     */\n    var DragDropTouch = (function () {\n        /**\n         * Initializes the single instance of the @see:DragDropTouch class.\n         */\n        function DragDropTouch() {\n            this._lastClick = 0;\n            // enforce singleton pattern\n            if (DragDropTouch._instance) {\n                throw Error('DragDropTouch instance already created.');\n            }\n            // detect passive event support\n            // https://github.com/Modernizr/Modernizr/issues/1894\n            var supportsPassive = false;\n            document.addEventListener('test', function () { }, {\n                get passive() {\n                    supportsPassive = true;\n                    return true;\n                }\n            });\n            // listen to touch events\n            if ('ontouchstart' in document) {\n                var d = document, ts = this._touchstart.bind(this), tm = this._touchmove.bind(this), te = this._touchend.bind(this), opt = supportsPassive ? { passive: false, capture: false } : false;\n                d.addEventListener('touchstart', ts, opt);\n                d.addEventListener('touchmove', tm, opt);\n                d.addEventListener('touchend', te);\n                d.addEventListener('touchcancel', te);\n            }\n        }\n        /**\n         * Gets a reference to the @see:DragDropTouch singleton.\n         */\n        DragDropTouch.getInstance = function () {\n            return DragDropTouch._instance;\n        };\n        // ** event handlers\n        DragDropTouch.prototype._touchstart = function (e) {\n            var _this = this;\n            if (this._shouldHandle(e)) {\n                // raise double-click and prevent zooming\n                if (Date.now() - this._lastClick < DragDropTouch._DBLCLICK) {\n                    if (this._dispatchEvent(e, 'dblclick', e.target)) {\n                        e.preventDefault();\n                        this._reset();\n                        return;\n                    }\n                }\n                // clear all variables\n                this._reset();\n                // get nearest draggable element\n                var src = this._closestDraggable(e.target);\n                if (src) {\n                    // give caller a chance to handle the hover/move events\n                    if (!this._dispatchEvent(e, 'mousemove', e.target) &&\n                        !this._dispatchEvent(e, 'mousedown', e.target)) {\n                        // get ready to start dragging\n                        this._dragSource = src;\n                        this._ptDown = this._getPoint(e);\n                        this._lastTouch = e;\n                        e.preventDefault();\n                        // show context menu if the user hasn't started dragging after a while\n                        setTimeout(function () {\n                            if (_this._dragSource === src && _this._img === null) {\n                                if (_this._dispatchEvent(e, 'contextmenu', src)) {\n                                    _this._reset();\n                                }\n                            }\n                        }, DragDropTouch._CTXMENU);\n                    }\n                }\n            }\n        };\n        DragDropTouch.prototype._touchmove = function (e) {\n            if (this._shouldHandle(e)) {\n                // see if target wants to handle move\n                var target = this._getTarget(e);\n                if (this._dispatchEvent(e, 'mousemove', target)) {\n                    this._lastTouch = e;\n                    e.preventDefault();\n                    return;\n                }\n                // start dragging\n                if (this._dragSource && !this._img) {\n                    var delta = this._getDelta(e);\n                    if (delta > DragDropTouch._THRESHOLD) {\n                        this._dispatchEvent(e, 'dragstart', this._dragSource);\n                        this._createImage(e);\n                        this._dispatchEvent(e, 'dragenter', target);\n                    }\n                }\n                // continue dragging\n                if (this._img) {\n                    this._lastTouch = e;\n                    e.preventDefault(); // prevent scrolling\n                    if (target !== this._lastTarget) {\n                        this._dispatchEvent(this._lastTouch, 'dragleave', this._lastTarget);\n                        this._dispatchEvent(e, 'dragenter', target);\n                        this._lastTarget = target;\n                    }\n                    this._moveImage(e);\n                    this._dispatchEvent(e, 'dragover', target);\n                }\n            }\n        };\n        DragDropTouch.prototype._touchend = function (e) {\n            if (this._shouldHandle(e)) {\n                // see if target wants to handle up\n                if (this._dispatchEvent(this._lastTouch, 'mouseup', e.target)) {\n                    e.preventDefault();\n                    return;\n                }\n                // user clicked the element but didn't drag, so clear the source and simulate a click\n                if (!this._img) {\n                    this._dragSource = null;\n                    this._dispatchEvent(this._lastTouch, 'click', e.target);\n                    this._lastClick = Date.now();\n                }\n                // finish dragging\n                this._destroyImage();\n                if (this._dragSource) {\n                    if (e.type.indexOf('cancel') < 0) {\n                        this._dispatchEvent(this._lastTouch, 'drop', this._lastTarget);\n                    }\n                    this._dispatchEvent(this._lastTouch, 'dragend', this._dragSource);\n                    this._reset();\n                }\n            }\n        };\n        // ** utilities\n        // ignore events that have been handled or that involve more than one touch\n        DragDropTouch.prototype._shouldHandle = function (e) {\n            return e &&\n                !e.defaultPrevented &&\n                e.touches && e.touches.length < 2;\n        };\n        // clear all members\n        DragDropTouch.prototype._reset = function () {\n            this._destroyImage();\n            this._dragSource = null;\n            this._lastTouch = null;\n            this._lastTarget = null;\n            this._ptDown = null;\n            this._dataTransfer = new DataTransfer();\n        };\n        // get point for a touch event\n        DragDropTouch.prototype._getPoint = function (e, page) {\n            if (e && e.touches) {\n                e = e.touches[0];\n            }\n            return { x: page ? e.pageX : e.clientX, y: page ? e.pageY : e.clientY };\n        };\n        // get distance between the current touch event and the first one\n        DragDropTouch.prototype._getDelta = function (e) {\n            var p = this._getPoint(e);\n            return Math.abs(p.x - this._ptDown.x) + Math.abs(p.y - this._ptDown.y);\n        };\n        // get the element at a given touch event\n        DragDropTouch.prototype._getTarget = function (e) {\n            var pt = this._getPoint(e), el = document.elementFromPoint(pt.x, pt.y);\n            while (el && getComputedStyle(el).pointerEvents === 'none') {\n                el = el.parentElement;\n            }\n            return el;\n        };\n        // create drag image from source element\n        DragDropTouch.prototype._createImage = function (e) {\n            // just in case...\n            if (this._img) {\n                this._destroyImage();\n            }\n            // create drag image from custom element or drag source\n            var src = this._imgCustom || this._dragSource;\n            this._img = src.cloneNode(true);\n            this._copyStyle(src, this._img);\n            this._img.style.top = this._img.style.left = '-9999px';\n            // if creating from drag source, apply offset and opacity\n            if (!this._imgCustom) {\n                var rc = src.getBoundingClientRect(), pt = this._getPoint(e);\n                this._imgOffset = { x: pt.x - rc.left, y: pt.y - rc.top };\n                this._img.style.opacity = DragDropTouch._OPACITY.toString();\n            }\n            // add image to document\n            this._moveImage(e);\n            document.body.appendChild(this._img);\n        };\n        // dispose of drag image element\n        DragDropTouch.prototype._destroyImage = function () {\n            if (this._img && this._img.parentElement) {\n                this._img.parentElement.removeChild(this._img);\n            }\n            this._img = null;\n            this._imgCustom = null;\n        };\n        // move the drag image element\n        DragDropTouch.prototype._moveImage = function (e) {\n            var _this = this;\n            requestAnimationFrame(function () {\n                if (_this._img) {\n                    var pt = _this._getPoint(e, true), s = _this._img.style;\n                    s.position = 'absolute';\n                    s.pointerEvents = 'none';\n                    s.zIndex = '999999';\n                    s.left = Math.round(pt.x - _this._imgOffset.x) + 'px';\n                    s.top = Math.round(pt.y - _this._imgOffset.y) + 'px';\n                }\n            });\n        };\n        // copy properties from an object to another\n        DragDropTouch.prototype._copyProps = function (dst, src, props) {\n            for (var i = 0; i < props.length; i++) {\n                var p = props[i];\n                dst[p] = src[p];\n            }\n        };\n        DragDropTouch.prototype._copyStyle = function (src, dst) {\n            // remove potentially troublesome attributes\n            DragDropTouch._rmvAtts.forEach(function (att) {\n                dst.removeAttribute(att);\n            });\n            // copy canvas content\n            if (src instanceof HTMLCanvasElement) {\n                var cSrc = src, cDst = dst;\n                cDst.width = cSrc.width;\n                cDst.height = cSrc.height;\n                cDst.getContext('2d').drawImage(cSrc, 0, 0);\n            }\n            // copy style (without transitions)\n            var cs = getComputedStyle(src);\n            for (var i = 0; i < cs.length; i++) {\n                var key = cs[i];\n                if (key.indexOf('transition') < 0) {\n                    dst.style[key] = cs[key];\n                }\n            }\n            dst.style.pointerEvents = 'none';\n            // and repeat for all children\n            for (var j = 0; j < src.children.length; j++) {\n                this._copyStyle(src.children[j], dst.children[j]);\n            }\n        };\n        DragDropTouch.prototype._dispatchEvent = function (e, type, target) {\n            if (e && target) {\n                var evt = document.createEvent('Event'), t = e.touches ? e.touches[0] : e;\n                evt.initEvent(type, true, true);\n                evt.button = 0;\n                evt.which = evt.buttons = 1;\n                this._copyProps(evt, e, DragDropTouch._kbdProps);\n                this._copyProps(evt, t, DragDropTouch._ptProps);\n                evt.dataTransfer = this._dataTransfer;\n                target.dispatchEvent(evt);\n                return evt.defaultPrevented;\n            }\n            return false;\n        };\n        // gets an element's closest draggable ancestor\n        DragDropTouch.prototype._closestDraggable = function (e) {\n            for (; e; e = e.parentElement) {\n                if (e.hasAttribute('draggable') && e.draggable) {\n                    return e;\n                }\n            }\n            return null;\n        };\n        return DragDropTouch;\n    }());\n    /*private*/ DragDropTouch._instance = new DragDropTouch(); // singleton\n    // constants\n    DragDropTouch._THRESHOLD = 5; // pixels to move before drag starts\n    DragDropTouch._OPACITY = 0.5; // drag image opacity\n    DragDropTouch._DBLCLICK = 500; // max ms between clicks in a double click\n    DragDropTouch._CTXMENU = 900; // ms to hold before raising 'contextmenu' event\n    // copy styles/attributes from drag source to drag image element\n    DragDropTouch._rmvAtts = 'id,class,style,draggable'.split(',');\n    // synthesize and dispatch an event\n    // returns true if the event has been handled (e.preventDefault == true)\n    DragDropTouch._kbdProps = 'altKey,ctrlKey,metaKey,shiftKey'.split(',');\n    DragDropTouch._ptProps = 'pageX,pageY,clientX,clientY,screenX,screenY'.split(',');\n    DragDropTouch_1.DragDropTouch = DragDropTouch;\n})(DragDropTouch || (DragDropTouch = {}));\n\n// const mapStateToProps = (state, ownProps) => {\n\n// }\n\n// const mapDispatchToProps = {\n\n// };\n\nexport default connect(null, null)(DatasetSlider);","import React, { Component } from \"react\";\nimport { connect } from 'react-redux';\nimport classNames from 'classnames';\nimport Modal from 'react-modal';\n\nimport { isNil } from \"ramda\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { \n  faCheck, faDizzy, faPlus, faMinusCircle, faHome, faAngleDoubleDown, faAngleDoubleUp,\n  faFileExport, faFileImport, faTimes\n} from \"@fortawesome/free-solid-svg-icons\";\n\nimport { \n  selectDatasets, getLastUpdated, removeDataset,getKeyFields, getIgnoredFields\n} from 'domain/dataset';\nimport { \n  setHierarchyConfig, showNodes, colorBy, selectControls, setStartDataset, setEndDataset\n} from 'domain/controls';\nimport { getError, clearError } from \"domain/error\";\nimport { removeSearchIndex } from \"epics/index-dataset-epic\";\nimport { uploadDataset } from \"epics/upload-dataset-epic\";\n\nimport Header from 'features/header/Header';\nimport HierarchySelector from 'features/hierarchy-selector/HierarchySelector';\nimport ComparisonSelector from 'features/comparison-selector/ComparisonSelector';\nimport MiscControls from 'features/misc-controls/MiscControls';\nimport SearchControls from 'features/search/SearchControls';\nimport Visualization from 'features/visualization/Visualization';\nimport DatasetControls from 'features/dataset-controls/DatasetControls';\nimport DatasetSlider from 'features/dataset-controls/DatasetSlider';\nimport DatasetUpload from 'features/dataset-controls/DatasetUpload';\nimport { getDataToExport } from \"features/dataset-controls/export\"\n\nimport style from './App.module.css';\n\nimport datasets from './datasets';\n\nconst uuidv4 = require('uuid/v4');\n\nModal.setAppElement('#root');\nconst IMPORT = \"import\";\nconst EXPORT = \"export\";\nconst DATA = \"data\";\nconst CONTROLS = \"controls\";\nconst defaultOptions = {\n      action: \"\",\n      data: true,\n      controls: true\n    }\nclass App extends Component {\n\n  state = {\n    showData: true,\n    showGrouping: false,\n    showFiltering: false,\n    uuids: [uuidv4()],\n    datasetAdded: false,\n    startUuid: null,\n    endUuid: null,\n    showOptions: false,\n    options:{\n      action: \"\",\n      data: true,\n      controls: true\n    },\n    selectedFile: null,\n    exportName: \"dataset.json\"\n  }\n\n  componentWillReceiveProps = (nextProps) =>{\n    const datasetAdded = this.state.datasetAdded && (nextProps.uuids.length !== this.state.uuids.length)\n    const uniqueUuids = datasetAdded || nextProps.uuids.length === 0\n                        ? Array.from(new Set(nextProps.uuids.concat(this.state.uuids)))\n                        : nextProps.uuids;\n    const startUuid = nextProps.startUuid || this.state.startUuid || uniqueUuids[0];\n    const endUuid = nextProps.endUuid || this.state.endUuid;\n    this.setState({\n      uuids: uniqueUuids,\n      startUuid: startUuid,\n      endUuid: endUuid,\n      datasetAdded: datasetAdded\n    });\n  }\n\n  toggleShowData = () =>{\n    this.setState({\n      showData: !this.state.showData,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: false,\n    });\n  }\n\n  toggleShowComparison = () =>{\n    this.setState({\n      showData: false,\n      showComparison: !this.state.showComparison,\n      showGrouping: false,\n      showFiltering: false\n    });\n  }\n\n  toggleShowGrouping = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: !this.state.showGrouping,\n      showFiltering: false\n    });\n  }\n\n  toggleShowFiltering = () =>{\n    this.setState({\n      showData: false,\n      showComparison: false,\n      showGrouping: false,\n      showFiltering: !this.state.showFiltering\n    });\n  }\n\n  onErrorClose = () => {\n    this.props.clearError();\n  }\n\n  resetControls = () => {\n    this.props.colorBy(null);\n    this.props.setHierarchyConfig([]);\n    this.props.showNodes(true);\n  }\n\n  showImportOptions = () => {\n    this.showOptions(IMPORT);\n  }\n\n  showExportOptions = () => {\n    this.showOptions(EXPORT);\n  }\n\n  showOptions = (action) => {\n    this.setOptions(\"action\", action);\n    this.setState({showOptions: true})\n  }\n\n  processOptions = () => {\n    if(this.state.options.action === IMPORT)\n    {\n      this.props.uploadDataset({\n        'owner': uuidv4(),\n        'file': this.state.selectedFile,\n        'includeData': this.state.options.data,\n        'includeControls': this.state.options.controls,\n      });\n      this.setState({showOptions: false})\n    }\n  }\n\n  onUpload = (file) => {\n    this.setState({\n      selectedFile: file,\n    });\n  }\n\n  getDownloadUrl = () => {\n    const datasets = this.state.options.data && this.props.fullDatasets;\n    const controls = this.state.options.controls && this.props.controls;\n    const keyFields = this.state.options.data && this.props.keyFields;\n    const ignoredFields = this.state.options.data && this.props.ignoredFields;\n    const exportData = getDataToExport(datasets, keyFields, ignoredFields, controls)\n    const urlObject = window.URL || window.webkitURL || window;\n    const json = JSON.stringify(exportData);\n    const blob = new Blob([json], {'type': \"application/json\"});\n    const url = urlObject.createObjectURL(blob);;\n    return url;\n  }\n\n  exportNameChange = (name) => {\n    this.setState({\n      exportName: name,\n    });\n  }\n\n  cancelOptions = () => {\n    this.setState({\n      showOptions: false,\n      options: defaultOptions\n    })\n  }\n\n  setOptions = (key, value) => {\n    const options = this.state.options;\n    options[key] = value;\n    this.setState({options: options});\n  }\n\n  addDatasetEntry = () => {\n    const uuids = this.state.uuids;\n    const newItem = uuidv4()\n    uuids.push(newItem);\n    this.setState({\n      uuids: uuids,\n      datasetAdded: true\n    });\n  }\n\n  removeDatasetEntry = (uuid) =>{\n    const uuids = this.state.uuids;\n    if(uuids.includes(uuid)){\n      const newUuids = uuids.splice(uuids.indexOf(uuid), 1);\n      this.setState({uuids: newUuids})\n    }\n    this.props.removeSearchIndex({'owner': uuid});\n    this.props.removeDataset({'owner': uuid});\n  }\n\n  setStartUuid = (uuid) =>{\n    this.setState({startUuid: uuid});\n    this.props.setStartDataset(uuid);\n  }\n\n  setEndUuid = (uuid) =>{\n    this.setState({endUuid: uuid});\n    this.props.setEndDataset(uuid);\n  }\n\n  render() {\n    const { dataset, darkTheme, error, lastUpdated} = this.props;\n    const hasDataset = dataset && dataset.length > 0;\n\n    const uuids = this.state.uuids;\n    const startUuid = this.state.startUuid;\n    const endUuid = this.state.endUuid;\n    const showData = this.state.showData;\n    const showComparison = this.state.showComparison;\n    const showGrouping = this.state.showGrouping;\n    const showOptions = this.state.showOptions;\n    const options = this.state.options;\n\n    return (\n      <div className={\n          classNames({\n            [style.appContainer]: true,\n            'darkTheme': darkTheme\n          })\n      }>\n        <input name=\"hideControls\" id=\"hideControls\" type=\"checkbox\" />\n        <label htmlFor=\"hideControls\" className={ style.hideControls }>\n          { /* <FontAwesomeIcon icon={faChevron} /> */ }\n          <span>&lt;&lt;</span>\n        </label>\n        <div className={ style.controls }>\n          <Header />\n          <div className={ classNames({ [style.centerSpan]: true }) }>\n            <div className=\"button circular\" title=\"Reset Controls\" size=\"3x\" onClick={this.resetControls}>\n              <FontAwesomeIcon icon={faHome} />\n            </div>\n          </div>\n          <div className={style.accordionHeader} onClick={this.toggleShowData}>\n            Data  {!showData && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showData && <FontAwesomeIcon onClick={this.toggleShowData} icon={faAngleDoubleUp} />}\n          </div>\n          <div className={ classNames({ [style.section]: true, [style.hidden]: !showData })}>\n            {uuids.map((uuid, index) => {\n              return(\n                <div  key={ uuid } >\n                  <div className={style.dataControlHeader}>\n                    t{index}\n                    {index > 0 && <FontAwesomeIcon icon={faMinusCircle} onClick={ () => {this.removeDatasetEntry(uuid)}} />}\n                  </div>\n                  <DatasetControls uuid={ uuid } datasets={ datasets }/>\n                </div>\n              )\n            })}\n            <span className={ style.centerSpan }>\n              <div className=\"button circular\" title=\"Add Dataset\" onClick={this.addDatasetEntry}>\n                <FontAwesomeIcon icon={faPlus} />\n              </div>\n            </span>\n          </div>\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showData }) }>\n              <SearchControls />\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowComparison}>\n            Comparison  {!showComparison && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showComparison && <FontAwesomeIcon  onClick={this.toggleShowComparison} icon={faAngleDoubleUp} />}\n          </div>\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              <ComparisonSelector startUid={startUuid} endUid={endUuid} />\n              <div className={style.selectorContainer}>\n                <span className={style.label}>Start</span>\n                <div className={style.selector}>\n                  <label className=\"select\">\n                  <select\n                    onChange={(evt) => this.setStartUuid(evt.target.value)}\n                    value={isNil(startUuid) ? \"UNSET\" : startUuid}\n                  >\n                    <option value=\"UNSET\">&mdash;None&mdash;</option>\n                    {uuids.map((uuid, index) => {\n                      return (\n                        <option key={uuid} value={uuid}>\n                          t{index}\n                        </option>\n                      );\n                    })}\n                  </select>\n                  </label>\n                </div>\n              </div>\n              <div className={style.selectorContainer}>\n                <span className={style.label}>End</span>\n                <div className={style.selector}>\n                  <label className=\"select\">\n                  <select\n                    onChange={(evt) => this.setEndUuid(evt.target.value)}\n                    value={isNil(endUuid) ? \"UNSET\" : endUuid}\n                  >\n                    <option value=\"UNSET\">&mdash;None&mdash;</option>\n                    {uuids.map((uuid, index) => {\n                      return (\n                        <option key={uuid} value={uuid}>\n                          t{index}\n                        </option>\n                      );\n                    })}\n                  </select>\n                  </label>\n                </div>\n              </div>\n            </div>\n          }\n          { !hasDataset && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showComparison }) }>\n              Please select datasets to continue\n            </div>\n          }\n\n          <div className={style.accordionHeader} onClick={this.toggleShowGrouping}>\n            Grouping  {!showGrouping && <FontAwesomeIcon icon={faAngleDoubleDown} />}{showGrouping && <FontAwesomeIcon  onClick={this.toggleShowGrouping} icon={faAngleDoubleUp} />}\n          </div>\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              <HierarchySelector />\n            </div>\n          }\n\n          { hasDataset &&\n            <div className={ classNames({ [style.section]: true, [style.hidden]: !showGrouping }) }>\n              <MiscControls />\n            </div>\n          }\n          { !hasDataset && \n            <div className={ classNames({ [style.section]: true, [style.dimSection]:true, [style.hierarchySection]: true, [style.hidden]: !showGrouping }) }>\n              Please select a dataset to continue\n            </div>\n          }\n          <div className={style.footerContainer}>\n            <span className={ style.centerSpan }>\n                <div className=\"button circular\" title=\"Import Dataset\" onClick={this.showImportOptions}>\n                  <FontAwesomeIcon icon={faFileImport} />\n                </div>\n                <div className=\"button circular\" disabled={!hasDataset} title=\"Export Dataset\" onClick={this.showExportOptions}>\n                  <FontAwesomeIcon icon={faFileExport} />\n                </div>\n            </span>\n          </div>\n        </div>\n        { dataset.length===0 && lastUpdated !== null &&\n          <div  className={ style.emptyDataset }>\n            <span>\n              Current dataset is empty\n            </span>\n          </div>\n        }\n\n        <div className={ style.canvas }>\n          <Visualization startUid={startUuid} endUid={endUuid} />\n        </div>\n        <div className={ style.sliderContainer } >\n          <DatasetSlider points={uuids} startUuid={startUuid} endUuid={endUuid} />\n        </div>\n        <Modal isOpen={ error !== null } onRequestClose={this.onErrorClose} contentLabel=\"An Error has occurred\">\n            <div className={ style.modal }>\n              <div className={ style.modalMain }>\n                <span className={ style.justifySpan }>\n                   <div className={ style.icon } title=\"Error\">\n                        <FontAwesomeIcon icon={faDizzy} size=\"7x\" color=\"#cc0000\"/>\n                    </div>\n                    <div>\n                      { error ? error.message : \"\"}\n                    </div>\n                </span>\n                <div>\n                  <span className={ style.centerSpan }>\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.onErrorClose}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  </span>\n                </div>\n              </div>\n            </div>\n        </Modal>\n        <Modal isOpen={ showOptions } onRequestClose={this.cancelOptions} contentLabel=\"An Error has occurred\">\n          <div className={ style.modal }>\n            <div className={ style.modalMain }>\n              {options.action === IMPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Upload</span>\n                  <DatasetUpload\n                    ownerUuid={uuidv4()}\n                    className={style.fileUpload}\n                    selected={this.state.selectedFile ? this.state.selectedFile.name : null}\n                    onChange={this.onUpload}\n                  />\n                </div>\n                }\n                {options.action === EXPORT &&\n                <div className={style.uploadContainer}>\n                  <span className={style.label}>Export As</span>\n                  <input\n                    type=\"text\"\n                    id=\"export-as\"\n                    value={this.state.exportName}\n                    onChange={(evt) => this.exportNameChange(evt.target.value)}\n                  />\n                </div>\n                }\n              <div className={style.container}>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"data-check\"\n                      checked={options.data}\n                      onChange={(evt) => this.setOptions(DATA, evt.target.checked)}\n                    />\n                    <label htmlFor=\"data-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Data</label>\n                </div>\n                <div className={`${style.checkboxContainer} input-group`}>\n                  <div className={ style.switch }>\n                    <input\n                      type=\"checkbox\"\n                      id=\"controls-check\"\n                      checked={options.controls}\n                      onChange={(evt) => this.setOptions(CONTROLS, evt.target.checked)}\n                    />\n                    <label htmlFor=\"controls-check\" className={ style.switchLabel }>\n                    </label>\n                  </div>\n                  <label >Controls</label>\n                </div>\n              </div>\n              <div>\n                <span className={ style.centerSpan }>\n                  {options.action === IMPORT &&\n                    <div className=\"button circular\" title=\"Ok\" onClick={this.processOptions}>\n                        <FontAwesomeIcon icon={faCheck} />\n                    </div>\n                  }\n                  {options.action === EXPORT &&\n                    <a className=\"button circular\" href={ this.getDownloadUrl() } download={ this.state.exportName }\n                      title=\"Download\" disabled={!hasDataset} onClick={this.cancelOptions} >\n                      <FontAwesomeIcon icon={faCheck} />\n                    </a>\n                  }\n                  <div className=\"button circular\" title=\"Cancel\" onClick={this.cancelOptions}>\n                      <FontAwesomeIcon icon={faTimes} />\n                  </div>\n                </span>\n              </div>\n            </div>\n          </div>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  const datasets = selectDatasets(state);\n  const uuids = Object.keys(datasets) || [uuidv4()];\n  const dataset = datasets[uuids[0]] && datasets[uuids[0]].dataset ? datasets[uuids[0]].dataset : [];\n  const controls = selectControls(state);\n  return {\n    dataset: dataset,\n    darkTheme: controls.darkTheme,\n    error: getError(state),\n    lastUpdated: getLastUpdated(state, uuids[0]),\n    uuids: uuids,\n    startUuid: controls.start,\n    endUuid: controls.end,\n    fullDatasets: datasets,\n    controls: controls,\n    keyFields: getKeyFields(state),\n    ignoredFields: getIgnoredFields(state)\n  }\n}\n\nconst mapDispatchToProps = {\n  clearError,\n  setHierarchyConfig, \n  showNodes, \n  colorBy, \n  removeDataset,\n  removeSearchIndex,\n  setStartDataset,\n  setEndDataset,\n  uploadDataset\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { createAction, handleActions } from \"redux-actions\";\nimport compileExpression from \"filtrex\";\n\nconst defaultState = {\n  filterString: \"\",\n  filter: null,\n  isValid: false\n};\n\n// ACTIONS\nconst setFilter = createAction(\"SET_FILTER\");\nconst clearFilter = createAction(\"CLEAR_FILTER\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setFilter]: (state, { payload }) => {\n\n\t  \tconst filterString = payload;\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n\t  \ttry\n\t  \t{\n\t  \t\tfilter = compileExpression(filterString);\n\t  \t\tisValid = true;\n\n\t  \t}\n\t  \tcatch(error)\n\t  \t{\n\t  \t\tfilter = null;\n\t  \t\tisValid = false;\n\n\t  \t}\n\t  \treturn { ...state, filterString, filter, isValid };\n\n    },\n    [clearFilter]: (state) => {\n     \tconst filterString = \"\";\n\t  \tlet filter = null;\n\t  \tlet isValid = false;\n      return { ...state, filterString, filter, isValid };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getFilter = (state) => state.filter.filter;\nconst filterIsValid = (state) => state.filter.isValid;\n\nexport default reducer;\n\nexport { setFilter, getFilter, clearFilter, filterIsValid};","import { combineReducers } from \"redux\";\nimport { searchReducer as search } from 'epics/index-dataset-epic'\nimport dataset from \"./dataset\";\nimport controls from \"./controls\";\nimport error from \"./error\";\nimport filter from \"./filter\";\n\nexport default combineReducers({\n  dataset,\n  search,\n  controls,\n  error,\n  filter\n});\n","import { createAction } from \"redux-actions\";\nimport { of, empty } from \"rxjs\";\nimport { mergeMap, map, tap, catchError } from 'rxjs/operators';\n\nimport { setError } from \"domain/error\"\nimport { getFilter } from \"domain/filter\"\nimport { setFilteredDataset } from \"domain/dataset\"\n\nconst filterDataset = createAction(\"FILTER_DATASET\");\n\nconst filterDatasetEpic = (action$, store) => {\n  return action$\n    .ofType(filterDataset.toString()).pipe(\n      mergeMap(({ payload}) => {\n        const filter = getFilter(store.value);\n\n        if(filter === null)\n          return empty();\n\n        return of(payload).pipe(\n            tap(applyFilter(payload, filter))\n            ,map((payload) =>\n              setFilteredDataset({\n                owner: payload.owner,\n                filtered: payload.filtered\n              })\n            )\n            ,catchError((error) => {\n               const newErr = new Error(\"Error filtering dataset: \" + error.message);\n               return of(setError(newErr));\n            })\n          );\n      })\n    );\n};\n\nconst applyFilter = (data, filter) => {\n  data.filtered = null;\n  const dataset = data.dataset;\n\n  if(filter !== null){\n    data.filtered = dataset.filter((item) => filter(item));\n  }\n\n  return data;\n};\n\nexport default filterDatasetEpic;\n\nexport { filterDataset };","import { combineEpics } from 'redux-observable';\nimport fetchDatasetEpic from './fetch-dataset-epic';\nimport uploadDatasetEpic from './upload-dataset-epic';\nimport loadDatasetEpic from './load-dataset-epic';\nimport searchDatasetEpic from './search-dataset-epic';\nimport indexDatasetEpic from './index-dataset-epic';\nimport refreshDatasetEpic from './refresh-dataset-epic';\nimport filterDatasetEpic from './filter-dataset-epic';\nimport diffDatasetEpic from './diff-dataset-epic';\n\nconst rootEpic = combineEpics(\n  loadDatasetEpic,\n  fetchDatasetEpic,\n  uploadDatasetEpic,\n  searchDatasetEpic,\n  indexDatasetEpic,\n  refreshDatasetEpic,\n  filterDatasetEpic,\n  diffDatasetEpic\n);\n\nexport default rootEpic;\n","import { createStore, applyMiddleware, compose } from \"redux\";\n\nimport { createEpicMiddleware } from 'redux-observable';\nimport rootReducer from './domain/root-reducer';\nimport rootEpic from './epics/root-epic';\n\n// Replace redux compose with redux-devtools compose if it exists\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst configureStore = (initialState = {}) => {\n  const middleware = createEpicMiddleware()\n\n  const store = createStore(rootReducer,\n    initialState,\n    composeEnhancers(\n      applyMiddleware(middleware)\n    )\n  );\n\n  middleware.run(rootEpic);\n\n  return store;\n};\n\nexport default configureStore;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\n\nimport \"index.css\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\n\nimport configureStore from \"./configure-store\";\n\nconst store = configureStore();\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById(\"root\")\n);\n\nregisterServiceWorker();\n\nif (module.hot) {\n  module.hot.accept(\"./App\", () => {\n    ReactDOM.render(\n      <Provider store={store}>\n        <App />\n      </Provider>,\n      document.getElementById(\"root\")\n    );\n  });\n}\n","import { createAction, handleActions } from \"redux-actions\";\n\nconst defaultState = {\n  error: null\n};\n\n// ACTIONS\nconst setError = createAction(\"SET_ERROR\");\nconst clearError = createAction(\"CLEAR_ERROR\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setError]: (state, { payload }) => {\n      if( payload instanceof Error )\n      {\n      \tconst error = payload;\n      \treturn { ...state, error };\n      }\n      return { ...state };\n    },\n    [clearError]: (state) => {\n      const error = null;\n      return { ...state, error };\n    }\n  },\n  defaultState\n);\n\n// SELECTORS\nconst getError = (state) => state.error.error;\n\n\nexport default reducer;\n\nexport { setError, getError, clearError};\n","import { ofType } from 'redux-observable';\nimport { isNil, isEmpty } from \"ramda\";\nimport { of } from \"rxjs\";\nimport { mergeMap, map } from 'rxjs/operators';\n\nimport { configurationFor } from \"domain/dataset\";\n\nconst getValue = require(\"get-value\");\nconst lunr = require(\"lunr\");\n\nconst BUILD_INDICES = \"BUILD_INDICES\";\nconst BUILD_INDICES_SUCCESS = \"BUILD_INDICES_SUCCESS\";\nconst REMOVE_SEARCH_INDEX = \"REMOVE_SEARCH_INDEX\";\n//const BUILD_INDEX_FAILURE = \"BUILD_INDEX_FAILURE\";\nconst SET_SEARCH_RESULTS = \"SET_SEARCH_RESULTS\";\n\nconst buildIndices = (payload) => ({'type': BUILD_INDICES, 'payload': payload })\nconst buildIndicesSuccess = (payload) => ({'type': BUILD_INDICES_SUCCESS, 'payload': payload})\nconst removeSearchIndex = (payload) => ({'type': REMOVE_SEARCH_INDEX, 'payload': payload});\nconst setSearchResults = (payload) => ({'type': SET_SEARCH_RESULTS, 'payload': payload })\n\nconst getSearchResults = (state) => state.search.searchResults || [];\nconst getQueryString = (state) => state.search.queryString;\nconst getSearchIndex = (state, owner) => state.search.searchIndices[owner] || null;\nconst getSearchIndices = (state) => state.search.searchIndices || [];\n\nconst indexDatasetEpic = (action$, store) => {\n  return action$.pipe(\n      ofType(BUILD_INDICES)\n      ,mergeMap(({ payload }) => {\n        return of(payload).pipe(\n            map(generateIndex)\n            ,map((payload) =>\n              buildIndicesSuccess(payload)\n            )\n          );\n      })\n    );\n};\n\nconst searchReducer = (state = { searchIndices: {}, queryString: '', searchResults: null }, action) => {\n  switch (action.type) {\n    case BUILD_INDICES_SUCCESS:\n      action.payload.forEach((item) => {\n        state.searchIndices[item.owner] = item.index;\n      })\n      return {...state };\n    case \n    SET_SEARCH_RESULTS:\n      const searchResults = action.payload.results;\n      const queryString = action.payload.queryString;\n      return { ...state, searchResults, queryString};\n    case \n    REMOVE_SEARCH_INDEX:\n      const rsowner = action.payload.owner;\n      if(state.searchIndices.hasOwnProperty(rsowner))\n        delete state.searchIndices[rsowner];\n\n      return { ...state }\n    default:\n      return state;\n  }\n}\n\nconst flattenDataset = (ds, cfg) => {\n  var flattened = [];\n\n  if(isNil(cfg))\n    return flattened;\n\n  for(var key in ds){\n    var item = {'CRVIZ_HASH_KEY':ds[key].CRVIZ[\"_HASH_KEY\"]};\n    for(var f in cfg.fields){\n      var field = cfg.fields[f];\n\n      var name = field.displayName\n      item[name] = getValue(ds[key], field.displayName);\n    }\n    flattened.push(item);\n  }\n  return flattened;\n}\n\nconst generateIndex = (payload) => {\n  let indices = [];\n  Object.keys(payload.datasets).forEach((owner) => {\n    const dataset = payload.datasets[owner].dataset;\n    const configuration = !isNil(payload.datasets[owner].configuration) && !isEmpty(payload.datasets[owner].configuration) \n                        ? payload.datasets[owner].configuration : configurationFor(dataset);\n    var flat = flattenDataset(dataset, configuration);\n    const idx = lunr(function () {\n      this.ref('CRVIZ_HASH_KEY');\n      if(configuration && configuration.fields){\n        const filteredFields = configuration.fields.filter(f => !f.displayName.includes(\"/\"))\n        filteredFields.map((field) => { return this.field(field.displayName.toLowerCase()); })\n      }\n      flat.map((item) => { return this.add(item); })\n    });\n\n    indices.push({ owner: owner, index: idx })\n  })\n  \n  return indices;\n};\n\nexport default indexDatasetEpic;\n\nexport { buildIndices, searchReducer,  getSearchIndex, removeSearchIndex, getSearchIndices, setSearchResults, getSearchResults, getQueryString };\n","import { createAction, handleActions } from \"redux-actions\";\nimport {\n  chain,\n  concat,\n  find,\n  fromPairs,\n  identity,\n  is,\n  map,\n  merge,\n  path,\n  pipe,\n  propEq,\n  sortBy,\n  toPairs,\n  uniq\n} from \"ramda\";\n\nconst defaultState = {\n  datasets: {},\n  diffs:[],\n  keyFields: [],\n  ignoredFields: []\n};\nconst defaultItemState = {\n  owner: \"\",\n  dataset: [],\n  filtered: null,\n  values: {},\n  configuration: {\n    fields: [],\n    keyFields: [],\n    hashFields: []\n  },\n  isFetching: false,\n  lastUpdated: null,\n};\n\nconst getHashFields = (allFields, ignoredFields) => {\n  if(!ignoredFields || ignoredFields.length === 0){\n    return allFields;\n  }\n\n  return allFields.filter(f => !ignoredFields.includes(f));\n}\n\nconst addHashKey = (keys, obj) => {\n  //console.log(\"addHashKey keys: %o\", keys);\n  const hashKey = keys.reduce( (h, k) => h + path(k.path, obj) + \":\", \"\");\n  obj.CRVIZ[\"_HASH_KEY\"] = hashKey;\n}\n\nconst addHashWithoutIgnored = (fields, obj) => {\n  const hash = fields.reduce( (h, f) => h + path(f.path, obj) + \"|\", \"\");\n  obj.CRVIZ[\"_HASH_WITHOUT_IGNORED\"] = hash;\n}\n\nconst applyHashes = (dataset, configuration) => {\n  dataset.forEach((i) => {\n    if(!('CRVIZ' in i)){\n      i['CRVIZ'] = {};\n    }\n    if(!configuration.hashFields){\n      configuration.hashFields = getHashFields(configuration.fields, configuration.ignoredFields || []);\n    }\n\n    addHashKey(configuration.keyFields.length > 0 ? configuration.keyFields : configuration.hashFields, i);\n    addHashWithoutIgnored(configuration.hashFields, i);\n  });\n};\n\n/**\n * Return a string that uniquely identify the field\n */\nconst getFieldId = (field) => {\n  if(field.path.length >= 1 && field.path[0])\n    return field.path.join(\".\")\n  else\n    return \" \";\n}\n\n/**\n * Returns an array of paths to literal values and arrays in a POJO.\n *\n * Example:\n * pathsIn({ a: 'A', b: { c: 'C', d: [1, 2] } }) //=> [['a'], ['b', 'c'], ['b', 'd']]\n */\nconst pathsIn = (obj) =>\n  chain(\n    ([key, value]) =>\n      is(Object, value) ? map(concat([key]), pathsIn(value)) : [[key]],\n    toPairs(obj)\n  );\n\n/**\n * Return all fields for an object\n */\nconst fieldsFor = (obj, overrides = []) => {\n  const paths = pathsIn(obj).filter(p => p[0] !== 'CRVIZ');\n  return map((path) => {\n    const override = find(propEq('path', path), overrides) || {};\n    return merge(\n      {\n        path: path,\n        displayName: path.join('.'),\n        groupable: true\n      },\n      override\n    )\n  }, paths);\n\n  // var fields = difference(pathsIn(obj), map(prop('path'), overrides));\n  // return [\n  //   ...overrid,\n  //   ...map(\n  //     (path) => ({\n  //       path: path,\n  //       displayName: path.join(\".\"),\n  //       groupable: true\n  //     }),\n  //     unspecified\n  //   )\n  // ];\n};\n\n/**\n * Returns a configuration with any missing items populated\n */\nconst configurationFor = (dataset, keyFields, ignoredFields, configuration = {}) => {\n  const fields = fieldsFor(dataset[0] || {}, configuration.fields);\n  const hashFields = getHashFields(fields, ignoredFields);\n  return {\n    ...configuration,\n    fields: fieldsFor(dataset[0] || {}, configuration.fields),\n    keyFields: keyFields,\n    hashFields: hashFields\n  };\n};\n\n\nconst valuesFor = (dataset, configuration) => {\n  return fromPairs(map((field) => {\n    const values = pipe(\n      map(path(field.path)),\n      uniq,\n      sortBy(identity)\n    )(dataset);\n\n    return [getFieldId(field), values];\n  }, configuration.fields));\n};\n\nconst configureDataset = (dataset, initialConfig, keyFields, ignoredFields) => {\n  const configuration = configurationFor(\n    dataset || [],\n    keyFields,\n    ignoredFields,\n    initialConfig || {}\n  );\n  applyHashes(dataset, configuration);\n\n  const values = valuesFor(dataset, configuration);\n  const isFetching = false;\n  const lastUpdated = new Date();\n  return {\n    dataset: dataset,\n    filtered: null,\n    values: values,\n    configuration: configuration,\n    isFetching: isFetching,\n    lastUpdated: lastUpdated\n  }\n}\n\n// ACTIONS\n\n/**\n * Payload: {\n *   dataset: [], // Array of devices\n *   configuration: {} // Configuration\n * }\n*/\nconst setDatasets = createAction(\"SET_DATASETS\");\nconst setDataset = createAction(\"SET_DATASET\");\nconst setFilteredDataset = createAction(\"SET_FILTERED_DATASET\");\nconst setDatasetDiff = createAction(\"SET_DATASET_DIFF\");\nconst removeDataset = createAction(\"REMOVE_DATASET\");\nconst removeFilteredDataset = createAction(\"REMOVE_FILTERED_DATASET\");\nconst removeDatasetDiff = createAction(\"REMOVE_DATASET_DIFF\");\nconst setIsFetching = createAction(\"SET_IS_FETCHING\");\nconst setKeyFields = createAction(\"SET_KEY_FIELDS\");\nconst setIgnoredFields = createAction(\"SET_IGNORED_FIELDS\");\n\n// REDUCERS\nconst reducer = handleActions(\n  {\n    [setDatasets]: (state, { payload }) => {\n      const datasets = payload.datasets;\n      Object.keys(datasets).forEach((key) => {\n        state.datasets[key] = datasets[key];\n      })\n      \n      return { ...state};\n    },\n    [setDataset]: (state, { payload }) => {\n      const dataset = payload.dataset;\n      const owner = payload.owner;\n      const initialConfig = payload.configuration;\n      const keyFields = getKeyFields(state);\n      const ignoredFields = getIgnoredFields(state);\n      state.datasets[owner] = configureDataset(dataset, initialConfig, keyFields, ignoredFields);\n      return { ...state};\n    },\n    [setFilteredDataset]: (state, { payload }) => {\n      const filtered = payload.filtered;\n      const owner = payload.owner;\n\n      state.datasets[owner].filtered = filtered;\n      return { ...state};\n    },\n    [setDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const differences = payload.differences\n      const newDiff = {\n        'start': start,\n        'end': end,\n        'differences': differences\n      }\n\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx === -1){\n        state.diffs.push(newDiff);\n      } else {\n        state.diffs[idx] = newDiff;\n      }\n      return { ...state};\n    },\n    [removeDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        delete state.datasets[owner];\n\n      return { ...state }\n    },\n    [removeFilteredDataset]: (state, { payload }) => {\n      const owner = payload.owner;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].filtered = null;\n\n      return { ...state }\n    },\n    [removeDatasetDiff]: (state, { payload }) => {\n      const start = payload.start;\n      const end = payload.end;\n      const idx = state.diffs.findIndex(d => d.start === start && d.end === end);\n\n      if(idx !== -1){\n        state.diffs.splice(idx, 1);\n      }\n\n      return { ...state }\n    },\n    [setIsFetching]: (state, { payload }) => {\n      const owner = payload.owner;\n      const isFetching = !!payload.isFetching;\n      if(state.datasets.hasOwnProperty(owner))\n        state.datasets[owner].isFetching = isFetching;\n      return { ...state, isFetching};\n    },\n    [setKeyFields]: (state, { payload }) => { \n      const keyFields = payload;\n      const datasets = _selectDatasets(state);\n      if(datasets){\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];\n          ds.configuration.keyFields = keyFields;\n          applyHashes(ds.dataset, ds.configuration);\n        });\n      }\n\n      return {...state, keyFields: keyFields };\n    },\n    [setIgnoredFields]: (state, { payload }) => {\n      const ignoredFields = payload;\n      const datasets = _selectDatasets(state);\n\n      if(datasets){\n        const allFields = _selectMergedConfiguration(state).fields;\n        const hashFields = getHashFields(allFields, ignoredFields);\n\n        Object.keys(datasets).forEach((key) => {\n          const ds = datasets[key];    \n          ds.configuration.hashFields = hashFields\n          applyHashes(ds.dataset, ds.configuration);\n        });\n      }\n\n      return { ...state, ignoredFields: ignoredFields };\n    }\n  },\n  defaultState\n);\n\n//methods where we need to deal with state both inside and outside of the reducer\n//outside of the reducer state represents the entire state tree, but inside of the\n//reducer the provided state is only the state for the reducer's subset of the \n//state tree.  to avoid duplication of code these methods will be called be used\n//internally from the reducer.  and methods that recieve the full state tree will \n//pare the tree down to just the relevant attributes. in these cases the\n//variable \"dataset\" will represent the segment of the state tree owned by the datset reducer.\nconst _selectDatasets = (dataset) => {\n  return dataset.datasets || {};\n}\nconst _selectMergedConfiguration = (dataset) => {\n  let fields = [];\n  const ds = dataset.datasets;\n  for (var key in ds){\n    for (var f of ds[key].configuration.fields){ \n      // eslint-disable-next-line no-loop-func\n      if(!fields.some(field => field.displayName === f.displayName)){\n        fields.push(f);\n      }\n    }\n  }\n\n  return { fields: fields };\n}\n\n// SELECTORS\nconst selectDatasets = (state) => {\n  return _selectDatasets(state.dataset);\n}\nconst selectDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].dataset ? state.dataset.datasets[owner].dataset : defaultItemState.dataset;\nconst selectFilteredDataset = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].filtered ? state.dataset.datasets[owner].filtered : defaultItemState.filtered;\nconst selectDatasetDiff = (state, start, end) => {\n  let diff = null;\n  const idx = state.dataset.diffs.findIndex(d => d.start === start && d.end === end);\n  if(idx !== -1){\n    diff = state.dataset.diffs[idx].differences;;\n  }\n  return diff;\n}\nconst selectConfiguration = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].configuration ? state.dataset.datasets[owner].configuration : defaultItemState.configuration;\nconst selectMergedConfiguration = (state) => {\n  return _selectMergedConfiguration(state.dataset)\n}\nconst selectValues = (state, owner) => state.dataset && state.dataset.datasets[owner] && state.dataset.datasets[owner].values ? state.dataset.datasets[owner].values : defaultItemState.values;\nconst selectMergedValues = (state) => {\n  let vals = {};\n  const ds = state.dataset.datasets;\n  for (var key in ds){\n    for (var v in ds[key].values){\n      if(vals.hasOwnProperty(v)){\n        const valSet = new Set([...vals[v], ...ds[key].values[v]]);\n        vals[v] = [...valSet];\n      }\n      else {\n        vals[v] = ds[key].values[v];\n      }\n    }\n  }\n\n  return vals;\n}\nconst getIsFetching = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].isFetching ? state.dataset.datasets[owner].isFetching : defaultItemState.isFetching;\nconst getLastUpdated = (state, owner) => state.dataset.datasets[owner] && state.dataset.datasets[owner].lastUpdated ? state.dataset.datasets[owner].lastUpdated : defaultItemState.lastUpdated;\nconst getKeyFields = (state) => state.dataset && state.dataset.keyFields ? state.dataset.keyFields : [];\nconst getIgnoredFields = (state) => state.dataset && state.dataset.ignoredFields ? state.dataset.ignoredFields : [];\nconst selectDatasetIntersection = (state, startOwner, endOwner) => {\n  let ds = [];\n  const start = selectDataset(state, startOwner);\n  start.forEach((s)=>{\n    s.CRVIZ._isRemoved = false;\n    s.CRVIZ._isChanged = false;\n    s.CRVIZ._isAdded = false;\n  });\n  const end = selectDataset(state, endOwner);\n  end.forEach((e)=>{\n    e.CRVIZ._isRemoved = false;\n    e.CRVIZ._isChanged = false;\n    e.CRVIZ._isAdded = false;\n  });\n  \n  if(start.length > 0 && end.length === 0){\n    ds = start;\n  } else if(start.length === 0 && end.length > 0){\n    ds = end;\n  } else if(start.length > 0 && end.length > 0) {\n    start.forEach((s) => {\n      const idx = end.findIndex(e => e.CRVIZ._HASH_KEY === s.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        s.CRVIZ._isRemoved = true;\n      } else {\n        s.CRVIZ._isRemoved = false;\n      }\n      s.CRVIZ._isChanged = false;\n      s.CRVIZ._isAdded = false;\n      ds.push(s);\n    });\n    end.forEach((e) => {\n      const idx = ds.findIndex(i => i.CRVIZ._HASH_KEY === e.CRVIZ._HASH_KEY);\n      if(idx === -1){\n        e.CRVIZ._isAdded = true;\n        ds.push(e);\n      } else if(ds[idx].CRVIZ._HASH_WITHOUT_IGNORED !== e.CRVIZ._HASH_WITHOUT_IGNORED){\n        ds[idx].CRVIZ._isChanged = true;\n      }\n    })\n  }\n  return ds;\n}\n\n\nexport default reducer;\n\nexport { setDatasets, setDataset, selectDataset, selectDatasets, removeDataset, setFilteredDataset, selectFilteredDataset, removeFilteredDataset, selectConfiguration, selectMergedConfiguration,\n  selectValues, selectMergedValues, getFieldId, configurationFor, setIsFetching, getIsFetching, setKeyFields, getKeyFields, setIgnoredFields, getIgnoredFields, getHashFields, getLastUpdated, \n  valuesFor, setDatasetDiff, removeDatasetDiff, selectDatasetDiff, selectDatasetIntersection, applyHashes, configureDataset };\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"checkboxContainer\":\"MiscControls_checkboxContainer__3qEun\",\"colorBy\":\"MiscControls_colorBy__36jis\",\"fieldSelect\":\"MiscControls_fieldSelect__23xNi\",\"switch\":\"MiscControls_switch__3u3nl\",\"switchLabel\":\"MiscControls_switchLabel__aj7RI\",\"switch-inner\":\"MiscControls_switch-inner__1-N2V\",\"selectorContainer\":\"MiscControls_selectorContainer__ktFZV\",\"selector\":\"MiscControls_selector__18lbV\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"listContainer\":\"SelectedFieldList_listContainer__1Qvj-\",\"isDropDisabled\":\"SelectedFieldList_isDropDisabled__1wSe7\",\"droppable\":\"SelectedFieldList_droppable__3w9JP\",\"draggable\":\"SelectedFieldList_draggable__1pKrD\",\"field\":\"SelectedFieldList_field__30UAV\",\"groupBy\":\"SelectedFieldList_groupBy__3bxtK\",\"animated\":\"SelectedFieldList_animated__1gf5z\",\"groupByEnter\":\"SelectedFieldList_groupByEnter__2DArZ\",\"fieldName\":\"SelectedFieldList_fieldName__coZyW\",\"dropTarget\":\"SelectedFieldList_dropTarget__3MnM9\",\"isDraggingOver\":\"SelectedFieldList_isDraggingOver__26-4R\",\"dragHandle\":\"SelectedFieldList_dragHandle__eS4Kf\"};"],"sourceRoot":""}